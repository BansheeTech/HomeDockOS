import{j as te,B as le,d as oe,r as m,w as ne,v as ie,y as p,A as r,F as n,z as s,H as l,u as e,M as u,E as g,X as re,G as _,D as d,C as w,Z as f,T as V,R as O,U as z,al as de,I as ce,W as ue,_ as pe}from"./hdos_6c83BLatckOj0tZu21IHA.js";import{d as R,a as P}from"./hdos_DaRSEFpqf81ZuDgc4Rzsj.js";import{u as me,f as fe,g as ve,P as N,y as xe,a5 as ge}from"./hdos_Ddw-ebvn8vw4UeXOz1egp.js";import{d as he}from"./hdos_Cz8Dwn1iOWea_GVqOHEOb.js";import{d as q}from"./hdos_CS7Pix6yyXf4PLMilHEK5.js";import{d as ye}from"./hdos_R8ecdjzHoP22_qvuHhYVs.js";import{d as be}from"./hdos_Cc8duC1RfUFCANHn9wXj9.js";import{d as U}from"./hdos_DPhlMBAcwmj4N6C-RIU0v.js";import{d as X}from"./hdos_DFUy6rfmTnhDoBOiO2sld.js";import{d as ke}from"./hdos_D4VENToS-RM0shQaDqhsL.js";import{_ as _e}from"./hdos_DRbIdIhy-OvLgw7me6Ygf.js";import{B as x}from"./hdos_B42ZI9bO56xwrU_wcUxuj.js";import{I as we}from"./hdos_ItXn61EWboNk4bGvE18uC.js";import{I as W}from"./hdos_9cIFeGeJ7O_vsfzc5X4Tb.js";import{S as Se,c as F}from"./hdos_Bl2bECb6yLrwVi_eHTGnu.js";import{S as Ce}from"./hdos_O5rb-3Nc9qg7FTkccZVty.js";import"./hdos_Bsxh6ryxTjz-q3-Ls2Gll.js";import"./hdos_C-JSx2TVkNNsG7uRI1gaW.js";import"./hdos_Dz3aTMQqM4LnOlKzV3COc.js";import"./hdos_itWSuQ2oYLgMGq-Z_V6WL.js";import"./hdos_CE1G-McAXm7G2-tH-xmrF.js";import"./hdos_DCQvziD-0BGtLQC-jPv6N.js";import"./hdos_CJoaCRc7PMIr83ndc1bSY.js";import"./hdos_DiG9ZRJZdYVCPqbvm0N5C.js";import"./hdos_DgoKWIBRIkq6Y25wtD38y.js";import"./hdos_XwLzsoSoW9xoqR08WIZOb.js";import"./hdos_D72Qrta0XyebiTG0CVecd.js";import"./hdos_B986e9S7m-oa9P-AkOArv.js";import"./hdos_Du1Bd7iiO60OBoRAFMG9y.js";import"./hdos_D63Tfrq7hZ9D-jbqbBA6V.js";import"./hdos_BwMuciLBZY8btzL7GYuK-.js";const Ae={width:24,height:24,body:'<path fill="currentColor" d="m12.89 3l1.96.4L11.11 21l-1.96-.4L12.89 3m6.7 9L16 8.41V5.58L22.42 12L16 18.41v-2.83L19.59 12M1.58 12L8 5.58v2.83L4.41 12L8 15.58v2.83L1.58 12Z"/>'},Te={width:24,height:24,body:'<path fill="currentColor" d="M20 12a8 8 0 0 0-8-8a8 8 0 0 0-8 8a8 8 0 0 0 8 8a8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12A10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5S7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5S14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/>'},Ie={class:"app-install-config h-full flex flex-col overflow-hidden",style:{"container-type":"inline-size","container-name":"window"}},Le={key:0,class:"flex-1 flex items-center justify-center"},Be={class:"text-center"},$e={key:1,class:"flex flex-col h-full overflow-hidden"},De={class:"flex-1 overflow-y-auto"},Me={class:"flex items-center gap-4 mb-4"},Pe={class:"relative flex-shrink-0 group"},Ne={key:1,class:"absolute flex items-center justify-center p-1 rounded-full -bottom-2 -right-2 shadow-md border bg-amber-600 border-gray-100 animate-bounce"},Ue={class:"flex-1 min-w-0"},We={class:"flex items-center gap-2 flex-wrap text-xs"},Fe={key:0,class:"flex items-center px-2 py-0.5 rounded-md bg-amber-600 text-white font-medium"},je={class:"action-buttons flex items-center gap-2"},Ee=["href"],He={class:"flex-shrink-0"},Ve={class:"flex items-center"},Oe={class:"flex items-center"},ze={class:"px-4 md:px-6 lg:px-8 py-5"},Re={class:"mb-6"},qe={key:"simple"},Xe={key:0,class:"mb-6"},Ze={class:"space-y-3"},Qe={class:"mb-6"},Ge={class:"flex items-center justify-between mb-3"},Ye={class:"space-y-2"},Je={class:"mb-6"},Ke={class:"flex items-center justify-between mb-3"},es={class:"space-y-2"},ss={class:"mb-6"},as={key:"advanced"},ts=["disabled"],ls={class:"space-y-2.5 max-w-sm"},os={class:"flex items-center gap-2"},ns={class:"space-y-4"},is={class:"flex items-start gap-3"},rs={class:"flex-1"},ds={class:"flex items-start gap-1"},cs=te({__name:"AppInstallConfig",props:{app:{}},setup(Z){const T=Z,{themeClasses:a}=le(),Q=me(),D=fe(),o=oe(()=>T.app?.name&&Q.apps.find(t=>t.name===T.app?.name)||T.app),S=m(!1),h=m([]),y=m([]),I=m("unless-stopped"),L=m(""),b=m(void 0),k=m(void 0),M=m(!1),B=m(!1),C=m(!1),$=m(!1),j=ve();async function E(){if(!(!o.value?.name||B.value)){B.value=!0;try{const i=await P.get("/api/get-appstore-info",{params:{containerName:o.value.name},headers:{"X-HomeDock-CSRF-Token":j.value}});i.data?.success?(h.value=i.data.data.ports||[],y.value=i.data.data.volumes||[],L.value=i.data.data.ymlContent||"",I.value="unless-stopped",b.value=i.data.data.user_name||void 0,k.value=i.data.data.password||void 0,M.value=i.data.data.ssl_enabled||!1):(console.error("Failed to fetch app info:",i.data.message),B.value=!1)}catch(i){console.error("Error fetching app info:",i),B.value=!1}}}function G(){h.value.push("")}function Y(i){h.value.splice(i,1)}function J(){y.value.push("")}function K(i){y.value.splice(i,1)}function ee(i,t){S.value=!!i}async function H(){if(o.value?.name){if(o.value.is_external&&!$.value){C.value=!0;return}try{$.value=!1;const i=j.value,t=S.value?{containerName:o.value.name,configType:"advanced",ymlContent:L.value,homedock_csrf_token:i}:{containerName:o.value.name,configType:"simple",userName:b.value,userPassword:k.value,ports:h.value,volumes:y.value,restartPolicy:I.value,homedock_csrf_token:i},c=await P.post("/api/process-config",t,{headers:{"X-HomeDock-CSRF-Token":i}});if(!c.data.success){console.error(`Failed to process configuration: ${c.data.message}`);return}await D.trackInstallations(),await P.post("/api/app-store-install-container",{containerName:o.value.name,homedock_csrf_token:i})}catch(i){console.error("Error during installation process:",i)}}}function se(){C.value=!1,$.value=!0,H()}function ae(){C.value=!1,$.value=!1}return ne(o,i=>{i?.name&&E()},{immediate:!0}),ie(()=>{o.value?.name&&E()}),(i,t)=>(r(),p("div",Ie,[o.value?(r(),p("div",$e,[s("div",De,[s("div",{class:l([[e(a).storeContMainer,e(a).aeroExtraScope],"px-4 md:px-6 lg:px-8 py-5"])},[s("div",Me,[s("div",Pe,[n(re,{draggable:"false",src:o.value?.picture_path||"docker-icons/notfound.jpg",alt:o.value?.name,class:l([[e(a).storeModalImageBack],"w-16 h-16 rounded-xl shadow-md transition ring-[1px] duration-200 group-hover:scale-105"])},null,8,["src","alt","class"]),M.value?(r(),p("div",{key:0,class:l([[e(a).storePopupSSLFlag],"absolute flex items-center justify-center p-1 rounded-full -top-1 -right-1 shadow-sm border"])},[n(e(u),{icon:e(U),class:"h-2.5 w-2.5"},null,8,["icon"])],2)):g("",!0),o.value?.is_external?(r(),p("div",Ne,[n(e(u),{icon:e(X),class:"h-4 w-4 text-white"},null,8,["icon"])])):g("",!0)]),s("div",Ue,[s("h1",{class:l([[e(a).storeModalAppName],"text-xl md:text-2xl font-bold mb-1"])},_(o.value?.display_name||o.value?.name),3),s("div",We,[s("span",{class:l([[e(a).storeModalAppType],"font-medium"])},_(o.value?.type),3),s("span",{class:l([e(a).storeModalAppCategory])},"•",2),s("span",{class:l([e(a).storeModalAppCategory])},_(o.value?.category),3),o.value?.is_external?(r(),p("div",Fe,[n(e(u),{icon:e(X),class:"mr-1 h-3 w-3"},null,8,["icon"]),t[6]||(t[6]=s("span",null,"External Package",-1))])):g("",!0),M.value?(r(),p("div",{key:1,class:l([[e(a).storeTextSSLFlag],"flex items-center"])},[n(e(u),{icon:e(U),class:"mr-1 h-3 w-3"},null,8,["icon"]),t[7]||(t[7]=s("span",{class:"font-medium"},"HTTPS",-1))],2)):g("",!0)])])]),s("div",je,[n(V,{name:"button-fade",mode:"out-in"},{default:d(()=>[o.value?.is_installed?(r(),w(e(x),{key:"installed",class:l([[e(a).storeButtonInstalled],"action-button-primary flex items-center justify-center"]),type:"default"},{default:d(()=>[n(e(u),{icon:e(he),class:"mr-1.5"},null,8,["icon"]),t[8]||(t[8]=f(" Installed ",-1))]),_:1},8,["class"])):e(D).currentlyInstalling===o.value?.name?(r(),w(e(x),{key:"installing",class:l([[e(a).storeButtonInstalling],"action-button-primary flex items-center justify-center"]),type:"default"},{default:d(()=>[n(e(u),{icon:e(R),class:"mr-1.5 animate-spin"},null,8,["icon"]),t[9]||(t[9]=f(" Installing... ",-1))]),_:1},8,["class"])):o.value?.name&&e(D).queue.includes(o.value.name)?(r(),w(e(x),{key:"queued",class:l([[e(a).storeButtonQueued],"action-button-primary flex items-center justify-center"]),type:"default"},{default:d(()=>[n(e(u),{icon:e(be),class:"mr-1.5"},null,8,["icon"]),t[10]||(t[10]=f(" Queued ",-1))]),_:1},8,["class"])):(r(),w(e(x),{class:l([[e(a).storeButtonInstall],"action-button-primary flex items-center justify-center"]),key:"install",type:"primary",onClick:H},{default:d(()=>[n(e(u),{icon:e(N),class:"mr-1.5"},null,8,["icon"]),t[11]||(t[11]=f(" Install ",-1))]),_:1},8,["class"]))]),_:1}),s("a",{href:o.value?.is_external?"https://www.homedock.cloud":`https://www.homedock.cloud/apps/${o.value?.name.toLowerCase()}`,target:"_blank",class:"flex-shrink-0"},[n(e(x),{class:l([[e(a).storeLinkHDOSButton],"flex items-center"]),type:"dashed"},{default:d(()=>[n(e(u),{icon:e(ye),class:"w-4 h-4"},null,8,["icon"])]),_:1},8,["class"])],8,Ee),s("div",He,[n(e(Ce),{checked:S.value,"onUpdate:checked":t[0]||(t[0]=c=>S.value=c),onChange:ee},{checkedChildren:d(()=>[s("span",Ve,[n(e(u),{icon:e(Te),class:"h-4 w-4"},null,8,["icon"]),t[12]||(t[12]=s("span",{class:"text-transparent"},".",-1))])]),unCheckedChildren:d(()=>[s("span",Oe,[n(e(u),{icon:e(Ae),class:"h-4 w-4"},null,8,["icon"]),t[13]||(t[13]=s("span",{class:"text-transparent"},".",-1))])]),_:1},8,["checked"])])])],2),s("div",ze,[s("div",Re,[s("p",{class:l([[e(a).storeAboutTextDescScope],"text-sm leading-relaxed mb-3"])},_(o.value?.description+"."||"No description available"),3),o.value?.dependencies&&o.value.dependencies.length>=1?(r(),p("div",{key:0,class:l([[e(a).storeAboutTextDepsScope],"text-xs inline-flex items-center px-2.5 py-1.5 rounded-md"])},[n(e(u),{icon:e(xe),class:"h-3 w-3 mr-1.5"},null,8,["icon"]),s("span",null,_(o.value?.dependencies.concat().join(", ")),1)],2)):g("",!0)]),s("div",{class:l([[e(a).storeSeparator],"h-px mb-6"])},null,2),n(V,{name:"fade-slide",mode:"out-in"},{default:d(()=>[S.value?(r(),p("div",as,[s("h3",{class:l([[e(a).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider mb-3"])},"Advanced Configuration",2),ce(s("textarea",{disabled:o.value?.is_installed,"onUpdate:modelValue":t[4]||(t[4]=c=>L.value=c),class:l([[e(a).hubTextArea],"flex-1 rounded-lg w-full font-mono text-xs resize-none p-3"]),style:{height:"500px"}},null,10,ts),[[ue,L.value]])])):(r(),p("div",qe,[b.value!==void 0||k.value!==void 0?(r(),p("div",Xe,[s("h3",{class:l([[e(a).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider mb-3"])},"Access Credentials",2),s("div",Ze,[b.value!==void 0?(r(),w(e(W),{key:0,class:l([[e(a).scopeSelector,e(a).loginFormInput],"w-full"]),disabled:o.value?.is_installed,value:b.value,"onUpdate:value":t[1]||(t[1]=c=>b.value=c),placeholder:"Username"},null,8,["class","disabled","value"])):g("",!0),k.value!==void 0?(r(),w(e(we),{key:1,autocomplete:"new-password",class:l([[e(a).scopeSelector,e(a).loginFormInput],"w-full"]),disabled:o.value?.is_installed,value:k.value,"onUpdate:value":t[2]||(t[2]=c=>k.value=c),placeholder:"Password"},null,8,["class","disabled","value"])):g("",!0)])])):g("",!0),s("div",Qe,[s("div",Ge,[s("h3",{class:l([[e(a).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider"])},"Port Mappings",2),n(e(x),{disabled:o.value?.is_installed,type:"link",onClick:G,size:"small"},{default:d(()=>[...t[14]||(t[14]=[f(" + Add ",-1)])]),_:1},8,["disabled"])]),s("div",Ye,[(r(!0),p(O,null,z(h.value,(c,v)=>(r(),p("div",{key:"port-"+v,class:"flex items-center gap-2"},[n(e(W),{class:l([[e(a).scopeSelector,e(a).loginFormInput],"flex-1"]),disabled:o.value?.is_installed,value:h.value[v],"onUpdate:value":A=>h.value[v]=A,placeholder:"8080:80"},null,8,["class","disabled","value","onUpdate:value"]),n(e(x),{class:l([e(a).storeLinkHDOSButton]),disabled:o.value?.is_installed,type:"dashed",onClick:A=>Y(v)},{default:d(()=>[n(e(u),{icon:e(q)},null,8,["icon"])]),_:1},8,["class","disabled","onClick"])]))),128))])]),s("div",Je,[s("div",Ke,[s("h3",{class:l([[e(a).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider"])},"Volume Mounts",2),n(e(x),{disabled:o.value?.is_installed,type:"link",onClick:J,size:"small"},{default:d(()=>[...t[15]||(t[15]=[f(" + Add ",-1)])]),_:1},8,["disabled"])]),s("div",es,[(r(!0),p(O,null,z(y.value,(c,v)=>(r(),p("div",{key:"volume-"+v,class:"flex items-center gap-2"},[n(e(W),{class:l([[e(a).scopeSelector,e(a).loginFormInput],"flex-1"]),disabled:o.value?.is_installed,value:y.value[v],"onUpdate:value":A=>y.value[v]=A,placeholder:"/host:/container"},de({_:2},[c.includes("/DATA/SSLCerts")?{name:"prefix",fn:d(()=>[n(e(u),{icon:e(U),class:l([[e(a).installConfigSSLVolumeIcon],"h-3.5 w-3.5 -translate-x-0.5"])},null,8,["icon","class"])]),key:"0"}:void 0]),1032,["class","disabled","value","onUpdate:value"]),n(e(x),{class:l([e(a).storeLinkHDOSButton]),disabled:o.value?.is_installed,type:"dashed",onClick:A=>K(v)},{default:d(()=>[n(e(u),{icon:e(q)},null,8,["icon"])]),_:1},8,["class","disabled","onClick"])]))),128))])]),s("div",ss,[s("h3",{class:l([[e(a).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider mb-3"])},"Restart Policy",2),n(e(Se),{class:l([[e(a).scopeSelector,e(a).loginFormInput],"w-full"]),"popup-class-name":`${e(a).scopeSelector}`,disabled:o.value?.is_installed,value:I.value,"onUpdate:value":t[3]||(t[3]=c=>I.value=c),"get-popup-container":c=>c.parentNode},{default:d(()=>[n(e(F),{class:l([e(a).scopeSelector]),value:"always"},{default:d(()=>[...t[16]||(t[16]=[f("Always",-1)])]),_:1},8,["class"]),n(e(F),{class:l([e(a).scopeSelector]),value:"unless-stopped"},{default:d(()=>[...t[17]||(t[17]=[f("Unless Stopped",-1)])]),_:1},8,["class"]),n(e(F),{class:l([e(a).scopeSelector]),value:"no"},{default:d(()=>[...t[18]||(t[18]=[f("No",-1)])]),_:1},8,["class"])]),_:1},8,["class","popup-class-name","disabled","value","get-popup-container"])])]))]),_:1})])]),n(_e,{icon:e(N),message:"Install App",info:o.value?.name?`Installing ${o.value.display_name||o.value.name}`:"Configure application",showHelp:!0},{help:d(()=>[s("div",ls,[s("div",os,[n(e(u),{icon:e(N),class:l(["w-5 h-5",e(a).statusBarIcon])},null,8,["icon","class"]),s("h4",{class:l(["text-base font-semibold",e(a).statusBarText])},"Install App",2)]),s("div",{class:l(["text-[10px] md:text-xs space-y-2 leading-relaxed",e(a).statusBarInfo])},[...t[19]||(t[19]=[s("p",null,"Configure your application before installation using simple mode with form fields or advanced mode with direct compose editing. Set ports, volumes, credentials, and restart policies to customize how your application runs. Toggle between modes using the switch to choose your preferred configuration method.",-1)])],2)])]),_:1},8,["icon","info"])])):(r(),p("div",Le,[s("div",Be,[n(e(u),{icon:e(R),class:l([[e(a).installConfigLoadingIcon],"animate-spin h-12 w-12 mx-auto mb-4"])},null,8,["icon","class"]),s("p",{class:l([e(a).installConfigLoadingText])},"Loading application details...",2)])])),n(ge,{visible:C.value,"onUpdate:visible":t[5]||(t[5]=c=>C.value=c),type:"warning",title:"External Package Warning","ok-text":"Install Anyway","cancel-text":"Cancel",onOk:se,onCancel:ae},{default:d(()=>[s("div",ns,[s("div",is,[n(e(u),{icon:e(ke),class:"w-6 h-6 text-red-500 flex-shrink-0"},null,8,["icon"]),s("div",rs,[s("p",{class:l([["font-semibold mb-3",e(a).externalWarningTitle],"text-sm"])},"You are about to install an external package",2),s("p",{class:l(["text-sm mb-2",e(a).externalWarningText])},"This application was not added or verified by the HomeDock OS team. External packages can potentially be dangerous if they contain malicious code.",2),s("div",{class:l(["border rounded-lg p-3 mb-3",e(a).externalWarningAuthorBg,e(a).externalWarningAuthorBorder])},[s("p",{class:l(["text-sm font-semibold",e(a).externalWarningAuthorTitle])},"HDS Package Author:",2),s("p",{class:l(["text-sm",e(a).externalWarningAuthorText])},_(o.value?.author||"Unknown"),3)],2),s("p",{class:l(["text-sm font-semibold mb-2",e(a).externalWarningTitle])},"Security Recommendations:",2),s("ul",{class:l(["text-xs -space-y-1",e(a).externalWarningListText])},[t[22]||(t[22]=s("li",{class:"flex items-start gap-1"},[s("span",{class:"mt-0.5"},"•"),s("span",null,"Only install packages from authors you trust")],-1)),t[23]||(t[23]=s("li",{class:"flex items-start gap-1"},[s("span",{class:"mt-0.5"},"•"),s("span",null,"Review the package configuration before installing")],-1)),t[24]||(t[24]=s("li",{class:"flex items-start gap-1"},[s("span",{class:"mt-0.5"},"•"),s("span",null,"Be cautious of packages requesting unusual permissions")],-1)),s("li",ds,[t[21]||(t[21]=s("span",{class:"mt-0.5"},"•",-1)),s("span",null,[t[20]||(t[20]=f("Report suspicious packages to ",-1)),s("a",{href:"mailto:support@homedock.cloud",class:l([e(a).hyperLink])},"support@homedock.cloud",2)])])],2),s("p",{class:l(["text-xs mt-2 underline",e(a).externalWarningDisclaimerText])},"By proceeding, you acknowledge the risks associated with installing external packages.",2)])])])]),_:1},8,["visible"])]))}}),Vs=pe(cs,[["__scopeId","data-v-39d46276"]]);export{Vs as default};
