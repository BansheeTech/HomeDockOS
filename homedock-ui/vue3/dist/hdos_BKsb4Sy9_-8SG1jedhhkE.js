import{j as ue,B as ce,r as c,d as $,w as O,v as de,x as ve,y as I,A as S,z as u,E as X,F as p,H as i,u as s,M as k,G as P,D as z,R as pe,U as fe,L as me,X as he,T as ge,S as be,_ as _e}from"./hdos_CjKsQ-fGBJwdLg5bpoTOg.js";import{k as xe,a as we,L as Ce,a5 as ye,g as Ie,a6 as U,Y as Se,Q as ke,a1 as Be,a0 as Me,Z as Te,a2 as $e,a7 as Ee,a8 as De,a4 as Le,a3 as Ae,s as Re,a9 as Oe,aa as Pe,X as ze,q as Ge,ab as He,_ as Fe,A as Ne,ac as We,ad as Y}from"./hdos_V5_pfFN7sDB_-6OEk-cWo.js";import{_ as Xe}from"./hdos_MB-jSAuVDOJGijrJ0P-h1.js";import{e as Ue}from"./hdos_CLOtYxcvI4vx5OEmSVE0E.js";import"./hdos_BB7uAa20q3XTmsBbCvvDq.js";import"./hdos_Dz3aTMQqM4LnOlKzV3COc.js";import"./hdos_itWSuQ2oYLgMGq-Z_V6WL.js";import"./hdos_DaRSEFpqf81ZuDgc4Rzsj.js";import"./hdos_CE1G-McAXm7G2-tH-xmrF.js";import"./hdos_DCQvziD-0BGtLQC-jPv6N.js";import"./hdos_BTjx4GUb_InXPN5k1Yckl.js";import"./hdos_C2zTt8PMOQCviUWg1Orig.js";import"./hdos_Bbrn4992ekQIT-yBFpY9u.js";const Ye={width:24,height:24,hidden:!0,body:'<path fill="currentColor" d="M21 14H3V4h18m0-2H3c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h7l-2 3v1h8v-1l-2-3h7a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z"/>'},Ve={width:24,height:24,body:'<path fill="currentColor" d="M6.1 10L4 18V8h17a2 2 0 0 0-2-2h-7l-2-2H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h15c.9 0 1.7-.6 1.9-1.5l2.3-8.5H6.1M19 18H6l1.6-6h13L19 18Z"/>'},Ze={width:24,height:24,body:'<path fill="currentColor" d="m23 12l-4-4v3h-9v2h9v3M1 18V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3h-2V6H3v12h12v-3h2v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2Z"/>'},je={key:0,class:"empty-folder-state"},qe=["onClick","onDblclick","onContextmenu","onTouchstart","onTouchend","title"],Qe={key:0,class:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-2xl pointer-events-none z-[2]"},Je={class:"space-y-2.5 max-w-sm"},Ke={class:"flex items-center gap-2"},et=500,tt=10,at=ue({__name:"AppFolder",props:{folderId:{}},setup(V){const b=V,f=xe(),_=we(),{isMobile:E}=Ce(),{themeClasses:a}=ce(),{confirm:Z}=ye(),m=Ie(),d=c(null),h=c(null),l=c(null),G=c(0),B=c(!1);let v=null;const H=c(0),F=c(0),M=c(!1),g=c({visible:!1,x:0,y:0}),x=c(110),D=c(125),w=c(16),j=$(()=>f.getFolderById(b.folderId)),L=$(()=>j.value?.name||"Unknown Folder"),C=$(()=>{const e=f.getAppsInFolder(b.folderId),n={running:1,paused:2,restarting:3,created:4,exited:5};return e.sort((t,r)=>{const o=n[t.status]||99,y=n[r.status]||99;return o===y?t.name.localeCompare(r.name):o-y})});function q(e){return{running:a.value.statusBadgeRunning,exited:a.value.statusBadgeExited,paused:a.value.statusBadgePaused,created:a.value.statusBadgeCreated,restarting:a.value.statusBadgeRestarting}[e]||a.value.statusBadgeCreated}function T(){const e=d.value?.clientWidth||window.innerWidth;if(E.value){const r=e-32,o=Math.floor(r/4);x.value=o,D.value=o+15,w.value=16}else x.value=110,D.value=125,w.value=16;J()}function Q(e){const n=G.value||1,t=Math.floor(e/n),r=e%n,o={position:"absolute",left:`${w.value+r*x.value}px`,top:`${w.value+t*D.value}px`};return E.value&&(o.width=`${x.value}px`),o}function J(){const e=d.value?.clientWidth||window.innerWidth;G.value=Math.max(1,Math.floor((e-w.value*2)/x.value))}function K(e){return{running:"",paused:"brightness-50 opacity-75",exited:"grayscale brightness-50 opacity-75",created:"brightness-50 sepia opacity-50"}[e.status]||""}function ee(e){h.value=e.id}function te(e){e.status==="running"&&e.service_url?window.open(e.service_url,"_blank","noopener,noreferrer"):_.openWindow("properties",{title:`${e.name} - Properties`,data:{appId:e.id},allowMultiple:!0})}function N(e,n){e.preventDefault(),e.stopPropagation(),h.value=n.id,l.value=n,g.value={visible:!0,x:e.clientX,y:e.clientY}}function ae(e){e.target.closest(".desktop-icon")||(e.preventDefault(),e.stopPropagation(),h.value=null,l.value=null,g.value={visible:!0,x:e.clientX,y:e.clientY})}const ne=$(()=>{if(!l.value)return[{label:"Refresh",icon:U,action:()=>{}}];const e=l.value,n=e.status==="running",t=e.status==="exited",r=e.status==="paused",o=[];return n&&e.service_url&&(o.push({label:"Open",icon:Ue,action:()=>{l.value?.service_url&&window.open(l.value.service_url,"_blank","noopener,noreferrer")}}),o.push({divider:!0})),o.push({label:n?"Stop":"Start",icon:n?Se:ke,action:async()=>{l.value&&(n?await Be(l.value,m.value,a.value.scopeSelector):await Me(l.value,m.value,a.value.scopeSelector))},disabled:r}),o.push({label:"Restart",icon:Te,action:async()=>{l.value&&await $e(l.value,m.value,a.value.scopeSelector)},disabled:t}),o.push({divider:!0}),o.push({label:r?"Unpause":"Pause",icon:r?Ee:De,action:async()=>{l.value&&(r?await Le(l.value,m.value,a.value.scopeSelector):await Ae(l.value,m.value,a.value.scopeSelector))},disabled:t}),o.push({divider:!0}),o.push({label:"View Logs",icon:Re,action:()=>{l.value&&_.openWindow("logs",{title:`${l.value.name} - Logs`,data:{appName:l.value.name},allowMultiple:!0})}}),o.push({label:"Update",icon:Oe,action:async()=>{l.value&&await Pe(l.value,m.value,a.value.scopeSelector)}}),o.push({label:"Refresh",icon:U,action:()=>{}}),o.push({divider:!0}),o.push({label:"Properties",icon:ze,action:()=>{l.value&&_.openWindow("properties",{title:`${l.value.name} - Properties`,data:{appId:l.value.id},allowMultiple:!0})}}),o.push({divider:!0}),o.push({label:"Remove from Folder",icon:Ze,action:()=>{l.value&&f.removeAppFromFolder(l.value.id)}}),o.push({divider:!0}),o.push({label:"Uninstall",icon:Ge,action:()=>{if(!l.value)return;const y=l.value;Z({title:"Confirm Uninstall",content:`Are you sure you want to uninstall ${y.name}? This action cannot be undone.`,okText:"Uninstall",cancelText:"Cancel",onOk:async()=>{await He(y,m.value,a.value.scopeSelector)}})}}),o});function se(){g.value.visible=!1,l.value=null}function oe(e,n){if(e.touches.length>1)return;const t=e.touches[0];H.value=t.clientX,F.value=t.clientY,M.value=!1,v=setTimeout(()=>{if(!M.value){const r=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});N(r,n),navigator.vibrate&&navigator.vibrate(50)}},et)}function le(e){if(!v)return;const n=e.touches[0],t=n.clientX-H.value,r=n.clientY-F.value;Math.sqrt(t*t+r*r)>tt&&(M.value=!0,v&&(clearTimeout(v),v=null))}function re(e,n){v&&(clearTimeout(v),v=null),M.value=!1}function ie(e,n){if(!d.value)return!1;const t=d.value.getBoundingClientRect();return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom}function A(e){B.value=ie(e.clientX,e.clientY)}function R(e){B.value&&f.draggedAppIds.length>0&&(e.preventDefault(),e.stopPropagation(),f.draggedAppIds.forEach(n=>{const t=f.dockerApps.find(r=>r.id===n);t&&t.folderId!==b.folderId&&f.addAppToFolder(n,b.folderId)}),f.clearDraggedApps()),B.value=!1}O(()=>f.draggedAppIds.length>0,e=>{e?(document.addEventListener("mousemove",A,!0),document.addEventListener("mouseup",R,!0)):(document.removeEventListener("mousemove",A,!0),document.removeEventListener("mouseup",R,!0),B.value=!1)}),O(L,e=>{const n=_.windows.find(t=>t.appId==="folder-view"&&t.data?.folderId===b.folderId);n&&_.updateWindowTitle(n.id,e)},{immediate:!1});function W(){T()}return O(()=>E.value,()=>{T()}),de(()=>{if(T(),window.addEventListener("resize",W),d.value){const e=new ResizeObserver(()=>{T()});e.observe(d.value),d.value.__resizeObserver=e}}),ve(()=>{window.removeEventListener("resize",W),d.value&&d.value.__resizeObserver&&d.value.__resizeObserver.disconnect(),document.removeEventListener("mousemove",A,!0),document.removeEventListener("mouseup",R,!0),v&&(clearTimeout(v),v=null)}),(e,n)=>(S(),I("div",{class:i(["folder-view-container",s(a).folderContainerBg])},[u("div",{class:i(["folder-breadcrumb",[s(a).folderBreadcrumbBg,s(a).folderBreadcrumbBorder]])},[p(s(k),{icon:s(Ye),class:i(["breadcrumb-icon",s(a).folderBreadcrumbIcon])},null,8,["icon","class"]),u("span",{class:i(["breadcrumb-text",s(a).folderBreadcrumbText])},"Desktop",2),p(s(k),{icon:s(Fe),class:i(["breadcrumb-separator",s(a).folderBreadcrumbSeparator])},null,8,["icon","class"]),p(s(k),{icon:s(Ne),class:i(["breadcrumb-icon",s(a).folderBreadcrumbIcon])},null,8,["icon","class"]),u("span",{class:i(["breadcrumb-text folder-name",s(a).folderBreadcrumbText])},P(L.value),3),u("span",{class:i(["app-count",s(a).folderAppCount])},"("+P(C.value.length)+" apps)",3)],2),C.value.length===0?(S(),I("div",je,[p(s(k),{icon:s(Ve),class:i(["empty-icon",s(a).folderEmptyIcon])},null,8,["icon","class"]),u("h3",{class:i(["empty-title",s(a).folderEmptyTitle])},"Empty folder",2),u("p",{class:i(["empty-description",s(a).folderEmptyDescription])},"Drag apps here to organize them",2)])):X("",!0),u("div",{class:"folder-apps-grid",ref_key:"containerRef",ref:d,onContextmenu:ae},[p(be,{name:"icon-appear"},{default:z(()=>[(S(!0),I(pe,null,fe(C.value,(t,r)=>(S(),I("div",{key:t.id,class:i(["desktop-icon group flex flex-col items-center gap-1 cursor-pointer p-3 rounded-lg w-[100px] z-[1] select-none outline-none border",h.value!==t.id&&["border-transparent","shadow-[0_0_0_1px_transparent]"],h.value===t.id&&[s(a).desktopIconBgSelected,s(a).desktopIconBorderSelected,s(a).desktopIconShadowSelected]]),style:me(Q(r)),onClick:o=>ee(t),onDblclick:o=>te(t),onContextmenu:o=>N(o,t),onTouchstart:o=>oe(o,t),onTouchmove:le,onTouchend:o=>re(o,t),title:`${t.name} (${t.status})`},[u("div",{class:i(["icon-container relative w-16 h-16 flex items-center justify-center rounded-2xl overflow-hidden pointer-events-none border",s(a).desktopIconContainerBg,s(a).desktopIconContainerScaleHover,h.value!==t.id&&["border-transparent",s(a).desktopIconContainerBgHover],h.value===t.id&&[s(a).desktopIconContainerBgSelected,s(a).desktopIconContainerBorderSelected],K(t)])},[p(he,{src:t.image_path,class:"app-image rounded-xl",alt:"",draggable:"false"},null,8,["src"]),p(ge,{name:"loading-overlay-fade"},{default:z(()=>[t.isProcessing===!0?(S(),I("div",Qe,[...n[0]||(n[0]=[u("div",{class:"w-8 h-8 rounded-full border-[3px] border-white/30 border-t-blue-500 animate-spin shadow-lg"},null,-1)])])):X("",!0)]),_:2},1024),u("div",{class:i(["status-badge",q(t.status),s(a).desktopStatusBadgeBorder,{"status-pulse":t.status==="running"}])},null,2)],2),u("span",{class:i(["app-name",[s(a).desktopIconText]])},P(t.name),3)],46,qe))),128))]),_:1})],544),p(We,{visible:g.value.visible,x:g.value.x,y:g.value.y,items:ne.value,onClose:se},null,8,["visible","x","y","items"]),p(Xe,{icon:s(Y),message:`${L.value}`,info:`${C.value.length} ${C.value.length===1?"app":"apps"}`,showHelp:!0},{help:z(()=>[u("div",Je,[u("div",Ke,[p(s(k),{icon:s(Y),class:i(["w-5 h-5",s(a).statusBarIcon])},null,8,["icon","class"]),u("h4",{class:i(["text-base font-semibold",s(a).statusBarText])},"Folder",2)]),u("div",{class:i(["text-[10px] md:text-xs space-y-2 leading-relaxed",s(a).statusBarInfo])},[...n[1]||(n[1]=[u("p",null,"Folders help you organize your apps by grouping related applications together. Create folders by dragging apps on top of each other on the desktop, making it easier to manage and access your installed applications.",-1)])],2)])]),_:1},8,["icon","message","info"])],2))}}),ht=_e(at,[["__scopeId","data-v-0ea01c74"]]);export{ht as default};
