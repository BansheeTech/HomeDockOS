import{aU as f,q as S,bE as Ct,M as Zo,bQ as Ao,s as P,aL as u,I as p,g as de,bJ as $,u as d,t as y,au as i,bk as t,v as s,bU as v,bb as h,T as An,bR as Lo,aD as Ln,aI as Bn,F as z,aX as B,bV as xo,ak as Hn,H as K,aw as ae,bO as Xe,h as Gt,as as yo}from"./hdos_BnIymrgN3FMaW96NhsgWi.js";import{a as b,d as ne,b as Me}from"./hdos_DahYSjy4MuyfOawe4NtU9.js";import{d as Bo,c as Ho,u as Pn,s as Xn,a as Un,K as Nn,L as Vn,U as On,f as H,q as qt,o as Kt,M as rt,N as Ue,O as go,P as St,x as Ee,v as Sa,A as it,Q as Yn,z as Qt,R as wo,S as jn,T as Fa,V as Ca,W as ko,p as qe,X as Jt,n as ea,B as bo,Y as _o,Z as Wn,_ as Gn,$ as ta,w as se,a0 as So,a1 as Ta,a2 as Fo,y as Ia}from"./hdos_DMBX8EgZFkFEssZyeFxZ3.js";import{d as qn}from"./hdos_CiiZkK0g2tJQxvgJUCvSu.js";import{d as Da}from"./hdos_D7NRCijMj_Q9fS__axrEk.js";import{d as Kn}from"./hdos_BX8oNELbZ9gHTfM-9pR1a.js";import{d as aa}from"./hdos_CHvnahOuQFlViBynA1QBW.js";import{d as za}from"./hdos_7sv2flXFUN9qpLwlmoj-F.js";import{d as Co}from"./hdos_CS7Pix6yyXf4PLMilHEK5.js";import{d as ct,a as Qn}from"./hdos_F3B_gUr0kfhkuZOg5xUrY.js";import{d as Ft}from"./hdos_Ccl3dHUt4IU99oDS8_oq1.js";import{d as Jn}from"./hdos_itWSuQ2oYLgMGq-Z_V6WL.js";import{_ as el}from"./hdos_BcWAxXmlibZ2SSqtP9a_8.js";import{l as C}from"./hdos_BwFNaVKxrzJr1i43ZL7xh.js";import{S as To,a as oa}from"./hdos_BvZS1CaDz5Y0g1rf_BFiS.js";import{P as na,U as tl}from"./hdos_Chxu3XlxYkKc8Frbqqhp3.js";import"./hdos_2V3v_F_0jH8MGzNGWND27.js";import{b as al,I as Io}from"./hdos_DHddfElURubpzULFfe26f.js";import{A as ol}from"./hdos_CbnsOEP800GNy8TwhZu5X.js";import"./hdos_Dz3aTMQqM4LnOlKzV3COc.js";import"./hdos_B3Gn8FiDAIlVGTwMyO36P.js";import"./hdos_DCQvziD-0BGtLQC-jPv6N.js";import"./hdos_CJoaCRc7PMIr83ndc1bSY.js";import"./hdos_CtY2UTrCU7CborQ9sr8jv.js";import"./hdos_Cuccj8xUVyEDTvA_fcq1n.js";import"./hdos_TIm5gfXqLWlO6DtkdAyHA.js";import"./hdos_CDFYpsm_-2sqqpjcHcxLG.js";import"./hdos_D63Tfrq7hZ9D-jbqbBA6V.js";import"./hdos_gyw9xS5KcI5AuUkDD9uV1.js";import"./hdos_DaMzMFtabbBV30Ol-afWE.js";import"./hdos_rfaQpGnOmO949nI3XBr-z.js";import"./hdos_CUVtAAKH5Rvh1aKqeC6HP.js";import"./hdos_Bk1zzRUDOtQzy_FbGlDW7.js";import"./hdos_Blzg6MeUL0edHOOtBeGpe.js";import"./hdos_CVKBQqLuWsNsJIb4j3htb.js";import"./hdos_CzoE9SOL1adftRMeThf5c.js";import"./hdos_ByOs9_ky4lh8X4haCD9fj.js";const nl=Bo("FileExplorerStore",()=>{const R=Ho(),L=f([]),l=f([]),_=f("storage"),oe=f(""),F=f(!1),j=f(!1),Qe=f(0),pe=f(0),Re=f(null),ke=f(0),Ze=S(()=>L.value.length),re=S(()=>l.value.length),x=S(()=>L.value.length>0),r=S(()=>l.value.length>0);async function be(){F.value=!0;try{const M=await b.get("/api/fileexplorer/favorites",{headers:{"X-HomeDock-CSRF-Token":R.value}});L.value=M.data.favorites||[],Qe.value=Date.now()}catch(M){console.error("Failed to fetch favorites:",M)}finally{F.value=!1}}async function X(M){try{return await b.post("/api/fileexplorer/favorites/add",M,{headers:{"X-HomeDock-CSRF-Token":R.value}}),await be(),!0}catch(G){return console.error("Failed to add favorite:",G),!1}}async function ut(M){try{return await b.post("/api/fileexplorer/favorites/remove",M,{headers:{"X-HomeDock-CSRF-Token":R.value}}),await be(),!0}catch(G){return console.error("Failed to remove favorite:",G),!1}}function _e(M,G,Tt){return L.value.some(V=>V.location===M&&V.path===G&&V.name===Tt)}async function W(){j.value=!0;try{const M=await b.get("/api/fileexplorer/recents",{headers:{"X-HomeDock-CSRF-Token":R.value}});l.value=M.data.recents||[],pe.value=Date.now()}catch(M){console.error("Failed to fetch recents:",M)}finally{j.value=!1}}async function g(M){try{return await b.post("/api/fileexplorer/recents/add",M,{headers:{"X-HomeDock-CSRF-Token":R.value}}),W(),!0}catch(G){return console.error("Failed to add recent:",G),!1}}async function I(M){try{return await b.post("/api/fileexplorer/recents/remove",M,{headers:{"X-HomeDock-CSRF-Token":R.value}}),await W(),!0}catch(G){return console.error("Failed to remove recent:",G),!1}}async function Je(){try{return await b.post("/api/fileexplorer/recents/clear",{},{headers:{"X-HomeDock-CSRF-Token":R.value}}),l.value=[],pe.value=Date.now(),!0}catch(M){return console.error("Failed to clear recents:",M),!1}}function ee(M){_.value=M,oe.value="",M!=="appdrive"&&(Re.value=null,ke.value=0)}function ie(M){oe.value=M}function le(M,G=0){Re.value=M,ke.value=G}async function dt(){await Promise.all([be(),W()])}return{favorites:L,recents:l,currentLocation:_,currentPath:oe,isLoadingFavorites:F,isLoadingRecents:j,lastFavoritesUpdate:Qe,lastRecentsUpdate:pe,selectedContainer:Re,selectedMountIndex:ke,favoritesCount:Ze,recentsCount:re,hasFavorites:x,hasRecents:r,fetchFavorites:be,addToFavorites:X,removeFromFavorites:ut,isFavorite:_e,fetchRecents:W,addToRecents:g,removeFromRecents:I,clearRecents:Je,setLocation:ee,setPath:ie,setAppDriveContainer:le,initialize:dt}}),Do="unifiedFileViewerStatus",ll=Bo("FileViewerPrefsStore",()=>{const R=f("name"),L=f("asc"),l=f("grid");function _(){try{const F=localStorage.getItem(Do);if(F){const j=JSON.parse(F);R.value=j.sortBy||"name",L.value=j.sortDirection||"asc",l.value=j.viewMode||"grid"}}catch(F){console.warn("[FileViewerPrefs] Failed to load from localStorage:",F)}}function oe(){try{const F={sortBy:R.value,sortDirection:L.value,viewMode:l.value};localStorage.setItem(Do,JSON.stringify(F))}catch(F){console.warn("[FileViewerPrefs] Failed to save to localStorage:",F)}}return Ct([R,L,l],()=>{oe()}),{sortBy:R,sortDirection:L,viewMode:l,load:_,save:oe}}),sl={width:24,height:24,body:'<path fill="currentColor" d="M22 8v5.81c-.88-.51-1.9-.81-3-.81c-3.31 0-6 2.69-6 6c0 .34.04.67.09 1H4a2 2 0 0 1-2-2V6c0-1.11.89-2 2-2h6l2 2h8a2 2 0 0 1 2 2m-4 8l-3 3l3 3v-2h4v-2h-4v-2Z"/>'},rl={width:24,height:24,body:'<path fill="currentColor" d="M4 4v18h16v2H4c-1.1 0-2-.9-2-2V4h2m11 3h5.5L15 1.5V7M8 0h8l6 6v12c0 1.11-.89 2-2 2H8a2 2 0 0 1-2-2V2c0-1.11.89-2 2-2m9 16v-2H8v2h9m3-4v-2H8v2h12Z"/>'},il={width:24,height:24,body:'<path fill="currentColor" d="M22 16V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2m-11-4l2.03 2.71L16 11l4 5H8M2 6v14a2 2 0 0 0 2 2h14v-2H4V6"/>'},cl={width:24,height:24,body:'<path fill="currentColor" d="m18 16l-4-3.2V16H6V8h8v3.2L18 8m2-4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2Z"/>'},ul={width:24,height:24,body:'<path fill="currentColor" d="M4 6H2v14a2 2 0 0 0 2 2h14v-2H4M18 7h-3v5.5a2.5 2.5 0 0 1-2.5 2.5a2.5 2.5 0 0 1-2.5-2.5a2.5 2.5 0 0 1 2.5-2.5c.57 0 1.08.19 1.5.5V5h4m2-3H8a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z"/>'},dl={width:24,height:24,body:'<path fill="currentColor" d="M5 3h14a2 2 0 0 1 2 2v14c0 1.11-.89 2-2 2H5a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2m3 14h8v-2H8v2m8-7h-2.5V7h-3v3H8l4 4l4-4Z"/>'},pl={width:24,height:24,body:'<path fill="currentColor" d="M19 17h3l-4 4l-4-4h3V3h2M2 17h10v2H2M6 5v2H2V5m0 6h7v2H2v-2Z"/>'},vl={width:24,height:24,body:'<path fill="currentColor" d="M19 7h3l-4-4l-4 4h3v14h2M2 17h10v2H2M6 5v2H2V5m0 6h7v2H2v-2Z"/>'},ml={width:24,height:24,body:'<path fill="currentColor" d="M3 11h8V3H3m0 18h8v-8H3m10 8h8v-8h-8m0-10v8h8V3"/>'},fl={width:24,height:24,body:'<path fill="currentColor" d="M9 5v4h12V5M9 19h12v-4H9m0-1h12v-4H9M4 9h4V5H4m0 14h4v-4H4m0-1h4v-4H4v4Z"/>'},zo={width:24,height:24,body:'<path fill="currentColor" d="m12 15.39l-3.76 2.27l.99-4.28l-3.32-2.88l4.38-.37L12 6.09l1.71 4.04l4.38.37l-3.32 2.88l.99 4.28M22 9.24l-7.19-.61L12 2L9.19 8.63L2 9.24l5.45 4.73L5.82 21L12 17.27L18.18 21l-1.64-7.03L22 9.24Z"/>'},$o={width:24,height:24,body:'<path fill="currentColor" d="M10 4h4v9l3.5-3.5l2.42 2.42L12 19.84l-7.92-7.92L6.5 9.5L10 13V4Z"/>'},hl={width:24,height:24,body:'<path fill="currentColor" d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/>'},xl={width:24,height:24,body:'<path fill="currentColor" d="M12 8a4 4 0 0 1 4 4a4 4 0 0 1-4 4a4 4 0 0 1-4-4a4 4 0 0 1 4-4m-8.95 5H1v-2h2.05C3.5 6.83 6.83 3.5 11 3.05V1h2v2.05c4.17.45 7.5 3.78 7.95 7.95H23v2h-2.05c-.45 4.17-3.78 7.5-7.95 7.95V23h-2v-2.05C6.83 20.5 3.5 17.17 3.05 13M12 5a7 7 0 0 0-7 7a7 7 0 0 0 7 7a7 7 0 0 0 7-7a7 7 0 0 0-7-7Z"/>'},yl=Zo({__name:"StatusBubble",props:{visible:{type:Boolean,default:!1},message:{default:""},icon:{default:void 0},spinning:{type:Boolean,default:!1},position:{default:"bottom-left"},teleport:{type:Boolean,default:!1},teleportTarget:{default:"body"}},setup(R){const L=R,{themeClasses:l}=Ao(),_=S(()=>{switch(L.position){case"bottom-left":return"bottom-10 left-3";case"bottom-right":return"bottom-10 right-3";case"top-left":return"top-2 left-2";case"top-right":return"top-2 right-2";default:return"bottom-12 left-6"}}),oe=S(()=>L.position.includes("left")?"slide-fade-left":"slide-fade-right");return(F,j)=>R.teleport?(u(),P(An,{key:0,to:R.teleportTarget},[p(de,{name:oe.value},{default:$(()=>[R.visible?(u(),d("div",{key:0,class:i([[t(l).dropZoneStatusBubble,_.value],"fixed z-[9998] px-4 py-2.5 rounded-lg border flex items-center gap-2 min-w-[200px] max-w-[300px]"])},[R.icon?(u(),P(t(v),{key:0,icon:R.icon,class:i([[t(l).dropZoneStatusIcon,R.spinning&&"animate-spin"],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"])):(u(),P(t(v),{key:1,icon:t(ne),class:i([[t(l).dropZoneStatusIcon,"animate-spin"],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"])),s("span",{class:i([[t(l).dropZoneStatusText],"text-sm font-medium truncate"])},h(R.message),3)],2)):y("",!0)]),_:1},8,["name"])],8,["to"])):(u(),P(de,{key:1,name:oe.value},{default:$(()=>[R.visible?(u(),d("div",{key:0,class:i([[t(l).dropZoneStatusBubble,_.value],"fixed z-[9998] px-4 py-2.5 rounded-lg border flex items-center gap-2 min-w-[200px] max-w-[300px]"])},[R.icon?(u(),P(t(v),{key:0,icon:R.icon,class:i([[t(l).dropZoneStatusIcon,R.spinning&&"animate-spin"],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"])):(u(),P(t(v),{key:1,icon:t(ne),class:i([[t(l).dropZoneStatusIcon,"animate-spin"],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"])),s("span",{class:i([[t(l).dropZoneStatusText],"text-sm font-medium truncate"])},h(R.message),3)],2)):y("",!0)]),_:1},8,["name"]))}}),gl=Lo(yl,[["__scopeId","data-v-73a9aa30"]]),wl={key:0,class:"absolute inset-0 z-[9999] pointer-events-none backdrop-blur-sm"},kl={class:"flex items-center align-center justify-center flex-col h-full"},bl={class:"ant-upload-drag-icon"},_l={class:"flex-1 overflow-y-auto py-2 px-2"},Sl={class:"sidebar-section mb-3"},Fl={class:"storage-section"},Cl={class:"expand-content"},Tl={class:"pl-4 mt-0.5 space-y-0.5 max-h-52 overflow-y-auto"},Il=["onClick"],Dl={class:"truncate"},zl={class:"dropzone-section"},$l={class:"expand-content"},Ml={class:"pl-4 mt-0.5 space-y-0.5 max-h-40 overflow-y-auto"},El=["onClick"],Rl={class:"truncate"},Zl={class:"appdrive-section"},Al={class:"expand-content"},Ll={class:"pl-4 mt-0.5 space-y-0.5 max-h-40 overflow-y-auto"},Bl=["onClick"],Hl={class:"relative flex-shrink-0"},Pl={class:"truncate"},Xl={class:"sidebar-section"},Ul={class:"sidebar-section"},Nl={class:"flex-1 flex flex-col overflow-hidden"},Vl={key:0,class:"relative"},Ol={class:"py-2 px-2"},Yl={class:"storage-section"},jl={class:"expand-content"},Wl={class:"pl-4 mt-0.5 space-y-0.5 max-h-52 overflow-y-auto"},Gl=["onClick"],ql={class:"truncate"},Kl={class:"dropzone-section"},Ql={class:"expand-content"},Jl={class:"pl-4 mt-0.5 space-y-0.5 max-h-40 overflow-y-auto"},es=["onClick"],ts={class:"truncate"},as={class:"appdrive-section"},os={class:"expand-content"},ns={class:"pl-4 mt-0.5 space-y-0.5 max-h-40 overflow-y-auto"},ls=["onClick"],ss={class:"relative flex-shrink-0"},rs={class:"truncate"},is={class:"sidebar-section"},cs={class:"sidebar-section"},us={key:0,class:"flex-1 flex items-center gap-2 min-w-0"},ds={class:"flex items-center gap-2"},ps={class:"truncate"},vs={class:"flex items-center gap-2 text-xs"},ms={class:"truncate"},fs={key:1,class:"relative"},hs=["title"],xs={class:"py-2 px-2"},ys=["onClick"],gs={class:"truncate flex-1"},ws={key:2,class:"flex-1"},ks={key:0,class:"flex items-center gap-2 flex-shrink-0"},bs=["title"],_s=["title"],Ss=["onClick"],Fs={key:0,class:"ml-0.5"},Cs={key:0,class:"flex flex-col items-center justify-center h-full text-center py-12"},Ts={key:1,class:"flex flex-col items-center justify-center h-full text-center py-12"},Is=["data-filename","onClick","onDblclick","onTouchstart","onTouchend"],Ds=["title"],zs=["data-filename","onClick","onDblclick","onTouchstart","onTouchend"],$s=["title"],Ms={class:"opacity-50 font-normal"},Es=["data-filename","onClick","onDblclick","onContextmenu","onTouchstart","onTouchend"],Rs=["title"],Zs={class:"text-[10px] font-semibold truncate"},As={class:"text-[9px] opacity-60 ml-auto flex-shrink-0 whitespace-nowrap"},Ls=["data-filename","onClick","onDblclick","onContextmenu","onTouchstart","onTouchend"],Bs={key:1,class:"absolute -left-1 -bottom-1 flex items-center gap-0.5 z-10"},Hs={key:2,class:"absolute -right-1 -top-1 flex items-center gap-0.5"},Ps={key:3,class:"absolute -right-1 -top-1 z-20"},Xs={key:4,class:"absolute inset-0 flex items-center justify-center z-10"},Us=["title"],Ns={key:0,class:"absolute -bottom-1 left-2 right-2"},Vs=["data-filename","onClick","onDblclick","onContextmenu","onTouchstart","onTouchend"],Os={key:1,class:"absolute -left-1 -bottom-1 flex items-center gap-0.5 z-10"},Ys={key:2,class:"absolute -right-1 -top-1 flex items-center gap-0.5"},js={key:3,class:"absolute -right-1 -top-1 z-20"},Ws={key:4,class:"absolute inset-0 flex items-center justify-center z-10"},Gs=["title"],qs={key:0,class:"absolute -bottom-1 left-2 right-2"},Ks=["data-filename","onClick","onDblclick","onTouchstart","onTouchend"],Qs={class:"relative flex-shrink-0 z-[1]"},Js={class:"flex-1 overflow-hidden z-[1]"},er=["title"],tr=["data-filename","onClick","onDblclick","onTouchstart","onTouchend"],ar={class:"relative flex-shrink-0 z-[1]"},or={class:"flex-1 overflow-hidden z-[1]"},nr=["title"],lr={class:"opacity-50 font-normal"},sr=["data-filename","onClick","onDblclick","onContextmenu","onTouchstart","onTouchend"],rr={class:"relative flex-shrink-0 z-[1]"},ir={key:0,class:"absolute inset-0 flex items-center justify-center"},cr={class:"flex-1 overflow-hidden z-[1]"},ur=["title"],dr={class:"text-[10px] font-semibold truncate"},pr={class:"text-[9px] opacity-60 ml-auto flex-shrink-0 whitespace-nowrap"},vr=["data-filename","onClick","onDblclick","onContextmenu","onTouchstart","onTouchend"],mr={class:"relative flex-shrink-0 z-[1]"},fr={key:0,class:"absolute -right-1 -bottom-1"},hr={key:1,class:"absolute inset-0 flex items-center justify-center"},xr={class:"flex-1 overflow-hidden z-[1]"},yr=["title"],gr=["data-filename","onClick","onDblclick","onContextmenu","onTouchstart","onTouchend"],wr={class:"relative flex-shrink-0 z-[1]"},kr={key:0,class:"absolute -right-1 -bottom-1"},br={key:1,class:"absolute inset-0 flex items-center justify-center"},_r={class:"flex-1 overflow-hidden z-[1]"},Sr=["title"],Fr={class:"flex items-center gap-2 flex-1 min-w-0"},Cr={class:"flex mt-1.5 items-center flex-1 max-w-xs"},Tr={class:"expand-content"},Ir={class:"max-h-40 overflow-y-auto py-1"},Dr={class:"flex items-center gap-1.5"},zr={class:"flex-1 min-w-0"},$r={class:"flex items-center gap-1.5 mb-0.5"},Mr=["title"],Er={class:"space-y-2.5 max-w-sm"},Rr={class:"flex items-center gap-2"},Zr={class:"mb-1"},Ar={class:"mb-1"},Lr={class:"space-y-3"},Br={key:0},Hr=20,Pr=300,Xr=30,Mo=500,Eo=10,Ur=400,la=12,sa=8,Nr=3,Ke=110,Ne=125,Ro=600,Vr=680,Or=Zo({__name:"AppFileExplorer",props:{_windowId:{},initialLocation:{},initialContainer:{},initialMountIndex:{}},setup(R){const L=R,{themeClasses:l}=Ao(),_=Ho(),oe=Pn(),F=nl(),j=Xn(),Qe=ll(),pe=Un(),{sortBy:Re,sortDirection:ke,viewMode:Ze}=Nn(Qe),re=f([]),x=f(""),r=f("storage"),be=f(!1),X=f(""),ut=f(!1),_e=f([]),W=f([]),g=f(null),I=f(0),Je=f(!1),ee=f(!1),ie=f(!1),le=f(!1),dt=["Notes","Documents","Photos","Videos","Music","Downloads"];function M(e){return r.value==="storage"&&!x.value&&e.is_directory&&dt.includes(e.name)}const G=f([]),Tt=f(!1),V=f(null),A=f(new Set),Ae=f(!1),Z=f({startX:0,startY:0,currentX:0,currentY:0}),Ve=f(null),It=f(!1);let Dt=!1,ra=0,ia=0,ca=0,Oe=null,$a=0,Ma=0,pt=null,et=!1,zt=!1,Ea=0,Se=null,Ra=0,Za=0,$t=!1;const Aa=f([]),Mt=f(!1),Et=f(0),vt=f(!1),Rt=f([]),Zt=f(0);let ua=!1;const Po=f(""),Xo=f(!1),U=f({}),N=f({}),k=f({}),Q=f(new Set),da=f(!1),La=f(0),Ba=f(0),pa=f(null),Ye=f(!1),va=f(""),ma=f(""),ve=f(null),tt=f(!1),Fe=f(""),mt=f(!1),me=f(""),at=f(null),ft=f(!1),Le=f(null),At=f(null),Ce=f(null),Lt=f(null),Ha=f(null),Te=f(0),Ie=f(typeof window<"u"&&window.innerWidth<Ro);function Pa(e){e<=0||(!Ie.value&&e<Ro?(Ie.value=!0,O.value=!1):Ie.value&&e>Vr&&(Ie.value=!1,O.value=!1,De.value=!1))}const O=f(!1),ot=f(!1),De=f(!1),Bt=new Set(["txt","md","markdown","json","yml","yaml","xml","conf","ini","env","log","js","ts","jsx","tsx","mjs","cjs","vue","svelte","astro","py","pyw","pyi","sh","bash","zsh","fish","ps1","bat","cmd","css","scss","sass","less","styl","html","htm","xhtml","sql","csv","tsv","c","cpp","h","hpp","cs","java","kt","kts","go","rs","rb","php","pl","pm","r","rmd","swift","m","mm","scala","groovy","lua","tcl","tex","latex","sty","cls","bib","bst","dtx","ins","dockerfile","makefile","cmake","gradle","properties","toml","lock","gitignore","gitattributes","editorconfig","prettierrc","eslintrc","babelrc"]),Xa=new Set(["jpg","jpeg","png","gif","webp","bmp","ico","tif","tiff"]),Ua=new Set(["mp4","webm","ogv","ogg","mp3","wav","aac","flac","m4a"]),Na=new Set(["pdf"]),Uo={folder:H,txt:Sa,md:Sa,pdf:wo,png:it,jpg:it,jpeg:it,gif:it,webp:it,mp4:Qt,mkv:Qt,avi:Qt,mp3:Ia,wav:Ia,flac:Ia,zip:Ee,rar:Ee,"7z":Ee,tar:Ee,gz:Ee,doc:Fo,docx:Fo,xls:Ta,xlsx:Ta,csv:Ta,ppt:So,pptx:So,js:se,ts:se,py:se,java:se,cpp:se,c:se,h:se,html:se,css:se,json:se,xml:se,sh:se,sql:se},Ht=S(()=>_e.value.filter(e=>{const o=oe.dockerApps.find(a=>a.name===e.name);return!o?.HDRole||o.HDRole!=="dependency"}).sort((e,o)=>e.status==="running"&&o.status!=="running"?-1:e.status!=="running"&&o.status==="running"?1:e.name.localeCompare(o.name))),ht=S(()=>Vn().filter(e=>e.category!=="utilities")),xt=S(()=>On),yt=S(()=>ht.value.map(e=>({name:e.id,display_name:e.name,size:0,modified:0,is_directory:!1,is_app:!0,_appId:e.id,_appIcon:e.icon,_appDescription:e.description}))),gt=S(()=>xt.value.map(e=>({name:e.id,display_name:e.name,size:0,modified:0,is_directory:!1,is_app:!0,_appId:e.id,_appIcon:e.icon,_appDescription:e.description}))),fa=S(()=>W.value.length===0||I.value<0||I.value>=W.value.length?null:W.value[I.value]),wt=S(()=>r.value==="appdrive"&&fa.value?.read_only||!1),nt=S(()=>r.value==="favorites"||r.value==="recents"||r.value==="systemapps"||r.value==="utilities"?!1:r.value==="appdrive"?g.value&&!wt.value:!0),J=S(()=>r.value==="favorites"||r.value==="recents"||r.value==="systemapps"||r.value==="utilities"),No=S(()=>!(J.value||r.value==="appdrive"&&!g.value)),Vo=S(()=>{switch(r.value){case"storage":return"Storage";case"dropzone":return"Drop Zone";case"appdrive":return Be(g.value||"").displayName||"App Drive";case"systemapps":return"System Apps";case"utilities":return"Utilities";default:return""}}),Oo=S(()=>{switch(r.value){case"storage":return H;case"dropzone":return Ue;case"appdrive":return rt;case"systemapps":return Kt;case"utilities":return qt;default:return H}}),Yo=S(()=>{switch(r.value){case"favorites":return zo;case"recents":return Ft;case"systemapps":return Kt;case"utilities":return qt;default:return H}}),jo=S(()=>{switch(r.value){case"favorites":return"No favorites yet. Right-click on files to add them.";case"recents":return"No recent files.";case"appdrive":return g.value?wt.value?"This mount is empty.":"Drag and drop files to upload.":"Select an application from the sidebar.";case"systemapps":return"No system apps available.";case"utilities":return"No utilities available.";default:return"Drag and drop files to upload."}}),ha=S(()=>x.value?x.value.split("/").filter(e=>e):[]),ze=S(()=>r.value==="favorites"?F.favorites.map(e=>({name:e.name,display_name:e.name,size:0,modified:e.added_at,is_directory:e.is_directory,_meta:e,_source:e.location,_sourcePath:e.path,_container:e.container})):r.value==="recents"?F.recents.map(e=>({name:e.name,display_name:e.name,size:0,modified:e.accessed_at,is_directory:e.is_directory,_meta:e,_source:e.location,_sourcePath:e.path,_container:e.container})):re.value);function Pt(e,o){const a=Math.max(1,Math.floor(o/Ke)),c=(o-16)/a;return e.map((m,w)=>{const D=w%a,E=Math.floor(w/a),T=8+D*c+(c-100)/2,q=E*Ne;return{...m,x:T,y:q}})}function Xt(e,o){if(e===0)return 0;const a=Math.max(1,Math.floor(o/Ke));return Math.ceil(e/a)*Ne}const xa=S(()=>{if(!J.value||r.value==="systemapps"||r.value==="utilities")return[];const e=Te.value||400,o=[],a=ze.value.filter(m=>m._source==="storage"),n=ze.value.filter(m=>m._source==="dropzone"),c=ze.value.filter(m=>m._source==="appdrive");return a.length>0&&o.push({key:"storage",label:"Storage",icon:H,files:a,positionedFiles:Pt(a,e),gridHeight:Xt(a.length,e)}),n.length>0&&o.push({key:"dropzone",label:"Drop Zone (Encrypted)",icon:Ue,files:n,positionedFiles:Pt(n,e),gridHeight:Xt(n.length,e)}),c.length>0&&o.push({key:"appdrive",label:"App Drive (Docker Volumes)",icon:rt,files:c,positionedFiles:Pt(c,e),gridHeight:Xt(c.length,e)}),o}),lt=S(()=>{const e=[...ze.value].sort((o,a)=>{if(o.is_directory&&!a.is_directory)return-1;if(!o.is_directory&&a.is_directory)return 1;let n=0;switch(Re.value){case"name":n=(o.display_name||o.name).localeCompare(a.display_name||a.name);break;case"size":n=o.size-a.size;break;case"date":n=o.modified-a.modified;break}return ke.value==="asc"?n:-n});return x.value&&!J.value?[{name:"..",display_name:"..",size:0,modified:0,is_directory:!0},...e]:e}),ya=S(()=>{const e=Te.value||400,o=Math.max(1,Math.floor(e/Ke)),n=(e-16)/o;return lt.value.map((c,m)=>{const w=m%o,D=Math.floor(m/o),E=8+w*n+(n-100)/2,T=8+D*Ne;return{...c,x:E,y:T}})}),Wo=S(()=>{const e=Te.value||400,o=Math.max(1,Math.floor(e/Ke)),n=(e-16)/o;return yt.value.map((c,m)=>{const w=m%o,D=Math.floor(m/o),E=8+w*n+(n-100)/2,T=8+D*Ne;return{...c,x:E,y:T}})}),Go=S(()=>{const e=Te.value||400,o=Math.max(1,Math.floor(e/Ke)),n=(e-16)/o;return gt.value.map((c,m)=>{const w=m%o,D=Math.floor(m/o),E=8+w*n+(n-100)/2,T=8+D*Ne;return{...c,x:E,y:T}})}),qo=S(()=>{if(ht.value.length===0)return 0;const e=Te.value||400,o=Math.max(1,Math.floor(e/Ke));return Math.ceil(ht.value.length/o)*Ne+16}),Ko=S(()=>{if(xt.value.length===0)return 0;const e=Te.value||400,o=Math.max(1,Math.floor(e/Ke));return Math.ceil(xt.value.length/o)*Ne+16}),Va=S(()=>{if(!kt.value)return[];const e=Te.value||400,o=new Map;return lt.value.forEach(a=>{if(a.name==="..")return;const n=a.name.includes("/")?a.name.substring(0,a.name.lastIndexOf("/")):"";o.has(n)||o.set(n,[]),o.get(n).push(a)}),Array.from(o.entries()).map(([a,n])=>({folder:a,files:n,positionedFiles:Pt(n,e),gridHeight:Xt(n.length,e)})).sort((a,n)=>a.folder===""&&n.folder!==""?-1:a.folder!==""&&n.folder===""?1:a.folder.localeCompare(n.folder))}),Oa=S(()=>ya.value.length===0?200:Math.max(...ya.value.map(o=>o.y))+Ne+16),Ya=S(()=>{const e=re.value.reduce((o,a)=>o+(a.size||0),0);return ka(e)}),Qo=S(()=>!X.value||X.value.length<2?[]:[...re.value].filter(o=>(o.display_name||o.name).toLowerCase().includes(X.value.toLowerCase())).sort((o,a)=>o.is_directory&&!a.is_directory?-1:!o.is_directory&&a.is_directory?1:(o.display_name||o.name).localeCompare(a.display_name||a.name)).slice(0,15).map(o=>({value:o.name,label:o.display_name||o.name.split("/").pop()||o.name,isDirectory:o.is_directory,fileName:o.name}))),kt=S(()=>X.value&&X.value.trim().length>=2),Ut=S(()=>r.value==="storage"||r.value==="dropzone"||r.value==="appdrive"?r.value:null),Jo=S(()=>{const e=Ut.value;return e?j.isUploadingAt(e):!1}),je=S(()=>{const e=Ut.value;return e?j.currentlyUploadingAt(e):[]}),ga=S(()=>{const e=Ut.value;return e?j.queueAt(e):[]}),wa=S(()=>{const e=Ut.value;return e?j.uploadProgressAt(e):{}}),en=S(()=>{const e=je.value;if(e.length===0)return 0;let o=0;return e.forEach(a=>{o+=wa.value[a.uid]||0}),Math.round(o/e.length)}),tn=S(()=>{switch(r.value){case"storage":return H;case"dropzone":return Ue;case"appdrive":return rt;case"favorites":return St;case"recents":return Ft;default:return go}}),an=S(()=>{switch(r.value){case"storage":return"Storage";case"dropzone":return"Drop Zone (Encrypted)";case"appdrive":return g.value?Be(g.value).displayName:"App Drive";case"favorites":return"Favorites";case"recents":return"Recents";default:return"File Explorer"}}),on=S(()=>r.value==="appdrive"&&fa.value?fa.value.container_path:`${ze.value.length} items`),nn=S(()=>{const e=Math.min(Z.value.startX,Z.value.currentX),o=Math.min(Z.value.startY,Z.value.currentY),a=Math.abs(Z.value.currentX-Z.value.startX),n=Math.abs(Z.value.currentY-Z.value.startY);return{left:`${e}px`,top:`${o}px`,width:`${a}px`,height:`${n}px`}});function ja(e){const o=[];let a=!0;for(const n of e)n.divider?a||(o.push(n),a=!0):(o.push(n),a=!1);for(;o.length>0&&o[o.length-1].divider;)o.pop();return o}const ln=S(()=>{const e=[],o=pa.value,a=A.value.size;if(o&&o.name==="..")return[];if(a>1){const n=Array.from(A.value).map(T=>ze.value.find(q=>q.name===T)).filter(T=>T!==void 0),c=n.some(T=>T.is_directory),m=n.some(T=>M(T)),w=n.filter(T=>!T.is_directory),D=a>3||c,E=["favorites","recents","systemapps","utilities"].includes(r.value);return e.push({label:`Selected: ${a} items`,icon:ko,disabled:!0}),e.push({divider:!0}),E||(D?e.push({label:"Download as ZIP",icon:Ee,action:async()=>{const T=n.map(q=>q.name);_t(),await _a(T)}}):w.length>0&&e.push({label:"Download All",icon:$o,action:async()=>{for(const T of w)await ba(T);_t()}})),!wt.value&&!J.value&&!m&&e.push({label:"Delete All",icon:Co,danger:!0,action:()=>{va.value=`Delete ${a} items?`,ma.value=`Are you sure you want to delete ${a} selected items? This action cannot be undone.`,ve.value=null,Ye.value=!0,_t()}}),e.push({divider:!0}),nt.value&&e.push({label:"New Folder",icon:Fa,action:()=>tt.value=!0}),e.push({label:"Refresh",icon:Ca,action:He}),ja(e)}if(o)if(J.value&&o._source){const n=o,c=r.value==="favorites";e.push({label:o.is_directory?"Locate Folder":"Locate File",icon:xl,action:()=>kn(o)}),e.push({label:c?"Remove from Favorites":"Remove from Recents",icon:c?St:Ft,action:()=>{c?(F.removeFromFavorites({location:n._source,path:n._sourcePath||"",name:o.name}),C.success("Removed from favorites")):(F.removeFromRecents({location:n._source,path:n._sourcePath||"",name:o.name}),C.success("Removed from recents"))}})}else if(r.value==="systemapps"||r.value==="utilities")e.push({label:"Open",icon:H,action:()=>ue(o)});else{if(o.is_directory)e.push({label:"Open",icon:H,action:()=>to(o)}),e.push({label:"Download as ZIP",icon:Ee,action:()=>_a([o.name])});else{const c=o.name.split(".").pop()?.toLowerCase()||"",m=o.name.toLowerCase();(Bt.has(c)||Bt.has(m))&&e.push({label:"Open in Notepad",icon:Sa,action:()=>no(o)}),Xa.has(c)&&(e.push({label:"Open in Image Viewer",icon:it,action:()=>lo(o)}),e.push({label:"Open in Brusher",icon:Yn,action:()=>hn(o)})),Ua.has(c)&&e.push({label:"Open in Media Player",icon:Qt,action:()=>ro(o)}),Na.has(c)&&e.push({label:"Open in PDF Viewer",icon:wo,action:()=>so(o)}),e.push({label:"Download",icon:$o,action:()=>ba(o)})}e.push({divider:!0});const n=F.isFavorite(r.value,x.value,o.name);e.push({label:n?"Remove from Favorites":"Add to Favorites",icon:n?St:zo,action:()=>wn(o)}),!wt.value&&!M(o)&&(e.push({divider:!0}),e.push({label:"Rename",icon:za,action:()=>gn(o)}),e.push({label:"Delete",icon:Co,danger:!0,action:()=>xn(o)})),e.push({divider:!0}),e.push({label:"Properties",icon:jn,action:()=>zn(o)})}else nt.value&&(e.push({label:"New Folder",icon:Fa,action:()=>tt.value=!0}),e.push({label:"Upload Files",icon:Da,action:bn})),e.push({label:"Refresh",icon:Ca,action:He});return ja(e)});function Be(e){const o=oe.dockerApps.find(a=>a.name===e);return{displayName:o?.display_name||e,iconPath:o?.image_path||"docker-icons/notfound.jpg"}}const Nt={Notes:qn,Documents:rl,Photos:il,Videos:cl,Music:ul,Downloads:dl};function fe(e){if(e.is_app&&e._appIcon)return e._appIcon;if(e.is_directory){if(e.name==="..")return sl;const a=e.display_name||e.name.split("/").pop()||e.name;return r.value==="storage"&&!x.value&&Nt[a]?Nt[a]:H}const o=e.name.split(".").pop()?.toLowerCase()||"";return Uo[o]||_o}function Vt(e){return e.display_name?e.display_name:e.name.split("/").pop()||e.name}function ka(e){if(e===0)return"0 B";const o=1024,a=["B","KB","MB","GB","TB"],n=Math.floor(Math.log(e)/Math.log(o));return parseFloat((e/Math.pow(o,n)).toFixed(2))+" "+a[n]}function Wa(e){if(e===0)return"0B";const o=1024,a=["B","K","M","G"],n=Math.floor(Math.log(e)/Math.log(o));return parseFloat((e/Math.pow(o,n)).toFixed(1))+a[n]}function he(e){if(!e.modified||e.name==="..")return"";const o=Date.now(),a=typeof e.modified=="number"?e.modified*1e3:new Date(e.modified).getTime(),n=o-a,c=Math.floor(n/6e4);if(c<1)return"now";if(c<60)return`${c}m`;const m=Math.floor(c/60);if(m<24)return`${m}h`;const w=Math.floor(m/24);return w<30?`${w}d`:""}function te(e){return V.value===e.name||A.value.has(e.name)}function sn(){ke.value=ke.value==="asc"?"desc":"asc",Qe.save()}function rn(){Ze.value=Ze.value==="grid"?"list":"grid",Qe.save()}function cn(){yo(()=>{const e=Ha.value?.$el?.querySelector("input");e&&e.focus()})}function ce(e){r.value=e,x.value="",V.value=null,A.value.clear(),O.value=!1,X.value="",e!=="appdrive"&&(g.value=null,W.value=[]),e==="storage"||e==="dropzone"?Y():e==="appdrive"&&We()}function un(e){pe.openWindow(e,{allowMultiple:!0})}function Ga(){ee.value=!ee.value,ee.value&&(ie.value=!1,le.value=!1,_e.value.length===0&&We())}function qa(){ie.value=!ie.value,ie.value&&(le.value=!1,ee.value=!1)}function Ka(e){r.value="storage",x.value=e,V.value=null,A.value.clear(),O.value=!1,X.value="",Y()}function Qa(){le.value=!le.value,le.value&&(ie.value=!1,ee.value=!1,G.value.length===0&&dn())}async function dn(){Tt.value=!0;try{const e=await b.get("/api/dropzone/files",{headers:{"X-HomeDock-CSRF-Token":_.value}});G.value=(e.data.files||[]).filter(o=>o.is_directory&&o.name!=="..").map(o=>o.display_name||o.name)}catch(e){console.error("Error loading Drop Zone folders:",e)}finally{Tt.value=!1}}function Ja(e){r.value="dropzone",x.value=e,V.value=null,A.value.clear(),O.value=!1,X.value="",Y()}function eo(e){r.value="appdrive",g.value=e,x.value="",O.value=!1,X.value="",bt(e)}function pn(){x.value="",Y()}function vn(e){const o=ha.value.slice(0,e+1);x.value=o.join("/"),Y()}function mn(){const e=ha.value;e.pop(),x.value=e.join("/"),Y()}function to(e){e.is_directory&&(kt.value?(X.value="",x.value=e.name):x.value=x.value?`${x.value}/${e.display_name||e.name}`:e.display_name||e.name,Y())}async function Y(){if(!J.value){be.value=!0;try{let e="";const o={};if(r.value==="storage")e="/api/storage/files",x.value&&(o.path=x.value);else if(r.value==="dropzone")e="/api/dropzone/files",x.value&&(o.path=x.value);else if(r.value==="appdrive"&&g.value)e="/api/appdrive/files",o.container=g.value,o.mount=String(I.value),x.value&&(o.path=x.value);else{re.value=[];return}const a=await b.get(e,{params:o,headers:{"X-HomeDock-CSRF-Token":_.value}});re.value=a.data.files||[],!x.value&&le.value&&r.value==="dropzone"&&(G.value=(a.data.files||[]).filter(n=>n.is_directory&&n.name!=="..").map(n=>n.display_name||n.name))}catch(e){console.error("Failed to load files:",e),re.value=[]}finally{be.value=!1}}}async function We(){Je.value=!0;try{const e=await b.get("/api/appdrive/containers",{headers:{"X-HomeDock-CSRF-Token":_.value}});_e.value=e.data.containers||[]}catch(e){console.error("Failed to load containers:",e),_e.value=[]}finally{Je.value=!1}}async function bt(e,o){try{const a=await b.get("/api/appdrive/mounts",{params:{container:e},headers:{"X-HomeDock-CSRF-Token":_.value}});W.value=a.data.mounts||[];const n=o??0;I.value=n<W.value.length?n:0,Y()}catch(a){console.error("Failed to load mounts:",a),W.value=[]}}function ao(){x.value="",Y()}function He(){r.value==="favorites"?F.fetchFavorites():r.value==="recents"?F.fetchRecents():Y()}async function oo(e=!1){if(!(!X.value||X.value.length<2&&!e)){ut.value=!0;try{let o="";const a={query:X.value.trim()};if(r.value==="storage")o="/api/storage/search";else if(r.value==="dropzone")o="/api/dropzone/search";else if(r.value==="appdrive"&&g.value)o="/api/appdrive/search",a.container=g.value,a.mount=String(I.value);else return;const n=await b.get(o,{params:a,headers:{"X-HomeDock-CSRF-Token":_.value}});re.value=n.data.files||[],x.value=""}catch(o){console.error("Search failed:",o)}finally{ut.value=!1}}}function fn(e,o){const a=String(typeof e=="object"?e.value:e),n=re.value.find(c=>c.name===a||c.display_name===a);if(n){if(X.value="",n.is_directory)x.value=n.name,Y();else if(n.name.includes("/")){const c=n.name.split("/");c.pop();const m=c.join("/");x.value=m,Y()}}}function xe(e,o){if(!Dt&&e.name!=="..")if(o.ctrlKey||o.metaKey)A.value.has(e.name)?(A.value.delete(e.name),V.value===e.name&&(V.value=null)):A.value.add(e.name);else if(o.shiftKey&&V.value){const a=lt.value.map(D=>D.name),n=a.indexOf(V.value),c=a.indexOf(e.name),[m,w]=n<c?[n,c]:[c,n];A.value.clear();for(let D=m;D<=w;D++)A.value.add(a[D])}else V.value=e.name,A.value.clear()}async function no(e){try{k.value[e.name]=0,r.value==="dropzone"&&(U.value[e.name]=!0,N.value[e.name]=!0);let o;if(r.value==="storage")o=await b.get("/api/storage/download",{params:{file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"text",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else if(r.value==="dropzone")o=await b.get(`/api/dropzone/download?file=${encodeURIComponent(e.name)}`,{headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"text",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else if(r.value==="appdrive"&&g.value)o=await b.get("/api/appdrive/download",{params:{container:g.value,mount:I.value,file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"blob",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else throw new Error("Invalid location or missing container");let a;r.value==="appdrive"?a=await o.data.text():a=o.data;const n=e.display_name||e.name.split("/").pop()||e.name;pe.openFileInApp("notepad",{title:`Notepad - ${n}`,data:{externalFile:{path:e.name,content:a,source:r.value,container:r.value==="appdrive"?g.value:void 0,mountIndex:r.value==="appdrive"?I.value:void 0}}}),J.value||F.addToRecents({location:r.value,path:x.value,name:e.name,is_directory:!1,container:r.value==="appdrive"&&g.value||void 0,mount_index:r.value==="appdrive"?I.value:void 0}),setTimeout(()=>{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1)},500)}catch{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1),C.error("Failed to open file")}}async function lo(e){try{k.value[e.name]=0,r.value==="dropzone"&&(U.value[e.name]=!0,N.value[e.name]=!0);let o;if(r.value==="storage")o=await b.get("/api/storage/download",{params:{file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else if(r.value==="dropzone")o=await b.get(`/api/dropzone/download?file=${encodeURIComponent(e.name)}`,{headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else if(r.value==="appdrive"&&g.value)o=await b.get("/api/appdrive/download",{params:{container:g.value,mount:I.value,file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else throw new Error("Invalid location or missing container");const a=e.display_name||e.name.split("/").pop()||e.name,n=e.name.split(".").pop()?.toLowerCase()||"";pe.openFileInApp("imageviewer",{data:{imageFile:{name:a,extension:n,buffer:o.data}}}),J.value||F.addToRecents({location:r.value,path:x.value,name:e.name,is_directory:!1,container:r.value==="appdrive"&&g.value||void 0,mount_index:r.value==="appdrive"?I.value:void 0}),setTimeout(()=>{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1)},500)}catch{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1),C.error("Failed to open image")}}async function so(e){try{k.value[e.name]=0,r.value==="dropzone"&&(U.value[e.name]=!0,N.value[e.name]=!0);let o;if(r.value==="storage")o=await b.get("/api/storage/download",{params:{file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:n=>{n.total&&(k.value[e.name]=Math.round(n.loaded*100/n.total))}});else if(r.value==="dropzone")o=await b.get(`/api/dropzone/download?file=${encodeURIComponent(e.name)}`,{headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:n=>{n.total&&(k.value[e.name]=Math.round(n.loaded*100/n.total))}});else if(r.value==="appdrive"&&g.value)o=await b.get("/api/appdrive/download",{params:{container:g.value,mount:I.value,file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:n=>{n.total&&(k.value[e.name]=Math.round(n.loaded*100/n.total))}});else throw new Error("Invalid location or missing container");const a=e.display_name||e.name.split("/").pop()||e.name;pe.openFileInApp("pdfviewer",{data:{pdfFile:{name:a,buffer:o.data}}}),J.value||F.addToRecents({location:r.value,path:x.value,name:e.name,is_directory:!1,container:r.value==="appdrive"&&g.value||void 0,mount_index:r.value==="appdrive"?I.value:void 0}),setTimeout(()=>{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1)},500)}catch{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1),C.error("Failed to open PDF")}}async function ro(e){try{k.value[e.name]=0,r.value==="dropzone"&&(U.value[e.name]=!0,N.value[e.name]=!0);let o;if(r.value==="storage")o=await b.get("/api/storage/download",{params:{file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else if(r.value==="dropzone")o=await b.get(`/api/dropzone/download?file=${encodeURIComponent(e.name)}`,{headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else if(r.value==="appdrive"&&g.value)o=await b.get("/api/appdrive/download",{params:{container:g.value,mount:I.value,file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else throw new Error("Invalid location or missing container");const a=e.display_name||e.name.split("/").pop()||e.name,n=e.name.split(".").pop()?.toLowerCase()||"";pe.openFileInApp("mediaplayer",{data:{mediaFile:{name:a,extension:n,buffer:o.data}}}),J.value||F.addToRecents({location:r.value,path:x.value,name:e.name,is_directory:!1,container:r.value==="appdrive"&&g.value||void 0,mount_index:r.value==="appdrive"?I.value:void 0}),setTimeout(()=>{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1)},500)}catch{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1),C.error("Failed to open media file")}}async function hn(e){try{k.value[e.name]=0,r.value==="dropzone"&&(U.value[e.name]=!0,N.value[e.name]=!0);let o;if(r.value==="storage")o=await b.get("/api/storage/download",{params:{file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else if(r.value==="dropzone")o=await b.get(`/api/dropzone/download?file=${encodeURIComponent(e.name)}`,{headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else if(r.value==="appdrive"&&g.value)o=await b.get("/api/appdrive/download",{params:{container:g.value,mount:I.value,file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"arraybuffer",onDownloadProgress:c=>{c.total&&(k.value[e.name]=Math.round(c.loaded*100/c.total))}});else throw new Error("Invalid location or missing container");const a=e.display_name||e.name.split("/").pop()||e.name,n=e.name.split(".").pop()?.toLowerCase()||"";pe.openFileInApp("brusher",{title:`Brusher - ${a}`,data:{imageFile:{name:a,extension:n,buffer:o.data}}}),J.value||F.addToRecents({location:r.value,path:x.value,name:e.name,is_directory:!1,container:r.value==="appdrive"&&g.value||void 0,mount_index:r.value==="appdrive"?I.value:void 0}),setTimeout(()=>{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1)},500)}catch{delete k.value[e.name],r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1),C.error("Failed to open image in Brusher")}}async function io(e,o,a,n,c){try{let m="";const w={};if(e==="storage")m="/api/storage/files",o&&(w.path=o);else if(e==="dropzone")m="/api/dropzone/files",o&&(w.path=o);else if(e==="appdrive"&&n)m="/api/appdrive/files",w.container=n,w.mount=String(c||0),o&&(w.path=o);else return!1;return((await b.get(m,{params:w,headers:{"X-HomeDock-CSRF-Token":_.value}})).data.files||[]).some(T=>T.name===a||T.display_name===a)}catch{return!1}}async function ue(e){const o=Date.now();if(!(o-Ea<Ur)){if(Ea=o,e.is_app&&e._appId){un(e._appId);return}if(e.name===".."){mn();return}if(J.value&&e._source){const a=e,n=a._sourcePath||"",c=r.value==="favorites";if(!await io(a._source,n,e.name,a._container,a._meta?.mount_index)){C.error(`File "${e.display_name||e.name}" no longer exists`),c?F.removeFromFavorites({location:a._source,path:n,name:e.name}):F.removeFromRecents({location:a._source,path:n,name:e.name});return}if(a._source==="appdrive"&&a._container){r.value="appdrive",g.value=a._container,ee.value=!0,e.is_directory?x.value=a._sourcePath?`${a._sourcePath}/${e.name}`:e.name:x.value=a._sourcePath||"";const w=a._meta?.mount_index!==void 0?a._meta.mount_index:0;bt(a._container,w).then(()=>{Y()})}else r.value=a._source,e.is_directory?x.value=a._sourcePath?`${a._sourcePath}/${e.name}`:e.name:x.value=a._sourcePath||"",Y();return}if(e.is_directory)to(e);else{const a=e.name.split(".").pop()?.toLowerCase()||"",n=e.name.toLowerCase();Bt.has(a)||Bt.has(n)?no(e):Xa.has(a)?lo(e):Ua.has(a)?ro(e):Na.has(a)?so(e):ba(e)}}}async function ba(e){if(k.value[e.name]!==void 0&&k.value[e.name]>0&&k.value[e.name]<100){C.info("Download already in progress");return}if(e.is_directory){await _a([e.name]);return}try{r.value==="dropzone"&&(U.value[e.name]=!0,N.value[e.name]=!0),r.value==="appdrive"&&e.is_directory&&Q.value.add(e.name),k.value[e.name]=0;let o;if(r.value==="storage")o=await b.get("/api/storage/download",{params:{file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"blob",onDownloadProgress:m=>{m.total&&(k.value[e.name]=Math.round(m.loaded*100/m.total))}});else if(r.value==="dropzone")o=await b.get(`/api/dropzone/download?file=${encodeURIComponent(e.name)}`,{headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"blob",onDownloadProgress:m=>{m.total&&(k.value[e.name]=Math.round(m.loaded*100/m.total))}});else if(r.value==="appdrive"&&g.value)o=await b.get("/api/appdrive/download",{params:{container:g.value,mount:I.value,file:e.name},headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"blob",onDownloadProgress:m=>{m.total&&(k.value[e.name]=Math.round(m.loaded*100/m.total))}});else throw new Error("Invalid location or missing container");const a=window.URL.createObjectURL(new Blob([o.data])),n=document.createElement("a");n.href=a;const c=e.display_name||e.name.split("/").pop()||"download";n.setAttribute("download",c),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a),J.value||F.addToRecents({location:r.value,path:x.value,name:e.name,is_directory:!1,container:r.value==="appdrive"&&g.value||void 0,mount_index:r.value==="appdrive"?I.value:void 0}),setTimeout(()=>{r.value==="dropzone"&&(U.value[e.name]=!1,N.value[e.name]=!1),delete k.value[e.name]},1e3)}catch(o){b.isAxiosError(o)?C.error(o.response?.data?.error_message||"Failed to download file. Please try again."):C.error("Failed to download file. Please try again."),delete k.value[e.name],r.value==="dropzone"&&(N.value[e.name]=!1,U.value[e.name]=!1),r.value==="appdrive"&&Q.value.delete(e.name)}}async function _a(e){if(e.length!==0)try{e.forEach(w=>{re.value.find(E=>E.name===w)?.is_directory&&Q.value.add(w)});let o;if(r.value==="storage")o=await b.post("/api/storage/download-multiple",{files:e},{headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"blob"});else if(r.value==="dropzone")o=await b.post("/api/dropzone/download-multiple",{files:e},{headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"blob"});else if(r.value==="appdrive"&&g.value)o=await b.post("/api/appdrive/download-multiple",{container:g.value,mount:I.value,files:e},{headers:{"X-HomeDock-CSRF-Token":_.value},responseType:"blob"});else throw new Error("Invalid location or missing container");const a=o.headers["content-disposition"];let n="download.zip";if(a){const w=a.match(/filename="?([^";\n]+)"?/);w&&(n=w[1].replace(/[<>:"/\\|?*]/g,"_"))}const c=window.URL.createObjectURL(new Blob([o.data])),m=document.createElement("a");m.href=c,m.setAttribute("download",n),document.body.appendChild(m),m.click(),document.body.removeChild(m),window.URL.revokeObjectURL(c),C.success(`Downloaded ${e.length} items as ZIP`)}catch{C.error("Failed to download files as ZIP")}finally{e.forEach(o=>{Q.value.delete(o)})}}function xn(e){ve.value=e,va.value=e.is_directory?"Delete Folder":"Delete File",ma.value=`Are you sure you want to delete "${e.display_name||e.name}"?`,Ye.value=!0}async function yn(){if(A.value.size>0&&!ve.value){const e=Array.from(A.value);let o=0,a=0;for(const n of e)try{r.value==="storage"?await b.post("/api/storage/delete",{file:n},{headers:{"X-HomeDock-CSRF-Token":_.value}}):r.value==="dropzone"?await b.post("/api/dropzone/delete",{file:n},{headers:{"X-HomeDock-CSRF-Token":_.value}}):r.value==="appdrive"&&g.value&&await b.post("/api/appdrive/delete",{container:g.value,mount:I.value,file:n},{headers:{"X-HomeDock-CSRF-Token":_.value}}),o++}catch{a++}o>0&&C.success(`Deleted ${o} item${o>1?"s":""}`),a>0&&C.error(`Failed to delete ${a} item${a>1?"s":""}`),A.value.clear(),V.value=null,He(),Ye.value=!1;return}if(ve.value)try{if(r.value==="storage")await b.post("/api/storage/delete",{file:ve.value.name},{headers:{"X-HomeDock-CSRF-Token":_.value}});else if(r.value==="dropzone"){const e=await b.post("/api/dropzone/delete",{file:ve.value.name},{headers:{"X-HomeDock-CSRF-Token":_.value}});if(e.data.success)C.success(e.data.message);else{C.error(e.data.error||"Failed to delete file");return}}else r.value==="appdrive"&&g.value?(await b.post("/api/appdrive/delete",{container:g.value,mount:I.value,file:ve.value.name},{headers:{"X-HomeDock-CSRF-Token":_.value}}),C.success(`Deleted ${ve.value.display_name||ve.value.name}`)):C.success("Deleted successfully");He()}catch(e){b.isAxiosError(e)?C.error(e.response?.data?.error_message||e.response?.data?.error||"Failed to delete"):C.error("Failed to delete")}finally{Ye.value=!1,ve.value=null}}function gn(e){at.value=e,me.value=e.display_name||e.name.split("/").pop()||"",mt.value=!0}async function co(){if(!at.value||!me.value.trim()){C.error("Please enter a new name");return}try{if(r.value==="storage")await b.post("/api/storage/rename",{old_name:at.value.name,new_name:me.value.trim()},{headers:{"X-HomeDock-CSRF-Token":_.value}}),C.success(`Renamed to "${me.value}"`);else if(r.value==="dropzone"){const e=await b.post("/api/dropzone/rename",{old_name:at.value.name,new_name:me.value.trim()},{headers:{"X-HomeDock-CSRF-Token":_.value}});if(e.data.success)C.success(e.data.message);else{C.error(e.data.error||"Failed to rename item");return}}else r.value==="appdrive"&&g.value&&(await b.post("/api/appdrive/rename",{container:g.value,mount:I.value,old_name:at.value.name,new_name:me.value.trim()},{headers:{"X-HomeDock-CSRF-Token":_.value}}),C.success(`Renamed to "${me.value}"`));mt.value=!1,at.value=null,me.value="",He()}catch(e){b.isAxiosError(e)?C.error(e.response?.data?.error||"Failed to rename"):C.error("Failed to rename")}}async function uo(){if(!Fe.value.trim()){C.error("Please enter a folder name");return}try{if(r.value==="storage")await b.post("/api/storage/create-folder",{name:Fe.value.trim(),path:x.value},{headers:{"X-HomeDock-CSRF-Token":_.value}}),C.success(`Created folder "${Fe.value}"`);else if(r.value==="dropzone"){const e=await b.post("/api/dropzone/create-folder",{name:Fe.value.trim(),path:x.value},{headers:{"X-HomeDock-CSRF-Token":_.value}});if(e.data.success)C.success(e.data.message);else{C.error(e.data.error||"Failed to create folder");return}}else r.value==="appdrive"&&g.value&&(await b.post("/api/appdrive/create-folder",{container:g.value,mount:I.value,name:Fe.value.trim(),path:x.value},{headers:{"X-HomeDock-CSRF-Token":_.value}}),C.success(`Created folder "${Fe.value}"`));tt.value=!1,Fe.value="",He()}catch(e){b.isAxiosError(e)?C.error(e.response?.data?.error||"Failed to create folder. Please try again."):C.error("Failed to create folder. Please try again.")}}async function wn(e){const o=r.value;F.isFavorite(o,x.value,e.name)?(await F.removeFromFavorites({location:o,path:x.value,name:e.name}),C.success("Removed from favorites")):(await F.addToFavorites({location:o,path:x.value,name:e.name,is_directory:e.is_directory,container:o==="appdrive"&&g.value||void 0,mount_index:o==="appdrive"?I.value:void 0}),C.success("Added to favorites"))}async function kn(e){const o=e;if(!o._source)return;const a=o._sourcePath||"",n=r.value==="favorites";if(!await io(o._source,a,e.name,o._container,o._meta?.mount_index)){C.error(`"${e.display_name||e.name}" no longer exists`),n?F.removeFromFavorites({location:o._source,path:a,name:e.name}):F.removeFromRecents({location:o._source,path:a,name:e.name});return}if(o._source==="appdrive"&&o._container){r.value="appdrive",g.value=o._container,ee.value=!0,x.value=a;const m=o._meta?.mount_index!==void 0?o._meta.mount_index:0;bt(o._container,m).then(()=>{Y().then(()=>{A.value.clear(),A.value.add(e.name),V.value=e.name})})}else r.value=o._source,x.value=a,Y().then(()=>{A.value.clear(),A.value.add(e.name),V.value=e.name})}function bn(){const e=document.createElement("input");e.type="file",e.multiple=!0,e.onchange=o=>{const a=o.target.files;a&&Ot(Array.from(a))},e.click()}function _n(e){e.preventDefault(),Et.value++,e.dataTransfer?.types.includes("Files")&&(Mt.value=!0)}function Sn(e){e.preventDefault(),Et.value--,Et.value===0&&(Mt.value=!1)}async function Fn(e){if(e.preventDefault(),Et.value=0,Mt.value=!1,!nt.value)return;const o=e.dataTransfer?.items;if(!o)return;const a=[],n=[],c=async(w,D="")=>{if(w.isFile){const E=w;return new Promise(T=>{E.file(q=>{q.name.startsWith(".")||a.push({file:q,relativePath:D?`${D}/${q.name}`:q.name}),T()})})}else if(w.isDirectory){const E=w,T=D?`${D}/${w.name}`:w.name;n.push(T);const q=E.createReader();return new Promise(st=>{q.readEntries(async Pe=>{for(const Ge of Pe)await c(Ge,T);st()})})}},m=[];for(let w=0;w<o.length;w++){const D=o[w].webkitGetAsEntry();D&&m.push(D)}for(const w of m)await c(w);n.length>0?(Le.value={allFiles:a,folders:n},ft.value=!0):Ot(a.map(w=>w.file))}function Cn(){Le.value&&Ot(Le.value.allFiles.map(e=>e.file),Le.value.allFiles),ft.value=!1,Le.value=null}function Tn(){ft.value=!1,Le.value=null}async function po(){if(!ua){ua=!0;try{for(;Zt.value<Nr&&Rt.value.length>0;){const e=Rt.value.shift();if(!e)break;Zt.value++;const o=e.location;j.startUpload(o,{uid:e.uid,name:e.file.name,size:e.file.size}),(async()=>{try{const a=new FormData;a.append("file",e.file),e.targetPath&&a.append("path",e.targetPath);let n="";e.location==="storage"?n="/api/storage/upload":e.location==="dropzone"?n="/api/dropzone/upload":e.location==="appdrive"&&e.container&&(n="/api/appdrive/upload",a.append("container",e.container),a.append("mount",String(e.mountIndex||0)));const c=await b.post(n,a,{headers:{"X-HomeDock-CSRF-Token":_.value},onUploadProgress:m=>{if(m.total){const w=Math.round(m.loaded/m.total*100);j.updateProgress(o,e.uid,w)}}});c.data.success?j.completeUpload(o,e.uid):(j.cancelUpload(o,e.uid),C.error(c.data.error||"Upload failed"))}catch(a){j.cancelUpload(o,e.uid),b.isAxiosError(a)?a.response?.status===413?C.error("The selected file is larger than the maximum allowed size."):C.error(a.response?.data?.error_message||a.response?.data?.error||`Failed to upload ${e.file.name}`):C.error(`Failed to upload ${e.file.name}`)}finally{Zt.value--,po()}})()}}finally{ua=!1}Zt.value===0&&Rt.value.length===0&&setTimeout(()=>{He(),vt.value=!1},500)}}async function Ot(e,o){if(!nt.value)return;const a=r.value,n=g.value||void 0,c=I.value,m=x.value;if(!(a==="storage"||a==="dropzone"||a==="appdrive"))return;const D=a;for(let E=0;E<e.length;E++){const T=e[E],q=o?o[E].relativePath:T.name,st=`${Date.now()}-${E}-${Math.random().toString(36).substring(2,11)}`;let Pe="";if(o){const Ge=q.split("/").slice(0,-1).join("/");Ge?Pe=m?`${m}/${Ge}`:Ge:m&&(Pe=m)}else m&&(Pe=m);j.addToQueue(D,{uid:st,name:T.name,size:T.size}),Rt.value.push({file:T,uid:st,targetPath:Pe,location:a,container:n,mountIndex:c})}po()}function In(e){const{file:o}=e;Ot([o])}function Dn(e){}function $e(e,o){e.preventDefault(),!(o&&o.name==="..")&&(pa.value=o,La.value=e.clientX,Ba.value=e.clientY,da.value=!0)}function _t(){da.value=!1,pa.value=null}function zn(e){_t(),pe.openWindow("fileproperties",{title:`${e.display_name||e.name} - Properties`,allowMultiple:!0,data:{file:{name:e.name,display_name:e.display_name,size:e.size,modified:e.modified,is_directory:e.is_directory},location:r.value,path:x.value,container:g.value}})}function $n(e){if(e.button!==0||Ie.value)return;const o=e.target;if(o.closest(".fileexplorer-toolbar, .fileexplorer-sidebar, .fileexplorer-breadcrumbs, .fileexplorer-info-bar")||!(lt.value.length>0||r.value==="systemapps"&&yt.value.length>0||r.value==="utilities"&&gt.value.length>0)||!Ce.value)return;const n=Ce.value.getBoundingClientRect();let c=e.clientX-n.left,m=e.clientY-n.top;const w=n.width-la,D=n.height-sa;c=Math.max(la,Math.min(c,w)),m=Math.max(sa,Math.min(m,D)),Ve.value={x:c,y:m};const E=o.closest("[data-filename]");It.value=!!E,It.value||(Ae.value=!0,Z.value.startX=c,Z.value.startY=m,Z.value.currentX=c,Z.value.currentY=m,!e.ctrlKey&&!e.metaKey&&(V.value=null,A.value.clear())),document.addEventListener("mousemove",vo),document.addEventListener("mouseup",mo)}function vo(e){if(!Ce.value)return;const o=Ce.value.getBoundingClientRect();let a=e.clientX-o.left,n=e.clientY-o.top;const c=o.width-la,m=o.height-sa;a=Math.max(la,Math.min(a,c)),n=Math.max(sa,Math.min(n,m)),!Ae.value&&Ve.value&&Math.sqrt(Math.pow(a-Ve.value.x,2)+Math.pow(n-Ve.value.y,2))>Hr&&(Ae.value=!0,Z.value.startX=Ve.value.x,Z.value.startY=Ve.value.y,V.value=null,A.value.clear(),It.value&&(Dt=!0)),Ae.value&&(Z.value.currentX=a,Z.value.currentY=n,Mn())}function mo(){const e=Math.abs(Z.value.currentX-Z.value.startX)>5||Math.abs(Z.value.currentY-Z.value.startY)>5;!e&&Ae.value&&(V.value=null,A.value.clear()),Ae.value&&e&&(Dt=!0,setTimeout(()=>{Dt=!1},50)),Ae.value=!1,Ve.value=null,It.value=!1,document.removeEventListener("mousemove",vo),document.removeEventListener("mouseup",mo)}function Mn(){const e=Math.min(Z.value.startX,Z.value.currentX),o=Math.min(Z.value.startY,Z.value.currentY),a=Math.abs(Z.value.currentX-Z.value.startX),n=Math.abs(Z.value.currentY-Z.value.startY);A.value.clear();const c=Ce.value,m=c?.getBoundingClientRect();m&&c?.querySelectorAll("[data-filename]").forEach(w=>{const D=w.getAttribute("data-filename");if(!D||D==="..")return;const E=w.getBoundingClientRect(),T=E.left-m.left,q=E.top-m.top,st=E.width,Pe=E.height,Ge=T<e+a&&T+st>e,Zn=q<o+n&&q+Pe>o;Ge&&Zn&&A.value.add(D)})}function En(e){if(e.target.closest(".fileexplorer-file-item, [data-filename]"))return;const n=e.touches[0];n&&(Ra=n.clientX,Za=n.clientY,$t=!1,Se=setTimeout(()=>{navigator.vibrate&&navigator.vibrate(50);const c=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:n.clientX,clientY:n.clientY});$e(c,null),Se=null},Mo))}function Rn(e){if(!Se)return;const o=e.touches[0];if(!o)return;Math.sqrt(Math.pow(o.clientX-Ra,2)+Math.pow(o.clientY-Za,2))>Eo&&($t=!0,Se&&(clearTimeout(Se),Se=null))}function fo(){Se&&(clearTimeout(Se),Se=null),$t||(V.value=null,A.value.clear()),$t=!1}function ye(e,o){const a=o.touches[0];a&&(pt=e,et=!1,zt=!1,$a=a.clientX,Ma=a.clientY,e.name!==".."&&(Oe=setTimeout(()=>{zt=!0,navigator.vibrate&&navigator.vibrate(50);const n=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:a.clientX,clientY:a.clientY});$e(n,e)},Mo)))}function ge(e){const o=e.touches[0];if(!o)return;Math.sqrt(Math.pow(o.clientX-$a,2)+Math.pow(o.clientY-Ma,2))>Eo&&(et=!0,Oe&&(clearTimeout(Oe),Oe=null))}function we(e,o){if(Oe&&(clearTimeout(Oe),Oe=null),zt){zt=!1,et=!1,pt=null;return}if(!et&&pt===e){const a=Date.now(),n=o.changedTouches[0];if(!n){et=!1,pt=null;return}const c=a-ra,m=Math.sqrt(Math.pow(n.clientX-ia,2)+Math.pow(n.clientY-ca,2));c<Pr&&m<Xr?(o.preventDefault(),ue(e),ra=0,ia=0,ca=0):(A.value.clear(),V.value=e.name,ra=a,ia=n.clientX,ca=n.clientY)}et=!1,pt=null}let Yt=null,jt=null;Ln(async()=>{await F.initialize(),L.initialLocation==="appdrive"&&L.initialContainer?(r.value="appdrive",g.value=L.initialContainer,ee.value=!0,await We(),await bt(L.initialContainer,L.initialMountIndex)):L.initialLocation==="dropzone"?(r.value="dropzone",le.value=!0,Y(),We()):L.initialLocation==="storage"?(r.value="storage",ie.value=!0,Y(),We()):(Y(),We()),At.value&&(Yt=new ResizeObserver(e=>{for(const o of e)Pa(o.contentRect.width)}),Yt.observe(At.value),Pa(At.value.clientWidth)),Ce.value&&(jt=new ResizeObserver(e=>{for(const o of e)Te.value=o.contentRect.width}),jt.observe(Ce.value),Te.value=Ce.value.clientWidth),L._windowId&&window.addEventListener(`homedock:open-file-${L._windowId}`,ho)});async function ho(e){const o=e.detail;o?.initialLocation==="appdrive"&&o?.initialContainer&&(r.value="appdrive",g.value=o.initialContainer,x.value="",ee.value=!0,await bt(o.initialContainer,o.initialMountIndex))}Bn(()=>{Yt&&Yt.disconnect(),jt&&jt.disconnect(),L._windowId&&window.removeEventListener(`homedock:open-file-${L._windowId}`,ho)}),Ct(x,()=>{yo(()=>{Lt.value&&(Lt.value.scrollLeft=Lt.value.scrollWidth)})});let Wt=null;return Ct(X,e=>{if(Wt&&(clearTimeout(Wt),Wt=null),!e||e.trim().length<2){Y();return}const o=r.value==="dropzone"||r.value==="storage"||r.value==="appdrive"&&g.value;e.trim().length>=2&&o&&(Wt=setTimeout(()=>{oo(!0)},300))}),Ct(()=>oe.dockerApps.length,async()=>{await We(),r.value==="appdrive"&&g.value&&(_e.value.some(o=>o.name===g.value)||(g.value="",W.value=[],re.value=[]))}),Ct(()=>oe.dockerApps.map(e=>({name:e.name,status:e.status})),e=>{_e.value=_e.value.map(o=>{const a=e.find(n=>n.name===o.name);return a&&a.status!==o.status?{...o,status:a.status}:o})},{deep:!0}),(e,o)=>(u(),d("div",{ref_key:"containerRef",ref:At,class:"app-fileexplorer flex h-full overflow-hidden",onDragenter:_n,onDragleave:Sn,onDragover:o[35]||(o[35]=Xe(()=>{},["prevent"])),onDrop:Xe(Fn,["prevent","stop"])},[p(de,{name:"dragger-fade"},{default:$(()=>[Mt.value&&nt.value?(u(),d("div",wl,[s("div",{class:i([[t(l).scopeSelector,t(l).dropZoneDragHolder],"fullscreen-dragger h-full border-2 border-dashed rounded-lg flex items-center justify-center"])},[s("div",kl,[s("p",bl,[p(t(v),{icon:r.value==="dropzone"?t(Ue):t(Da),class:i([[t(l).dropZoneDragIcon],"text-5xl w-16 h-16"])},null,8,["icon","class"])]),s("p",{class:i([[t(l).dropZoneDragUpText],"px-4 text-balance text-center text-lg font-semibold mt-4"])},h(r.value==="dropzone"?"Drop files to upload and encrypt":"Drop files to upload"),3),s("p",{class:i([[t(l).dropZoneDragDownText],"px-4 text-balance text-center text-sm mt-2"])},"Folders will maintain their structure.",2)])],2)])):y("",!0)]),_:1}),Ie.value?y("",!0):(u(),d("div",{key:0,class:i([[t(l).fileExplorerSidebar],"fileexplorer-sidebar w-52 flex-shrink-0 flex flex-col border-r overflow-hidden"])},[s("div",_l,[s("div",Sl,[s("div",{class:i([[t(l).fileExplorerSidebarSectionTitle],"text-[10px] font-semibold uppercase tracking-wider px-2 mb-1 opacity-60"])},"Locations",2),s("div",Fl,[s("button",{onClick:qa,class:i([[r.value==="storage"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(H),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[36]||(o[36]=s("span",{class:"truncate flex-1"},"Storage",-1)),p(t(v),{icon:ie.value?t(ct):t(qe),class:"w-3 h-3 transition-transform"},null,8,["icon"])],2),s("div",{class:i(["expand-wrapper",!ie.value&&"collapsed"])},[s("div",Cl,[s("div",Tl,[s("button",{onClick:o[0]||(o[0]=a=>ce("storage")),class:i([[r.value==="storage"&&!x.value?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[p(t(v),{icon:t(Jt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[37]||(o[37]=s("span",{class:"truncate"},"All Files",-1))],2),(u(),d(z,null,B(dt,a=>s("button",{key:a,onClick:n=>Ka(a),class:i([[r.value==="storage"&&x.value===a?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[p(t(v),{icon:Nt[a]||t(H),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),s("span",Dl,h(a),1)],10,Il)),64))])])],2)]),s("div",zl,[s("button",{onClick:Qa,class:i([[r.value==="dropzone"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(Ue),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[38]||(o[38]=s("span",{class:"truncate flex-1"},"Drop Zone",-1)),p(t(v),{icon:t(Me),class:"w-3 h-3 opacity-50"},null,8,["icon"]),p(t(v),{icon:le.value?t(ct):t(qe),class:"w-3 h-3 transition-transform"},null,8,["icon"])],2),s("div",{class:i(["expand-wrapper",!le.value&&"collapsed"])},[s("div",$l,[s("div",Ml,[s("button",{onClick:o[1]||(o[1]=a=>ce("dropzone")),class:i([[r.value==="dropzone"&&!x.value?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[p(t(v),{icon:t(Jt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[39]||(o[39]=s("span",{class:"truncate"},"All Files",-1))],2),(u(!0),d(z,null,B(G.value,a=>(u(),d("button",{key:a,onClick:n=>Ja(a),class:i([[r.value==="dropzone"&&x.value===a?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[p(t(v),{icon:t(H),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),s("span",Rl,h(a),1)],10,El))),128))])])],2)]),s("div",Zl,[s("button",{onClick:Ga,class:i([[r.value==="appdrive"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(rt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[40]||(o[40]=s("span",{class:"truncate flex-1"},"App Drive",-1)),p(t(v),{icon:t(ea),class:"w-3 h-3 opacity-50"},null,8,["icon"]),p(t(v),{icon:ee.value?t(ct):t(qe),class:"w-3 h-3 transition-transform"},null,8,["icon"])],2),s("div",{class:i(["expand-wrapper",!ee.value&&"collapsed"])},[s("div",Al,[s("div",Ll,[(u(!0),d(z,null,B(Ht.value,a=>(u(),d("button",{key:a.name,onClick:n=>eo(a.name),class:i([[g.value===a.name&&r.value==="appdrive"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[s("div",Hl,[p(xo,{src:Be(a.name).iconPath,alt:Be(a.name).displayName,class:"w-4 h-4 rounded",draggable:"false"},null,8,["src","alt"]),s("span",{class:i([[a.status==="running"?"bg-green-500":"bg-gray-400"],"absolute -bottom-0.5 -right-0.5 w-1.5 h-1.5 rounded-full ring-1 ring-black/20"])},null,2)]),s("span",Pl,h(Be(a.name).displayName),1)],10,Bl))),128)),Ht.value.length===0&&!Je.value?(u(),d("div",{key:0,class:i([[t(l).fileExplorerSidebarSectionTitle],"text-[10px] px-2 py-1 opacity-60"])},"No apps available",2)):y("",!0)])])],2)])]),s("div",{class:i([[t(l).hrSelector],"my-2"])},null,2),s("div",Xl,[s("div",{class:i([[t(l).fileExplorerSidebarSectionTitle],"text-[10px] font-semibold uppercase tracking-wider px-2 mb-1 opacity-60"])},"System Apps",2),s("button",{onClick:o[2]||(o[2]=a=>ce("systemapps")),class:i([[r.value==="systemapps"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(Kt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[41]||(o[41]=s("span",{class:"truncate"},"Applications",-1)),s("span",{class:i([[t(l).fileExplorerBadge],"text-[9px] px-1.5 rounded-full ml-auto"])},h(ht.value.length),3)],2),s("button",{onClick:o[3]||(o[3]=a=>ce("utilities")),class:i([[r.value==="utilities"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(qt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[42]||(o[42]=s("span",{class:"truncate"},"Utilities",-1)),s("span",{class:i([[t(l).fileExplorerBadge],"text-[9px] px-1.5 rounded-full ml-auto"])},h(xt.value.length),3)],2)]),s("div",{class:i([[t(l).hrSelector],"my-2"])},null,2),s("div",Ul,[s("div",{class:i([[t(l).fileExplorerSidebarSectionTitle],"text-[10px] font-semibold uppercase tracking-wider px-2 mb-1 opacity-60"])},"Quick Access",2),s("button",{onClick:o[4]||(o[4]=a=>ce("favorites")),class:i([[r.value==="favorites"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(St),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[43]||(o[43]=s("span",{class:"truncate"},"Favorites",-1)),t(F).favoritesCount>0?(u(),d("span",{key:0,class:i([[t(l).fileExplorerBadge],"text-[9px] px-1.5 rounded-full ml-auto"])},h(t(F).favoritesCount),3)):y("",!0)],2),s("button",{onClick:o[5]||(o[5]=a=>ce("recents")),class:i([[r.value==="recents"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(Ft),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[44]||(o[44]=s("span",{class:"truncate"},"Recents",-1)),t(F).recentsCount>0?(u(),d("span",{key:0,class:i([[t(l).fileExplorerBadge],"text-[9px] px-1.5 rounded-full ml-auto"])},h(t(F).recentsCount),3)):y("",!0)],2)])])],2)),s("div",Nl,[s("div",{class:i([[t(l).fileExplorerToolbar],"fileexplorer-toolbar flex items-center gap-2 px-3 py-2 border-b flex-shrink-0"])},[Ie.value?(u(),d("div",Vl,[O.value?(u(),d("div",{key:0,class:"fixed inset-0 z-40",onClick:o[6]||(o[6]=a=>O.value=!1)})):y("",!0),s("button",{onClick:o[7]||(o[7]=a=>O.value=!O.value),class:i([[t(l).dropZoneSortButton],"p-1.5 rounded transition-colors relative z-50"]),title:"Navigation"},[s("div",{class:i(["nav-burger-icon",{"nav-burger-open":O.value}])},[p(t(v),{icon:t(hl),class:"nav-burger-menu w-4 h-4"},null,8,["icon"]),p(t(v),{icon:t(bo),class:"nav-burger-close w-4 h-4"},null,8,["icon"])],2)],2),p(de,{name:"popover-fade"},{default:$(()=>[O.value?(u(),d("div",{key:0,class:i(["nav-popover absolute top-full left-0 mt-1 z-50 w-56 max-h-[70vh] overflow-y-auto rounded-lg shadow-xl border",[t(l).contextMenuBg,t(l).contextMenuBorder]])},[s("div",Ol,[s("div",{class:i([[t(l).fileExplorerSidebarSectionTitle],"text-[10px] font-semibold uppercase tracking-wider px-2 mb-1 opacity-60"])},"Locations",2),s("div",Yl,[s("button",{onClick:qa,class:i([[r.value==="storage"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(H),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[45]||(o[45]=s("span",{class:"truncate flex-1"},"Storage",-1)),p(t(v),{icon:ie.value?t(ct):t(qe),class:"w-3 h-3 transition-transform"},null,8,["icon"])],2),s("div",{class:i(["expand-wrapper",!ie.value&&"collapsed"])},[s("div",jl,[s("div",Wl,[s("button",{onClick:o[8]||(o[8]=a=>{ce("storage"),O.value=!1}),class:i([[r.value==="storage"&&!x.value?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[p(t(v),{icon:t(Jt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[46]||(o[46]=s("span",{class:"truncate"},"All Files",-1))],2),(u(),d(z,null,B(dt,a=>s("button",{key:a,onClick:n=>{Ka(a),O.value=!1},class:i([[r.value==="storage"&&x.value===a?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[p(t(v),{icon:Nt[a]||t(H),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),s("span",ql,h(a),1)],10,Gl)),64))])])],2)]),s("div",Kl,[s("button",{onClick:Qa,class:i([[r.value==="dropzone"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(Ue),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[47]||(o[47]=s("span",{class:"truncate flex-1"},"Drop Zone",-1)),p(t(v),{icon:t(Me),class:"w-3 h-3 opacity-50"},null,8,["icon"]),p(t(v),{icon:le.value?t(ct):t(qe),class:"w-3 h-3 transition-transform"},null,8,["icon"])],2),s("div",{class:i(["expand-wrapper",!le.value&&"collapsed"])},[s("div",Ql,[s("div",Jl,[s("button",{onClick:o[9]||(o[9]=a=>{ce("dropzone"),O.value=!1}),class:i([[r.value==="dropzone"&&!x.value?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[p(t(v),{icon:t(Jt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[48]||(o[48]=s("span",{class:"truncate"},"All Files",-1))],2),(u(!0),d(z,null,B(G.value,a=>(u(),d("button",{key:a,onClick:n=>{Ja(a),O.value=!1},class:i([[r.value==="dropzone"&&x.value===a?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[p(t(v),{icon:t(H),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),s("span",ts,h(a),1)],10,es))),128))])])],2)]),s("div",as,[s("button",{onClick:Ga,class:i([[r.value==="appdrive"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(rt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[49]||(o[49]=s("span",{class:"truncate flex-1"},"App Drive",-1)),p(t(v),{icon:t(ea),class:"w-3 h-3 opacity-50"},null,8,["icon"]),p(t(v),{icon:ee.value?t(ct):t(qe),class:"w-3 h-3 transition-transform"},null,8,["icon"])],2),s("div",{class:i(["expand-wrapper",!ee.value&&"collapsed"])},[s("div",os,[s("div",ns,[(u(!0),d(z,null,B(Ht.value,a=>(u(),d("button",{key:a.name,onClick:n=>{eo(a.name),O.value=!1},class:i([[g.value===a.name&&r.value==="appdrive"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2 px-2 py-1 rounded text-left transition-colors text-xs"])},[s("div",ss,[p(xo,{src:Be(a.name).iconPath,alt:Be(a.name).displayName,class:"w-4 h-4 rounded",draggable:"false"},null,8,["src","alt"]),s("span",{class:i([[a.status==="running"?"bg-green-500":"bg-gray-400"],"absolute -bottom-0.5 -right-0.5 w-1.5 h-1.5 rounded-full ring-1 ring-black/20"])},null,2)]),s("span",rs,h(Be(a.name).displayName),1)],10,ls))),128)),Ht.value.length===0&&!Je.value?(u(),d("div",{key:0,class:i([[t(l).fileExplorerSidebarSectionTitle],"text-[10px] px-2 py-1 opacity-60"])},"No apps available",2)):y("",!0)])])],2)]),s("div",{class:i([[t(l).hrSelector],"my-2"])},null,2),s("div",is,[s("div",{class:i([[t(l).fileExplorerSidebarSectionTitle],"text-[10px] font-semibold uppercase tracking-wider px-2 mb-1 opacity-60"])},"System Apps",2),s("button",{onClick:o[10]||(o[10]=a=>{ce("systemapps"),O.value=!1}),class:i([[r.value==="systemapps"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(Kt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[50]||(o[50]=s("span",{class:"truncate"},"Applications",-1)),s("span",{class:i([[t(l).fileExplorerBadge],"text-[9px] px-1.5 rounded-full ml-auto"])},h(ht.value.length),3)],2),s("button",{onClick:o[11]||(o[11]=a=>{ce("utilities"),O.value=!1}),class:i([[r.value==="utilities"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(qt),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[51]||(o[51]=s("span",{class:"truncate"},"Utilities",-1)),s("span",{class:i([[t(l).fileExplorerBadge],"text-[9px] px-1.5 rounded-full ml-auto"])},h(xt.value.length),3)],2)]),s("div",{class:i([[t(l).hrSelector],"my-2"])},null,2),s("div",cs,[s("div",{class:i([[t(l).fileExplorerSidebarSectionTitle],"text-[10px] font-semibold uppercase tracking-wider px-2 mb-1 opacity-60"])},"Quick Access",2),s("button",{onClick:o[12]||(o[12]=a=>{ce("favorites"),O.value=!1}),class:i([[r.value==="favorites"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(St),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[52]||(o[52]=s("span",{class:"truncate"},"Favorites",-1)),t(F).favoritesCount>0?(u(),d("span",{key:0,class:i([[t(l).fileExplorerBadge],"text-[9px] px-1.5 rounded-full ml-auto"])},h(t(F).favoritesCount),3)):y("",!0)],2),s("button",{onClick:o[13]||(o[13]=a=>{ce("recents"),O.value=!1}),class:i([[r.value==="recents"?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:t(Ft),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),o[53]||(o[53]=s("span",{class:"truncate"},"Recents",-1)),t(F).recentsCount>0?(u(),d("span",{key:0,class:i([[t(l).fileExplorerBadge],"text-[9px] px-1.5 rounded-full ml-auto"])},h(t(F).recentsCount),3)):y("",!0)],2)])])],2)):y("",!0)]),_:1})])):y("",!0),p(de,{name:"mobile-search-icon"},{default:$(()=>[!De.value&&(r.value==="storage"||r.value==="dropzone"||r.value==="appdrive"&&g.value)?(u(),d("button",{key:0,onClick:o[14]||(o[14]=a=>De.value=!0),class:i([[t(l).dropZoneSortButton],"h-7 w-7 rounded transition-colors flex items-center justify-center flex-shrink-0"]),title:"Search"},[p(t(v),{icon:t(Jn),class:"w-4 h-4"},null,8,["icon"])],2)):y("",!0)]),_:1}),p(de,{name:"mobile-search-expand",onAfterEnter:cn},{default:$(()=>[De.value?(u(),d("div",us,[p(t(ol),{value:X.value,"onUpdate:value":o[17]||(o[17]=a=>X.value=a),options:Qo.value,"popup-class-name":`${t(l).scopeSelector}`,class:"flex-1 min-w-0",onSelect:fn},{option:$(({label:a,isDirectory:n})=>[s("div",ds,[p(t(v),{icon:n?t(H):t(_o),class:i([[t(l).dropZoneFileIcon],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"]),s("span",ps,h(a),1)])]),default:$(()=>[p(t(al),{ref_key:"searchInputRef",ref:Ha,value:X.value,"onUpdate:value":o[15]||(o[15]=a=>X.value=a),placeholder:"Search...",class:"w-full text-sm [&_.ant-input-affix-wrapper]:!h-7 [&_.ant-input-affix-wrapper]:!py-0 [&_.ant-input-search-button]:!h-7 [&_.ant-input-search-button]:!flex [&_.ant-input-search-button]:!items-center [&_.ant-input-search-button]:!justify-center",size:"small","enter-button":"",onSearch:o[16]||(o[16]=()=>oo())},{prefix:$(()=>[ut.value?(u(),P(t(v),{key:0,icon:t(ne),class:i([[t(l).dropZoneInputIcon,"animate-spin"],"mx-1"])},null,8,["icon","class"])):(u(),P(t(v),{key:1,icon:r.value==="dropzone"?t(Ue):r.value==="appdrive"?t(rt):t(H),class:i([[t(l).dropZoneInputIcon],"mx-1"])},null,8,["icon","class"]))]),_:1},8,["value"])]),_:1},8,["value","options","popup-class-name"]),s("button",{onClick:o[18]||(o[18]=a=>{De.value=!1,X.value=""}),class:i([[t(l).dropZoneSortButton],"h-7 w-7 rounded transition-colors flex items-center justify-center flex-shrink-0"]),title:"Cancel"},[p(t(v),{icon:t(bo),class:"w-4 h-4"},null,8,["icon"])],2)])):y("",!0)]),_:1}),p(de,{name:"mobile-controls-fade"},{default:$(()=>[r.value==="appdrive"&&W.value.length>1&&!De.value&&!Ie.value?(u(),P(t(To),{key:0,value:I.value,"onUpdate:value":o[19]||(o[19]=a=>I.value=a),class:i([[t(l).scopeSelector,t(l).dropZoneSortSelect],"min-w-[180px] rounded text-xs flex-shrink-0 [&_.ant-select-selector]:!min-h-0 [&_.ant-select-selector]:!h-7 [&_.ant-select-selector]:!py-0 [&_.ant-select-selector]:!flex [&_.ant-select-selector]:!items-center [&_.ant-select-selection-item]:!flex [&_.ant-select-selection-item]:!items-center"]),"popup-class-name":`${t(l).scopeSelector}`,"show-search":!1,onChange:ao,size:"small"},{suffixIcon:$(()=>[p(t(v),{icon:t(ea),class:"w-3 h-3"},null,8,["icon"])]),default:$(()=>[(u(!0),d(z,null,B(W.value,(a,n)=>(u(),P(t(oa),{key:n,value:n},{default:$(()=>[s("div",vs,[p(t(v),{icon:a.read_only?t(Me):t(H),class:"w-3 h-3 flex-shrink-0"},null,8,["icon"]),s("span",ms,h(a.container_path),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value","class","popup-class-name"])):y("",!0)]),_:1}),Ie.value&&r.value==="appdrive"&&W.value.length>1&&!De.value?(u(),d("div",fs,[ot.value?(u(),d("div",{key:0,class:"fixed inset-0 z-40",onClick:o[20]||(o[20]=a=>ot.value=!1)})):y("",!0),s("button",{onClick:o[21]||(o[21]=a=>ot.value=!ot.value),class:i([[t(l).dropZoneSortButton],"h-7 w-7 rounded transition-colors flex items-center justify-center relative z-50"]),title:W.value[I.value]?.container_path||"Select Volume"},[p(t(v),{icon:t(ea),class:"w-4 h-4"},null,8,["icon"])],10,hs),p(de,{name:"popover-fade"},{default:$(()=>[ot.value?(u(),d("div",{key:0,class:i(["absolute top-full left-0 mt-1 z-50 w-56 max-h-[50vh] overflow-y-auto rounded-lg shadow-xl border",[t(l).contextMenuBg,t(l).contextMenuBorder]])},[s("div",xs,[s("div",{class:i([[t(l).fileExplorerSidebarSectionTitle],"text-[10px] font-semibold uppercase tracking-wider px-2 mb-1 opacity-60"])},"Volumes",2),(u(!0),d(z,null,B(W.value,(a,n)=>(u(),d("button",{key:n,onClick:c=>{I.value=n,ao(),ot.value=!1},class:i([[I.value===n?t(l).fileExplorerSidebarItemActive:t(l).fileExplorerSidebarItem],"w-full flex items-center gap-2.5 px-2 py-1.5 rounded-md text-left transition-colors text-sm"])},[p(t(v),{icon:a.read_only?t(Me):t(H),class:"w-4 h-4 flex-shrink-0"},null,8,["icon"]),s("span",gs,h(a.container_path),1),I.value===n?(u(),P(t(v),{key:0,icon:t(ko),class:"w-3 h-3 flex-shrink-0 opacity-70"},null,8,["icon"])):y("",!0)],10,ys))),128))])],2)):y("",!0)]),_:1})])):y("",!0),De.value?y("",!0):(u(),d("div",ws)),p(de,{name:"mobile-controls-fade"},{default:$(()=>[De.value?y("",!0):(u(),d("div",ks,[r.value!=="systemapps"&&r.value!=="utilities"?(u(),d(z,{key:0},[p(t(To),{value:t(Re),"onUpdate:value":o[22]||(o[22]=a=>Hn(Re)?Re.value=a:null),class:i([[t(l).scopeSelector,t(l).dropZoneSortSelect],"w-24 rounded text-xs [&_.ant-select-selector]:!min-h-0 [&_.ant-select-selector]:!h-7 [&_.ant-select-selector]:!py-0 [&_.ant-select-selector]:!leading-7 [&_.ant-select-selection-item]:!leading-7"]),"popup-class-name":`${t(l).scopeSelector}`,"show-search":!1,size:"small"},{default:$(()=>[p(t(oa),{value:"name"},{default:$(()=>[...o[54]||(o[54]=[K("Name",-1)])]),_:1}),p(t(oa),{value:"size"},{default:$(()=>[...o[55]||(o[55]=[K("Size",-1)])]),_:1}),p(t(oa),{value:"date"},{default:$(()=>[...o[56]||(o[56]=[K("Date",-1)])]),_:1})]),_:1},8,["value","class","popup-class-name"]),s("button",{onClick:sn,class:i([[t(l).dropZoneSortButton],"h-7 w-7 rounded transition-colors flex items-center justify-center"]),title:t(ke)==="asc"?"Ascending":"Descending"},[p(t(v),{icon:t(ke)==="asc"?t(pl):t(vl),class:"w-4 h-4"},null,8,["icon"])],10,bs)],64)):y("",!0),s("button",{onClick:rn,class:i([[t(l).dropZoneSortButton],"h-7 w-7 rounded transition-colors flex items-center justify-center"]),title:t(Ze)==="grid"?"List View":"Grid View"},[p(t(v),{icon:t(Ze)==="grid"?t(fl):t(ml),class:"w-4 h-4"},null,8,["icon"])],10,_s),r.value!=="systemapps"&&r.value!=="utilities"?(u(),d("button",{key:1,onClick:He,class:i([[t(l).dropZoneSortButton],"h-7 w-7 rounded transition-colors flex items-center justify-center"]),title:"Refresh"},[p(t(v),{icon:t(Ca),class:i([{"animate-spin":be.value},"w-4 h-4"])},null,8,["icon","class"])],2)):y("",!0)]))]),_:1})],2),No.value?(u(),d("div",{key:0,ref_key:"breadcrumbsRef",ref:Lt,class:i([[t(l).fileExplorerBreadcrumbs],"flex items-center gap-1 px-3 py-1.5 text-[11px] border-b flex-shrink-0 overflow-x-scroll [scrollbar-width:none] [-webkit-overflow-scrolling:touch] [-ms-overflow-style:none] [&::-webkit-scrollbar]:hidden"])},[s("button",{onClick:pn,class:i([[t(l).dropZoneSortButton],"px-1.5 py-0.5 rounded hover:opacity-80 transition-opacity flex items-center gap-1 flex-shrink-0"])},[p(t(v),{icon:Oo.value,class:"w-3 h-3"},null,8,["icon"]),s("span",null,h(Vo.value),1)],2),(u(!0),d(z,null,B(ha.value,(a,n)=>(u(),d(z,{key:n},[p(t(v),{icon:t(qe),class:i([[t(l).dropZoneFileIcon],"w-3 h-3 opacity-50 flex-shrink-0"])},null,8,["icon","class"]),s("button",{onClick:c=>vn(n),class:i([[t(l).dropZoneSortButton],"px-1.5 py-0.5 rounded hover:opacity-80 transition-opacity truncate max-w-[120px] flex-shrink-0"])},h(a),11,Ss)],64))),128))],2)):y("",!0),s("div",{class:i([[t(l).fileExplorerInfoBar],"flex items-center gap-2 px-3 py-1 text-[10px] border-b flex-shrink-0"])},[s("span",{class:i([[t(l).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5"])},[r.value==="systemapps"?(u(),d(z,{key:0},[K(h(yt.value.length)+" "+h(yt.value.length===1?"app":"apps"),1)],64)):r.value==="utilities"?(u(),d(z,{key:1},[K(h(gt.value.length)+" "+h(gt.value.length===1?"utility":"utilities"),1)],64)):(u(),d(z,{key:2},[K(h(ze.value.length)+" "+h(ze.value.length===1?"item":"items")+" ",1),kt.value?(u(),d("span",Fs,"(global search)")):y("",!0)],64))],2),Ya.value!=="0 B"&&ze.value.length>0&&!J.value&&r.value!=="systemapps"&&r.value!=="utilities"?(u(),d("span",{key:0,class:i([[t(l).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5"])},h(Ya.value)+" total ",3)):y("",!0),wt.value?(u(),d("span",{key:1,class:i([[t(l).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5 flex items-center gap-1"])},[p(t(v),{icon:t(Me),class:"w-3 h-3"},null,8,["icon"]),o[57]||(o[57]=K(" Read-only ",-1))],2)):y("",!0),r.value==="dropzone"?(u(),d("span",{key:2,class:i([[t(l).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5 flex items-center gap-1"])},[p(t(v),{icon:t(Kn),class:"w-3 h-3"},null,8,["icon"]),o[58]||(o[58]=K(" Encrypted ",-1))],2)):y("",!0)],2),s("div",{ref_key:"filesAreaRef",ref:Ce,class:"flex-1 min-h-0 overflow-y-auto overflow-x-hidden px-3 py-2 relative",onMousedown:$n,onContextmenu:o[23]||(o[23]=a=>$e(a,null)),onTouchstart:En,onTouchmove:Rn,onTouchend:fo,onTouchcancel:fo},[p(Wn,{visible:Ae.value,style:ae(nn.value)},null,8,["visible","style"]),p(de,{name:"location-fade",mode:"out-in"},{default:$(()=>[(u(),d("div",{key:`${r.value}-${g.value||""}-${x.value}`},[be.value?(u(),d("div",Cs,[p(t(v),{icon:t(ne),class:i([[t(l).dropZoneFileIcon],"w-12 h-12 animate-spin mb-4"])},null,8,["icon","class"]),s("p",{class:i([[t(l).dropZoneEmptyText],"text-sm"])},"Loading...",2)])):lt.value.length===0&&r.value!=="systemapps"&&r.value!=="utilities"?(u(),d("div",Ts,[p(t(v),{icon:Yo.value,class:i([[t(l).dropZoneFileIcon],"w-16 h-16 opacity-30 mb-4"])},null,8,["icon","class"]),s("p",{class:i([[t(l).dropZoneEmptyText],"text-sm"])},h(jo.value),3)])):(u(),P(de,{key:2,name:t(Ze)==="grid"?"view-mode-fade":"list-view-fade",mode:"out-in"},{default:$(()=>[t(Ze)==="grid"?(u(),d("div",{key:"grid-view",class:"w-full select-none",style:ae({minHeight:`${Oa.value}px`})},[r.value==="systemapps"?(u(),d("div",{key:0,class:"fileexplorer-grid",style:ae({height:`${qo.value}px`})},[(u(!0),d(z,null,B(Wo.value,a=>(u(),d("div",{key:a.name,"data-filename":a.name,style:ae({position:"absolute",left:`${a.x}px`,top:`${a.y}px`}),class:i(["inline-flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg border","transition-[background,transform,border] duration-150","w-[100px] h-[120px] select-none",te(a)?[t(l).desktopIconBgSelected,t(l).desktopIconBorderSelected]:["border-transparent",t(l).desktopIconBg]]),onClick:n=>xe(a,n),onDblclick:n=>ue(a),onTouchstart:n=>ye(a,n),onTouchmove:ge,onTouchend:n=>we(a,n)},[s("div",{class:i(["relative w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl",t(l).desktopIconContainerBg,te(a)&&t(l).desktopIconContainerBgSelected])},[p(t(v),{icon:fe(a),class:i([[t(l).dropZoneFileIcon],"h-10 w-10"])},null,8,["icon","class"])],2),s("span",{class:i([[t(l).dropZoneFileText],"text-[11px] leading-tight text-center line-clamp-2 w-full px-1 break-words"]),title:a.display_name},h(a.display_name),11,Ds)],46,Is))),128))],4)):r.value==="utilities"?(u(),d("div",{key:1,class:"fileexplorer-grid",style:ae({height:`${Ko.value}px`})},[(u(!0),d(z,null,B(Go.value,a=>(u(),d("div",{key:a.name,"data-filename":a.name,style:ae({position:"absolute",left:`${a.x}px`,top:`${a.y}px`}),class:i(["inline-flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg border","transition-[background,transform,border] duration-150","w-[100px] h-[120px] select-none",te(a)?[t(l).desktopIconBgSelected,t(l).desktopIconBorderSelected]:["border-transparent",t(l).desktopIconBg]]),onClick:n=>xe(a,n),onDblclick:n=>ue(a),onTouchstart:n=>ye(a,n),onTouchmove:ge,onTouchend:n=>we(a,n)},[s("div",{class:i(["relative w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl",t(l).desktopIconContainerBg,te(a)&&t(l).desktopIconContainerBgSelected])},[p(t(v),{icon:fe(a),class:i([[t(l).dropZoneFileIcon],"h-10 w-10"])},null,8,["icon","class"])],2),s("span",{class:i([[t(l).dropZoneFileText],"text-[11px] leading-tight text-center line-clamp-2 w-full px-1 break-words"]),title:a.display_name},h(a.display_name),11,$s)],46,zs))),128))],4)):J.value&&xa.value.length>0?(u(!0),d(z,{key:2},B(xa.value,a=>(u(),d("div",{key:a.key,class:"mb-4"},[s("div",{class:i([[t(l).fileExplorerSidebarSectionTitle],"flex items-center gap-2 px-1 py-1.5 mb-2 text-xs font-semibold opacity-80"])},[p(t(v),{icon:a.icon,class:"w-4 h-4"},null,8,["icon"]),s("span",null,h(a.label),1),s("span",Ms,"("+h(a.files.length)+")",1)],2),s("div",{class:"fileexplorer-grid",style:ae({height:`${a.gridHeight}px`})},[(u(!0),d(z,null,B(a.positionedFiles,n=>(u(),d("div",{key:`${a.key}-${n.name}`,"data-filename":n.name,style:ae({position:"absolute",left:`${n.x}px`,top:`${n.y}px`}),class:i(["inline-flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg border","transition-[background,transform,border] duration-150","w-[100px] h-[120px] select-none",te(n)?[t(l).desktopIconBgSelected,t(l).desktopIconBorderSelected]:["border-transparent",t(l).desktopIconBg]]),onClick:c=>xe(n,c),onDblclick:c=>ue(n),onContextmenu:Xe(c=>$e(c,n),["stop"]),onTouchstart:c=>ye(n,c),onTouchmove:ge,onTouchend:c=>we(n,c)},[s("div",{class:i(["relative w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl",t(l).desktopIconContainerBg,te(n)&&t(l).desktopIconContainerBgSelected])},[p(t(v),{icon:fe(n),class:i([[t(l).dropZoneFileIcon],"h-10 w-10"])},null,8,["icon","class"])],2),s("span",{class:i([[t(l).dropZoneFileText],"text-[11px] leading-tight text-center line-clamp-2 w-full px-1 break-words"]),title:n.display_name||n.name},h(Vt(n)),11,Rs)],46,Es))),128))],4)]))),128)):kt.value?(u(!0),d(z,{key:3},B(Va.value,a=>(u(),d("div",{key:a.folder,class:"mb-4"},[s("div",{class:i([[t(l).dropZoneTotalSizeScope],"flex items-center gap-2 px-2 py-1.5 mb-2 rounded-md sticky top-0 z-30"])},[p(t(v),{icon:t(H),class:i([[t(l).dropZoneFileIcon],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"]),s("span",Zs,h(a.folder===""?"Root":a.folder),1),s("span",As,h(a.files.length)+" "+h(a.files.length===1?"item":"items"),1)],2),s("div",{class:"fileexplorer-grid",style:ae({height:`${a.gridHeight}px`})},[p(Gt,{name:"file-item"},{default:$(()=>[(u(!0),d(z,null,B(a.positionedFiles,n=>(u(),d("div",{key:n.name,"data-filename":n.name,style:ae({position:"absolute",left:`${n.x}px`,top:`${n.y}px`}),class:i(["inline-flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg border","transition-[background,transform,border] duration-150","w-[100px] h-[120px] select-none",te(n)?[t(l).desktopIconBgSelected,t(l).desktopIconBorderSelected]:["border-transparent",t(l).desktopIconBg]]),onClick:c=>xe(n,c),onDblclick:c=>ue(n),onContextmenu:Xe(c=>$e(c,n),["stop"]),onTouchstart:c=>ye(n,c),onTouchmove:ge,onTouchend:c=>we(n,c)},[s("div",{class:i(["relative w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl",t(l).desktopIconContainerBg,te(n)&&t(l).desktopIconContainerBgSelected])},[!n.is_directory&&n.size>0?(u(),d("div",{key:0,class:i([[t(l).dropZoneFileSize],"absolute -left-1 -top-1 text-[8px] font-medium px-1 py-0.5 rounded whitespace-nowrap z-10"])},h(Wa(n.size)),3)):y("",!0),he(n)?(u(),d("div",Bs,[s("div",{class:i([[t(l).dropZoneFileSize],"text-[8px] font-medium px-1 py-0.5 rounded whitespace-nowrap"])},h(he(n)),3)])):y("",!0),r.value==="dropzone"&&!n.is_directory?(u(),d("div",Hs,[N.value[n.name]?(u(),P(t(v),{key:0,icon:t(ne),class:i([[t(l).dropZoneLockIcon],"animate-spin h-3 w-3"])},null,8,["icon","class"])):(u(),P(t(v),{key:1,icon:U.value[n.name]?t(aa):t(Me),class:i([[t(l).dropZoneLockIcon],"h-3 w-3"])},null,8,["icon","class"]))])):y("",!0),Q.value.has(n.name)?(u(),d("div",Ps,[p(t(v),{icon:t(Ee),class:i([[t(l).dropZoneLockIcon],"h-4 w-4"])},null,8,["icon","class"])])):y("",!0),p(t(v),{icon:fe(n),class:i([[t(l).dropZoneFileIcon,Q.value.has(n.name)?"opacity-40":""],"h-10 w-10 transition duration-300 group-hover:scale-110"])},null,8,["icon","class"]),Q.value.has(n.name)?(u(),d("div",Xs,[p(t(v),{icon:t(ne),class:i([[t(l).dropZoneLockIcon],"h-7 w-7 animate-spin"])},null,8,["icon","class"])])):y("",!0)],2),s("span",{class:i([[t(l).dropZoneFileText],"text-[11px] leading-tight text-center line-clamp-2 w-full px-1 break-words"]),title:n.display_name||n.name},h(n.name.split("/").pop()),11,Us),k.value[n.name]!==void 0&&k.value[n.name]<100?(u(),d("div",Ns,[p(t(na),{percent:k.value[n.name],class:i([[t(l).scopeSelector],"h-1 rounded-full"]),"show-info":!1,size:2,status:"active"},null,8,["percent","class"])])):y("",!0)],46,Ls))),128))]),_:2},1024)],4)]))),128)):(u(),d("div",{key:4,class:"fileexplorer-grid",style:ae({height:`${Oa.value}px`})},[p(Gt,{name:"file-item"},{default:$(()=>[(u(!0),d(z,null,B(ya.value,a=>(u(),d("div",{key:a.name,"data-filename":a.name,style:ae({position:"absolute",left:`${a.x}px`,top:`${a.y}px`}),class:i(["inline-flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg border","transition-[background,border] duration-150","w-[100px] h-[120px] select-none",te(a)?[t(l).desktopIconBgSelected,t(l).desktopIconBorderSelected]:["border-transparent",t(l).desktopIconBg]]),onClick:n=>xe(a,n),onDblclick:n=>ue(a),onContextmenu:Xe(n=>$e(n,a),["stop"]),onTouchstart:n=>ye(a,n),onTouchmove:ge,onTouchend:n=>we(a,n)},[s("div",{class:i(["relative w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl",t(l).desktopIconContainerBg,te(a)&&t(l).desktopIconContainerBgSelected])},[!a.is_directory&&a.size>0?(u(),d("div",{key:0,class:i([[t(l).dropZoneFileSize],"absolute -left-1 -top-1 text-[8px] font-medium px-1 py-0.5 rounded whitespace-nowrap z-10"])},h(Wa(a.size)),3)):y("",!0),he(a)?(u(),d("div",Os,[s("div",{class:i([[t(l).dropZoneFileSize],"text-[8px] font-medium px-1 py-0.5 rounded whitespace-nowrap"])},h(he(a)),3)])):y("",!0),r.value==="dropzone"&&!a.is_directory?(u(),d("div",Ys,[N.value[a.name]?(u(),P(t(v),{key:0,icon:t(ne),class:i([[t(l).dropZoneLockIcon],"animate-spin h-3 w-3"])},null,8,["icon","class"])):(u(),P(t(v),{key:1,icon:U.value[a.name]?t(aa):t(Me),class:i([[t(l).dropZoneLockIcon],"h-3 w-3"])},null,8,["icon","class"]))])):y("",!0),Q.value.has(a.name)?(u(),d("div",js,[p(t(v),{icon:t(Ee),class:i([[t(l).dropZoneLockIcon],"h-4 w-4"])},null,8,["icon","class"])])):y("",!0),p(t(v),{icon:fe(a),class:i([[t(l).dropZoneFileIcon,Q.value.has(a.name)?"opacity-40":""],"h-10 w-10 transition duration-300 group-hover:scale-110"])},null,8,["icon","class"]),Q.value.has(a.name)?(u(),d("div",Ws,[p(t(v),{icon:t(ne),class:i([[t(l).dropZoneLockIcon],"h-7 w-7 animate-spin"])},null,8,["icon","class"])])):y("",!0)],2),s("span",{class:i([[t(l).dropZoneFileText],"text-[11px] leading-tight text-center line-clamp-2 w-full px-1 break-words"]),title:a.display_name||a.name},h(Vt(a)),11,Gs),k.value[a.name]!==void 0&&k.value[a.name]<100?(u(),d("div",qs,[p(t(na),{percent:k.value[a.name],class:i([[t(l).scopeSelector],"h-1 rounded-full"]),"show-info":!1,size:2,status:"active"},null,8,["percent","class"])])):y("",!0)],46,Vs))),128))]),_:1})],4))],4)):(u(),d("div",{key:`list-view-${x.value}`,class:"fileexplorer-list w-full select-none"},[r.value==="systemapps"?(u(!0),d(z,{key:0},B(yt.value,a=>(u(),d("div",{key:a.name,"data-filename":a.name,class:i(["group relative flex items-center gap-3 cursor-pointer px-2 py-1.5 rounded transition-colors overflow-hidden",te(a)?t(l).desktopIconBgSelected:t(l).desktopIconBg]),onClick:n=>xe(a,n),onDblclick:n=>ue(a),onTouchstart:n=>ye(a,n),onTouchmove:ge,onTouchend:n=>we(a,n)},[s("div",Qs,[p(t(v),{icon:fe(a),class:i([[t(l).dropZoneFileIcon],"h-5 w-5"])},null,8,["icon","class"])]),s("div",Js,[s("span",{class:i([[t(l).dropZoneFileText],"text-xs truncate block"]),title:a._appDescription},h(a.display_name),11,er)]),s("div",{class:i([[t(l).dropZoneFileSize],"text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},"App",2)],42,Ks))),128)):r.value==="utilities"?(u(!0),d(z,{key:1},B(gt.value,a=>(u(),d("div",{key:a.name,"data-filename":a.name,class:i(["group relative flex items-center gap-3 cursor-pointer px-2 py-1.5 rounded transition-colors overflow-hidden",te(a)?t(l).desktopIconBgSelected:t(l).desktopIconBg]),onClick:n=>xe(a,n),onDblclick:n=>ue(a),onTouchstart:n=>ye(a,n),onTouchmove:ge,onTouchend:n=>we(a,n)},[s("div",ar,[p(t(v),{icon:fe(a),class:i([[t(l).dropZoneFileIcon],"h-5 w-5"])},null,8,["icon","class"])]),s("div",or,[s("span",{class:i([[t(l).dropZoneFileText],"text-xs truncate block"]),title:a._appDescription},h(a.display_name),11,nr)]),s("div",{class:i([[t(l).dropZoneFileSize],"text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},"Utility",2)],42,tr))),128)):J.value?(u(!0),d(z,{key:2},B(xa.value,a=>(u(),d("div",{key:a.key,class:"mb-4"},[s("div",{class:i([[t(l).fileExplorerSidebarSectionTitle],"flex items-center gap-2 px-1 py-1.5 mb-2 text-xs font-semibold opacity-80"])},[p(t(v),{icon:a.icon,class:"w-4 h-4"},null,8,["icon"]),s("span",null,h(a.label),1),s("span",lr,"("+h(a.files.length)+")",1)],2),(u(!0),d(z,null,B(a.files,n=>(u(),d("div",{key:`${a.key}-${n.name}`,"data-filename":n.name,class:i(["group relative flex items-center gap-3 cursor-pointer px-2 py-1.5 rounded transition-colors overflow-hidden",te(n)?t(l).desktopIconBgSelected:t(l).desktopIconBg]),onClick:c=>xe(n,c),onDblclick:c=>ue(n),onContextmenu:Xe(c=>$e(c,n),["stop"]),onTouchstart:c=>ye(n,c),onTouchmove:ge,onTouchend:c=>we(n,c)},[k.value[n.name]!==void 0&&k.value[n.name]<100?(u(),d("div",{key:0,class:"absolute inset-0 bg-blue-500/20 transition-all duration-300 ease-out",style:ae({width:`${k.value[n.name]}%`})},null,4)):y("",!0),s("div",rr,[p(t(v),{icon:fe(n),class:i([[t(l).dropZoneFileIcon,Q.value.has(n.name)?"opacity-40":""],"h-5 w-5"])},null,8,["icon","class"]),Q.value.has(n.name)?(u(),d("div",ir,[p(t(v),{icon:t(ne),class:i([[t(l).dropZoneLockIcon],"h-4 w-4 animate-spin"])},null,8,["icon","class"])])):y("",!0)]),s("div",cr,[s("span",{class:i([[t(l).dropZoneFileText],"text-xs truncate block"]),title:n.display_name||n.name},h(Vt(n)),11,ur)]),he(n)?(u(),d("div",{key:1,class:i([[t(l).dropZoneFileSize],"text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},h(he(n)),3)):y("",!0)],42,sr))),128))]))),128)):kt.value?(u(!0),d(z,{key:3},B(Va.value,a=>(u(),d(z,{key:a.folder},[s("div",{class:i([[t(l).dropZoneTotalSizeScope],"flex items-center gap-2 px-2 py-1.5 mt-2 mb-1 rounded-md sticky top-0 z-30"])},[p(t(v),{icon:t(H),class:i([[t(l).dropZoneFileIcon],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"]),s("span",dr,h(a.folder===""?"Root":a.folder),1),s("span",pr,h(a.files.length)+" "+h(a.files.length===1?"item":"items"),1)],2),p(Gt,{name:"file-item-list"},{default:$(()=>[(u(!0),d(z,null,B(a.files,n=>(u(),d("div",{key:n.name,"data-filename":n.name,class:i(["group relative flex items-center gap-3 cursor-pointer px-2 py-1.5 rounded transition-colors overflow-hidden ml-4",te(n)?t(l).desktopIconBgSelected:t(l).desktopIconBg]),onClick:c=>xe(n,c),onDblclick:c=>ue(n),onContextmenu:Xe(c=>$e(c,n),["stop"]),onTouchstart:c=>ye(n,c),onTouchmove:ge,onTouchend:c=>we(n,c)},[k.value[n.name]!==void 0&&k.value[n.name]<100?(u(),d("div",{key:0,class:"absolute inset-0 bg-blue-500/20 transition-all duration-300 ease-out",style:ae({width:`${k.value[n.name]}%`})},null,4)):y("",!0),s("div",mr,[p(t(v),{icon:fe(n),class:i([[t(l).dropZoneFileIcon,Q.value.has(n.name)?"opacity-40":""],"h-5 w-5"])},null,8,["icon","class"]),r.value==="dropzone"&&!n.is_directory?(u(),d("div",fr,[N.value[n.name]?(u(),P(t(v),{key:0,icon:t(ne),class:i([[t(l).dropZoneLockIcon],"animate-spin h-2 w-2"])},null,8,["icon","class"])):(u(),P(t(v),{key:1,icon:U.value[n.name]?t(aa):t(Me),class:i([[t(l).dropZoneLockIcon],"h-2 w-2"])},null,8,["icon","class"]))])):y("",!0),Q.value.has(n.name)?(u(),d("div",hr,[p(t(v),{icon:t(ne),class:i([[t(l).dropZoneLockIcon],"h-4 w-4 animate-spin"])},null,8,["icon","class"])])):y("",!0)]),s("div",xr,[s("span",{class:i([[t(l).dropZoneFileText],"text-xs truncate block"]),title:n.name},h(n.name.split("/").pop()),11,yr)]),n.is_directory?y("",!0):(u(),d("div",{key:1,class:i([[t(l).dropZoneFileSize],"text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},h(ka(n.size)),3)),he(n)?(u(),d("div",{key:2,class:i([[t(l).dropZoneFileSize],"text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},h(he(n)),3)):y("",!0)],42,vr))),128))]),_:2},1024)],64))),128)):(u(),P(Gt,{key:4,name:"file-item-list"},{default:$(()=>[(u(!0),d(z,null,B(lt.value,a=>(u(),d("div",{key:a.name,"data-filename":a.name,class:i(["group relative flex items-center gap-3 cursor-pointer px-2 py-1.5 rounded transition-colors overflow-hidden",te(a)?t(l).desktopIconBgSelected:t(l).desktopIconBg]),onClick:n=>xe(a,n),onDblclick:n=>ue(a),onContextmenu:Xe(n=>$e(n,a),["stop"]),onTouchstart:n=>ye(a,n),onTouchmove:ge,onTouchend:n=>we(a,n)},[k.value[a.name]!==void 0&&k.value[a.name]<100?(u(),d("div",{key:0,class:"absolute inset-0 bg-blue-500/20 transition-all duration-300 ease-out",style:ae({width:`${k.value[a.name]}%`})},null,4)):y("",!0),s("div",wr,[p(t(v),{icon:fe(a),class:i([[t(l).dropZoneFileIcon,Q.value.has(a.name)?"opacity-40":""],"h-5 w-5"])},null,8,["icon","class"]),r.value==="dropzone"&&!a.is_directory?(u(),d("div",kr,[N.value[a.name]?(u(),P(t(v),{key:0,icon:t(ne),class:i([[t(l).dropZoneLockIcon],"animate-spin h-2 w-2"])},null,8,["icon","class"])):(u(),P(t(v),{key:1,icon:U.value[a.name]?t(aa):t(Me),class:i([[t(l).dropZoneLockIcon],"h-2 w-2"])},null,8,["icon","class"]))])):y("",!0),Q.value.has(a.name)?(u(),d("div",br,[p(t(v),{icon:t(ne),class:i([[t(l).dropZoneLockIcon],"h-4 w-4 animate-spin"])},null,8,["icon","class"])])):y("",!0)]),s("div",_r,[s("span",{class:i([[t(l).dropZoneFileText],"text-xs truncate block"]),title:a.display_name||a.name},h(Vt(a)),11,Sr)]),a.is_directory?y("",!0):(u(),d("div",{key:1,class:i([[t(l).dropZoneFileSize],"text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},h(ka(a.size)),3)),he(a)?(u(),d("div",{key:2,class:i([[t(l).dropZoneFileSize],"text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},h(he(a)),3)):y("",!0)],42,gr))),128))]),_:1}))]))]),_:1},8,["name"]))]))]),_:1})],544),p(de,{name:"upload-slide-up"},{default:$(()=>[Jo.value?(u(),d("div",{key:0,class:i(["border-t",[t(l).dropZoneDragHolder,t(l).scopeSelector]])},[s("div",{class:i([t(l).hrSelector])},null,2),s("div",{onClick:o[24]||(o[24]=a=>je.value.length>0&&(vt.value=!vt.value)),class:i(["flex items-center gap-2 h-7 pb-0.5 px-3",je.value.length>0?"cursor-pointer hover:opacity-80":"cursor-default"]),style:{transition:"opacity 0.15s ease"}},[s("div",Fr,[p(t(v),{icon:t(ne),class:i([[t(l).dropZoneDragIcon],"w-3.5 h-3.5 flex-shrink-0 animate-spin"])},null,8,["icon","class"]),s("span",{class:i([[t(l).dropZoneDragUpText],"text-[10px] leading-none truncate"])},[je.value.length>0?(u(),d(z,{key:0},[K(h(je.value.length)+" uploading",1),ga.value.length>0?(u(),d(z,{key:0},[K(", "+h(ga.value.length)+" queued",1)],64)):y("",!0)],64)):(u(),d(z,{key:1},[K(h(ga.value.length)+" queued, waiting...",1)],64))],2)]),s("div",Cr,[p(t(na),{percent:en.value,class:i([[t(l).scopeSelector],"rounded-full flex-1"]),"show-info":!1,size:2,status:"active"},null,8,["percent","class"])]),je.value.length>0?(u(),P(t(v),{key:0,icon:t(Qn),class:i([[t(l).dropZoneFileIcon,"transition-transform duration-200",vt.value&&"rotate-180"],"w-3.5 h-3.5 flex-shrink-0"])},null,8,["icon","class"])):y("",!0)],2),s("div",{class:i(["expand-wrapper",!vt.value&&"collapsed"])},[s("div",Tr,[s("div",{class:i([t(l).dropZoneFileDisplayer])},[s("div",{class:i([t(l).hrSelector])},null,2),s("div",Ir,[(u(!0),d(z,null,B(je.value,a=>(u(),d("div",{key:a.uid,class:"px-3 py-1.5"},[s("div",Dr,[p(t(v),{icon:t(Ue),class:i([[t(l).dropZoneFileIcon],"w-3.5 h-3.5 flex-shrink-0"])},null,8,["icon","class"]),s("div",zr,[s("div",$r,[s("p",{class:i([[t(l).dropZoneFileText],"text-[11px] font-medium truncate flex-1"]),title:a.name},h(a.name),11,Mr),s("span",{class:i([[t(l).dropZoneFileSize],"text-[9px] font-semibold px-1 rounded whitespace-nowrap"])},h(wa.value[a.uid]||0)+"% ",3)]),p(t(na),{percent:wa.value[a.uid]||0,class:i([[t(l).scopeSelector],"rounded-full"]),"show-info":!1,size:1.5,status:"active"},null,8,["percent","class"])])])]))),128))])],2)])],2)],2)):y("",!0)]),_:1}),p(el,{icon:tn.value,message:an.value,info:on.value,showHelp:!0},{help:$(()=>[s("div",Er,[s("div",Rr,[p(t(v),{icon:t(go),class:i(["w-5 h-5",t(l).statusBarIcon])},null,8,["icon","class"]),s("h4",{class:i(["text-base font-semibold",t(l).statusBarText])},"File Explorer",2)]),s("div",{class:i(["text-[10px] md:text-xs space-y-2 leading-relaxed",t(l).statusBarInfo])},[...o[59]||(o[59]=[s("p",null,[s("strong",null,"Storage:"),K(" Your personal file storage. Files are stored as-is without encryption.")],-1),s("p",null,[s("strong",null,"Drop Zone:"),K(" Encrypted storage. Every file is automatically encrypted with AES-256-GCM using your unique user key.")],-1),s("p",null,[s("strong",null,"App Drive:"),K(" Access files from your Docker containers' mounted volumes.")],-1)])],2)])]),_:1},8,["icon","message","info"])]),p(Gn,{visible:da.value,x:La.value,y:Ba.value,items:ln.value,onClose:_t},null,8,["visible","x","y","items"]),p(ta,{visible:Ye.value,"onUpdate:visible":o[25]||(o[25]=a=>Ye.value=a),type:"confirm",title:va.value,content:ma.value,"ok-text":"Delete","cancel-text":"Cancel",onOk:yn,onCancel:o[26]||(o[26]=a=>Ye.value=!1)},null,8,["visible","title","content"]),p(ta,{visible:tt.value,"onUpdate:visible":o[28]||(o[28]=a=>tt.value=a),type:"info",title:"Create New Folder","ok-text":"Create","cancel-text":"Cancel",onOk:uo,onCancel:o[29]||(o[29]=a=>tt.value=!1),icon:t(Fa)},{default:$(()=>[s("div",Zr,[s("label",{class:i([[t(l).notTextDown],"text-sm block mb-2"])},"Folder name (max 255 characters)",2),p(t(Io),{value:Fe.value,"onUpdate:value":o[27]||(o[27]=a=>Fe.value=a),placeholder:"Enter folder name...",onPressEnter:uo,class:i([[t(l).scopeSelector,t(l).loginFormInput],"h-10"]),autofocus:"",maxlength:255},{prefix:$(()=>[p(t(v),{icon:t(H),class:i([[t(l).formIcon],"mr-0.5 transition duration-300"]),width:"16",height:"16"},null,8,["icon","class"])]),_:1},8,["value","class"])])]),_:1},8,["visible","icon"]),p(ta,{visible:mt.value,"onUpdate:visible":o[31]||(o[31]=a=>mt.value=a),type:"info",title:"Rename Item","ok-text":"Rename","cancel-text":"Cancel",onOk:co,onCancel:o[32]||(o[32]=a=>mt.value=!1),icon:t(za)},{default:$(()=>[s("div",Ar,[s("label",{class:i([[t(l).notTextDown],"text-sm block mb-2"])},"New name (max 255 characters)",2),p(t(Io),{value:me.value,"onUpdate:value":o[30]||(o[30]=a=>me.value=a),placeholder:"Enter new name...",onPressEnter:co,class:i([[t(l).scopeSelector,t(l).loginFormInput],"h-10"]),autofocus:"",maxlength:255},{prefix:$(()=>[p(t(v),{icon:t(za),class:i([[t(l).formIcon],"mr-0.5 transition duration-300"]),width:"16",height:"16"},null,8,["icon","class"])]),_:1},8,["value","class"])])]),_:1},8,["visible","icon"]),p(ta,{visible:ft.value,"onUpdate:visible":o[33]||(o[33]=a=>ft.value=a),type:"info",title:"Folder Upload Detected","ok-text":"Upload Folder","cancel-text":"Cancel",onOk:Cn,onCancel:Tn,icon:t(H),width:480,"reverse-buttons":!0},{default:$(()=>[s("div",Lr,[s("p",{class:i([[t(l).notTextDown],"text-sm leading-relaxed"])},[o[60]||(o[60]=K(" You are about to upload ",-1)),s("strong",null,h(Le.value?.allFiles.length||0)+" files",1),o[61]||(o[61]=K(" across ",-1)),s("strong",null,h(Le.value?.folders.length||0)+" directories",1),o[62]||(o[62]=K(". ",-1)),r.value==="dropzone"?(u(),d("span",Br," Each file will be encrypted individually.")):y("",!0)],2),s("p",{class:i([[t(l).notTextDown],"text-sm leading-relaxed"])},"The folder structure will be preserved.",2)])]),_:1},8,["visible","icon"]),nt.value?(u(),P(t(tl),{key:1,fileList:Aa.value,"onUpdate:fileList":o[34]||(o[34]=a=>Aa.value=a),name:"file",multiple:!0,customRequest:In,onChange:Dn,showUploadList:!1,class:"fixed bottom-10 right-2 z-50 hidden max-[900px]:block"},{default:$(()=>[s("button",{class:i([[t(l).dropZoneSortButton],"w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-transform duration-300 active:scale-95 border-none cursor-pointer"]),title:"Upload Files"},[p(t(v),{icon:t(Da),class:"w-6 h-6"},null,8,["icon"])],2)]),_:1},8,["fileList"])):y("",!0),p(gl,{visible:Xo.value,message:Po.value,position:"bottom-left"},null,8,["visible","message"])],544))}}),Di=Lo(Or,[["__scopeId","data-v-0a18dc57"]]);export{Di as default};
