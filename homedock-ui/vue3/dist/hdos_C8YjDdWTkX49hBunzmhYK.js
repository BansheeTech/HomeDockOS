import{M as ue,bQ as ce,aU as c,q as T,bE as O,aD as de,aI as ve,u as I,aL as k,v as u,t as X,I as p,au as i,bk as s,bU as S,bb as P,bJ as z,F as pe,aX as fe,aw as me,bV as ge,g as he,h as be,bR as _e}from"./hdos_BmqLjGp9pD_x_NB4upKEB.js";import{i as xe,a as we,V as ye,ae as Ce,g as Ie,n as Y,a4 as ke,$ as Se,a8 as Be,a7 as Me,a5 as $e,a9 as Te,af as Ee,ag as De,ab as Le,aa as Re,N as Ae,ah as Oe,ai as Pe,T as ze,K as Ne,aj as Fe,r as Ge,o as We,C as Ue,a3 as V}from"./hdos_TAoCV3MV09JGZrSceMlkI.js";import{_ as Xe}from"./hdos_CAFSXUB9ejWuPT9PfRgwK.js";import{d as Ye}from"./hdos_Dk8ORdgBuQt10zGqyIF6s.js";import{e as Ve}from"./hdos_BsaJBtI1N-WeUcSk3jJyl.js";import{d as He}from"./hdos_D-aTiBESONjHycDbZB5aD.js";import"./hdos_D44-qjTiwUddp5Oy6nAd3.js";import"./hdos_BbS_vWe5DNlDDYAPlKxdN.js";import"./hdos_Dz3aTMQqM4LnOlKzV3COc.js";import"./hdos_itWSuQ2oYLgMGq-Z_V6WL.js";import"./hdos_DCQvziD-0BGtLQC-jPv6N.js";import"./hdos_CJoaCRc7PMIr83ndc1bSY.js";import"./hdos_DIn7j5yNZ-jo19dGvRebC.js";import"./hdos_Cuccj8xUVyEDTvA_fcq1n.js";import"./hdos_BIGJWr_bpeXTKglK2UXub.js";import"./hdos_DG8c-fE8MmEkU_Tt58C8V.js";const je={width:24,height:24,hidden:!0,body:'<path fill="currentColor" d="M21 14H3V4h18m0-2H3c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h7l-2 3v1h8v-1l-2-3h7a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z"/>'},Ze={key:0,class:"empty-folder-state"},qe=["onClick","onDblclick","onContextmenu","onTouchstart","onTouchend","title"],Je={key:0,class:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-2xl pointer-events-none z-[2]"},Ke={class:"space-y-2.5 max-w-sm"},Qe={class:"flex items-center gap-2"},et=500,tt=10,at=ue({__name:"AppFolder",props:{folderId:{}},setup(H){const _=H,f=xe(),x=we(),{isMobile:E}=ye(),{themeClasses:a}=ce(),{confirm:j}=Ce(),m=Ie(),d=c(null),g=c(null),l=c(null),N=c(0),B=c(!1);let v=null;const F=c(0),G=c(0),M=c(!1),h=c({visible:!1,x:0,y:0}),w=c(110),D=c(125),y=c(16),Z=T(()=>f.getFolderById(_.folderId)),L=T(()=>Z.value?.name||"Unknown Folder"),C=T(()=>{const e=f.getAppsInFolder(_.folderId),n={running:1,paused:2,restarting:3,created:4,exited:5};return e.sort((t,r)=>{const o=n[t.status]||99,b=n[r.status]||99;return o===b?t.name.localeCompare(r.name):o-b})});function q(e){return{running:a.value.statusBadgeRunning,exited:a.value.statusBadgeExited,paused:a.value.statusBadgePaused,created:a.value.statusBadgeCreated,restarting:a.value.statusBadgeRestarting}[e]||a.value.statusBadgeCreated}function $(){const e=d.value?.clientWidth||window.innerWidth;if(E.value){const r=e-32,o=Math.floor(r/4);w.value=o,D.value=o+15,y.value=16}else w.value=110,D.value=125,y.value=16;K()}function J(e){const n=N.value||1,t=Math.floor(e/n),r=e%n,o={position:"absolute",left:`${y.value+r*w.value}px`,top:`${y.value+t*D.value}px`};return E.value&&(o.width=`${w.value}px`),o}function K(){const e=d.value?.clientWidth||window.innerWidth;N.value=Math.max(1,Math.floor((e-y.value*2)/w.value))}function Q(e){return{running:"",paused:"brightness-50 opacity-75",exited:"grayscale brightness-50 opacity-75",created:"brightness-50 sepia opacity-50"}[e.status]||""}function ee(e){g.value=e.id}function te(e){e.status==="running"&&e.service_url?window.open(e.service_url,"_blank","noopener,noreferrer"):x.openWindow("properties",{title:`${e.display_name||e.name} - Properties`,data:{appId:e.id},allowMultiple:!0})}function W(e,n){e.preventDefault(),e.stopPropagation(),g.value=n.id,l.value=n,h.value={visible:!0,x:e.clientX,y:e.clientY}}function ae(e){e.target.closest(".desktop-icon")||(e.preventDefault(),e.stopPropagation(),g.value=null,l.value=null,h.value={visible:!0,x:e.clientX,y:e.clientY})}const ne=T(()=>{if(!l.value)return[{label:"Refresh",icon:Y,action:()=>{}}];const e=l.value,n=e.status==="running",t=e.status==="exited",r=e.status==="paused",o=[];return n&&e.service_url&&(o.push({label:"Open",icon:Ve,action:()=>{l.value?.service_url&&window.open(l.value.service_url,"_blank","noopener,noreferrer")}}),o.push({divider:!0})),o.push({label:n?"Stop":"Start",icon:n?ke:Se,action:async()=>{l.value&&(n?await Be(l.value,m.value,a.value.scopeSelector):await Me(l.value,m.value,a.value.scopeSelector))},disabled:r}),o.push({label:"Restart",icon:$e,action:async()=>{l.value&&await Te(l.value,m.value,a.value.scopeSelector)},disabled:t}),o.push({divider:!0}),o.push({label:r?"Unpause":"Pause",icon:r?Ee:De,action:async()=>{l.value&&(r?await Le(l.value,m.value,a.value.scopeSelector):await Re(l.value,m.value,a.value.scopeSelector))},disabled:t}),o.push({divider:!0}),o.push({label:"View Logs",icon:Ae,action:()=>{l.value&&x.openWindow("logs",{title:`${l.value.display_name||l.value.name} - Logs`,data:{appName:l.value.name},allowMultiple:!0})}}),o.push({label:"Update",icon:Oe,action:async()=>{l.value&&await Pe(l.value,m.value,a.value.scopeSelector)}}),o.push({label:"Refresh",icon:Y,action:()=>{}}),o.push({divider:!0}),o.push({label:"Properties",icon:ze,action:()=>{l.value&&x.openWindow("properties",{title:`${l.value.display_name||l.value.name} - Properties`,data:{appId:l.value.id},allowMultiple:!0})}}),o.push({divider:!0}),o.push({label:"Remove from Folder",icon:He,action:()=>{l.value&&f.removeAppFromFolder(l.value.id)}}),o.push({divider:!0}),o.push({label:"Uninstall",icon:Ne,action:()=>{if(!l.value)return;const b=l.value;j({title:"Confirm Uninstall",content:`Are you sure you want to uninstall ${b.display_name||b.name}? This action cannot be undone.`,okText:"Uninstall",cancelText:"Cancel",onOk:async()=>{await Fe(b,m.value,a.value.scopeSelector)}})}}),o});function se(){h.value.visible=!1,l.value=null}function oe(e,n){if(e.touches.length>1)return;const t=e.touches[0];F.value=t.clientX,G.value=t.clientY,M.value=!1,v=setTimeout(()=>{if(!M.value){const r=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});W(r,n),navigator.vibrate&&navigator.vibrate(50)}},et)}function le(e){if(!v)return;const n=e.touches[0],t=n.clientX-F.value,r=n.clientY-G.value;Math.sqrt(t*t+r*r)>tt&&(M.value=!0,v&&(clearTimeout(v),v=null))}function re(e,n){v&&(clearTimeout(v),v=null),M.value=!1}function ie(e,n){if(!d.value)return!1;const t=d.value.getBoundingClientRect();return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom}function R(e){B.value=ie(e.clientX,e.clientY)}function A(e){B.value&&f.draggedAppIds.length>0&&(e.preventDefault(),e.stopPropagation(),f.draggedAppIds.forEach(n=>{const t=f.dockerApps.find(r=>r.id===n);t&&t.folderId!==_.folderId&&f.addAppToFolder(n,_.folderId)}),f.clearDraggedApps()),B.value=!1}O(()=>f.draggedAppIds.length>0,e=>{e?(document.addEventListener("mousemove",R,!0),document.addEventListener("mouseup",A,!0)):(document.removeEventListener("mousemove",R,!0),document.removeEventListener("mouseup",A,!0),B.value=!1)}),O(L,e=>{const n=x.windows.find(t=>t.appId==="folder-view"&&t.data?.folderId===_.folderId);n&&x.updateWindowTitle(n.id,e)},{immediate:!1});function U(){$()}return O(()=>E.value,()=>{$()}),de(()=>{if($(),window.addEventListener("resize",U),d.value){const e=new ResizeObserver(()=>{$()});e.observe(d.value),d.value.__resizeObserver=e}}),ve(()=>{window.removeEventListener("resize",U),d.value&&d.value.__resizeObserver&&d.value.__resizeObserver.disconnect(),document.removeEventListener("mousemove",R,!0),document.removeEventListener("mouseup",A,!0),v&&(clearTimeout(v),v=null)}),(e,n)=>(k(),I("div",{class:i(["folder-view-container",s(a).folderContainerBg])},[u("div",{class:i(["folder-breadcrumb",[s(a).folderBreadcrumbBg,s(a).folderBreadcrumbBorder]])},[p(s(S),{icon:s(je),class:i(["breadcrumb-icon",s(a).folderBreadcrumbIcon])},null,8,["icon","class"]),u("span",{class:i(["breadcrumb-text",s(a).folderBreadcrumbText])},"Desktop",2),p(s(S),{icon:s(Ge),class:i(["breadcrumb-separator",s(a).folderBreadcrumbSeparator])},null,8,["icon","class"]),p(s(S),{icon:s(We),class:i(["breadcrumb-icon",s(a).folderBreadcrumbIcon])},null,8,["icon","class"]),u("span",{class:i(["breadcrumb-text folder-name",s(a).folderBreadcrumbText])},P(L.value),3),u("span",{class:i(["app-count",s(a).folderAppCount])},"("+P(C.value.length)+" apps)",3)],2),C.value.length===0?(k(),I("div",Ze,[p(s(S),{icon:s(Ye),class:i(["empty-icon",s(a).folderEmptyIcon])},null,8,["icon","class"]),u("h3",{class:i(["empty-title",s(a).folderEmptyTitle])},"Empty folder",2),u("p",{class:i(["empty-description",s(a).folderEmptyDescription])},"Drag apps here to organize them",2)])):X("",!0),u("div",{class:"folder-apps-grid",ref_key:"containerRef",ref:d,onContextmenu:ae},[p(be,{name:"icon-appear"},{default:z(()=>[(k(!0),I(pe,null,fe(C.value,(t,r)=>(k(),I("div",{key:t.id,class:i(["desktop-icon group flex flex-col items-center gap-1 cursor-pointer p-3 rounded-lg w-[100px] z-[1] select-none outline-none border",g.value!==t.id&&["border-transparent","shadow-[0_0_0_1px_transparent]"],g.value===t.id&&[s(a).desktopIconBgSelected,s(a).desktopIconBorderSelected,s(a).desktopIconShadowSelected]]),style:me(J(r)),onClick:o=>ee(t),onDblclick:o=>te(t),onContextmenu:o=>W(o,t),onTouchstart:o=>oe(o,t),onTouchmove:le,onTouchend:o=>re(o,t),title:`${t.display_name||t.name} (${t.status})`},[u("div",{class:i(["icon-container relative w-16 h-16 flex items-center justify-center rounded-2xl overflow-hidden pointer-events-none border",s(a).desktopIconContainerBg,s(a).desktopIconContainerScaleHover,g.value!==t.id&&["border-transparent",s(a).desktopIconContainerBgHover],g.value===t.id&&[s(a).desktopIconContainerBgSelected,s(a).desktopIconContainerBorderSelected],Q(t)])},[p(ge,{src:t.image_path,class:"app-image rounded-xl",alt:"",draggable:"false"},null,8,["src"]),p(he,{name:"loading-overlay-fade"},{default:z(()=>[t.isProcessing===!0?(k(),I("div",Je,[...n[0]||(n[0]=[u("div",{class:"w-8 h-8 rounded-full border-[3px] border-white/30 border-t-blue-500 animate-spin shadow-lg"},null,-1)])])):X("",!0)]),_:2},1024),u("div",{class:i(["status-badge",q(t.status),s(a).desktopStatusBadgeBorder,{"status-pulse":t.status==="running"}])},null,2)],2),u("span",{class:i(["app-name",[s(a).desktopIconText]])},P(t.display_name||t.name),3)],46,qe))),128))]),_:1})],544),p(Ue,{visible:h.value.visible,x:h.value.x,y:h.value.y,items:ne.value,onClose:se},null,8,["visible","x","y","items"]),p(Xe,{icon:s(V),message:`${L.value}`,info:`${C.value.length} ${C.value.length===1?"app":"apps"}`,showHelp:!0},{help:z(()=>[u("div",Ke,[u("div",Qe,[p(s(S),{icon:s(V),class:i(["w-5 h-5",s(a).statusBarIcon])},null,8,["icon","class"]),u("h4",{class:i(["text-base font-semibold",s(a).statusBarText])},"Folder",2)]),u("div",{class:i(["text-[10px] md:text-xs space-y-2 leading-relaxed",s(a).statusBarInfo])},[...n[1]||(n[1]=[u("p",null,"Folders help you organize your apps by grouping related applications together. Create folders by dragging apps on top of each other on the desktop, making it easier to manage and access your installed applications.",-1)])],2)])]),_:1},8,["icon","message","info"])],2))}}),_t=_e(at,[["__scopeId","data-v-4f66b770"]]);export{_t as default};
