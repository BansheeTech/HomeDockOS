import{e as O,ak as P,an as p,x as R,d as y,o as D,aK as E,M as g,a3 as C,B,R as k}from"./hdos_D7aSCFL4UvFrWXA16SYVB.js";import{a as I}from"./hdos_lgSvMSNReVzNZOmcAhJsO.js";import{g as j}from"./hdos_CaYxDlfwW2kUaZ5aP_Icr.js";var x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"};function v(e){for(var s=1;s<arguments.length;s++){var t=arguments[s]!=null?Object(arguments[s]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),n.forEach(function(a){M(e,a,t[a])})}return e}function M(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}var b=function(s,t){var n=v({},s,t.attrs);return O(P,v({},n,{icon:x}),null)};b.displayName="RightOutlined";b.inheritAttrs=!1;const N=()=>{const e=p(!1);return R(()=>{e.value=!0}),e},F={type:{type:String},actionFn:Function,close:Function,autofocus:Boolean,prefixCls:String,buttonProps:k(),emitEvent:Boolean,quitOnNullishReturnValue:Boolean};function S(e){return!!(e&&e.then)}const J=y({compatConfig:{MODE:3},name:"ActionButton",props:F,setup(e,s){let{slots:t}=s;const n=p(!1),a=p(),c=p(!1);let d;const u=N();D(()=>{e.autofocus&&(d=setTimeout(()=>{var r,o;return(o=(r=E(a.value))===null||r===void 0?void 0:r.focus)===null||o===void 0?void 0:o.call(r)}))}),R(()=>{clearTimeout(d)});const i=function(){for(var r,o=arguments.length,l=new Array(o),f=0;f<o;f++)l[f]=arguments[f];(r=e.close)===null||r===void 0||r.call(e,...l)},m=r=>{S(r)&&(c.value=!0,r.then(function(){u.value||(c.value=!1),i(...arguments),n.value=!1},o=>(u.value||(c.value=!1),n.value=!1,Promise.reject(o))))},A=r=>{const{actionFn:o}=e;if(n.value)return;if(n.value=!0,!o){i();return}let l;if(e.emitEvent){if(l=o(r),e.quitOnNullishReturnValue&&!S(l)){n.value=!1,i(r);return}}else if(o.length)l=o(e.close),n.value=!1;else if(l=o(),!l){i();return}m(l)};return()=>{const{type:r,prefixCls:o,buttonProps:l}=e;return O(B,g(g(g({},C(r)),{},{onClick:A,loading:c.value,prefixCls:o},l),{},{ref:a}),t)}}}),T=j("selectedApps",{state:()=>({selectedApps:[],applications:[],desiredStates:{},errorStates:{}}),actions:{setApplications(e){const s=this.applications;this.applications=e.map(t=>{const n=s.find(u=>u.name===t.name);if(!n)return{...t,isProcessing:!1,checked:this.selectedApps.includes(t.name)};let a=n.isProcessing;const c=this.desiredStates[t.name];return c&&t.status===c&&(a=!1,delete this.desiredStates[t.name]),n.status!==t.status&&(a=!1),{...t,isProcessing:a,checked:this.selectedApps.includes(t.name)}})},setDesiredState(e,s){this.desiredStates[e]=s},clearDesiredState(e){delete this.desiredStates[e]},getDesiredState(e){return this.desiredStates[e]},setErrorState(e,s){this.errorStates[e]=s},clearErrorState(e){delete this.errorStates[e]},saveOrder(){const e="dashboardLocalOrder",s=this.applications.filter(t=>t.HDRole!=="dependency").map(t=>t.name);localStorage.setItem(e,JSON.stringify(s))},updateSelection(e){this.selectedApps=e,this.applications.forEach(s=>{s.checked=e.includes(s.name)})},clearSelection(){this.selectedApps=[],this.applications.forEach(e=>{e.checked=!1})},toggleSelection(e){const s=this.applications.find(t=>t.name===e);s&&(s.checked=!s.checked,s.checked?this.selectedApps.push(s.name):this.selectedApps=this.selectedApps.filter(t=>t!==e))},setProcessing(e,s){const t=this.applications.find(n=>n.name===e);t&&(t.isProcessing=s)}}});let h=null;async function _(e){const s=T();try{const t=await I.get("/api/containers",{headers:{"X-HomeDock-CSRF-Token":e}});if(t.status===200){const n=t.data,a=H(n);return s.setApplications(a),a}return[]}catch(t){throw console.error("Error fetching containers:",t),t}}function H(e){const t=localStorage.getItem("dashboardLocalOrder");if(!t)return e;const n=JSON.parse(t),a=e.filter(i=>i.HDRole!=="dependency"),c=e.filter(i=>i.HDRole==="dependency"),d=n.map(i=>a.find(m=>m.name===i)).filter(Boolean),u=a.filter(i=>!n.includes(i.name));return[...d,...u,...c]}function K(e,s=3e3){L(),h=setInterval(()=>_(e),s)}function L(){h&&(clearInterval(h),h=null)}export{J as A,b as R,L as a,_ as f,K as s,T as u};
