import{M as Aa,bQ as Ha,aU as f,q as F,bE as dt,aD as Na,as as Ae,aI as Oa,u as v,aL as p,I as u,v as l,bJ as g,t as h,au as r,bk as n,bU as y,bb as b,g as de,s as Se,F as z,aX as V,bV as Kt,H as re,aw as W,h as pt,bO as pe,bR as qa}from"./hdos_BmqLjGp9pD_x_NB4upKEB.js";import{a as L,d as Jt}from"./hdos_BbS_vWe5DNlDDYAPlKxdN.js";import{g as Va,i as Wa,j as Ga,k as Qa,l as He,m as Ce,n as vt,o as ie,p as ft,q as Ka,r as Ja,C as en,A as Ne,s as ea,t as tn,v as an,w as nn,x as on,y as sn,z as ln,B as rn,D as un,E as cn}from"./hdos_Dnl9hXBV8DOILghlKTp6-.js";import{d as mt,a as dn,b as pn,c as vn,e as fn,f as mn,g as ta,S as hn}from"./hdos_CpfTwhf8Ogtfq-NFSAlxy.js";import{d as xn}from"./hdos_D7NRCijMj_Q9fS__axrEk.js";import{d as aa}from"./hdos_DPhlMBAcwmj4N6C-RIU0v.js";import{d as Oe,a as gn}from"./hdos_CvPrm34SGjwAav8ECB8VW.js";import{d as ht}from"./hdos_CS7Pix6yyXf4PLMilHEK5.js";import{d as yn}from"./hdos_B3p2GIGZACSZVaJ-BO-PB.js";import{_ as wn}from"./hdos_BWDtWmt86vgIqFO09DYHf.js";import{l as C}from"./hdos_D44-qjTiwUddp5Oy6nAd3.js";import{a as Te,S as xt}from"./hdos_nEiH1KAJyvQ0-p9G03o80.js";import{P as gt,U as bn}from"./hdos_DGn-1hRvwwN21IC3LJIQ3.js";import"./hdos_DF46ymXzO4uwxmDSAe6gf.js";import{I as na}from"./hdos_DEccDvFFPfF_WAEMr3xFz.js";import{$ as yt}from"./hdos_BsaJBtI1N-WeUcSk3jJyl.js";import"./hdos_Dz3aTMQqM4LnOlKzV3COc.js";import"./hdos_itWSuQ2oYLgMGq-Z_V6WL.js";import"./hdos_DCQvziD-0BGtLQC-jPv6N.js";import"./hdos_CJoaCRc7PMIr83ndc1bSY.js";import"./hdos_DIn7j5yNZ-jo19dGvRebC.js";import"./hdos_Cuccj8xUVyEDTvA_fcq1n.js";import"./hdos_BIGJWr_bpeXTKglK2UXub.js";import"./hdos_DG8c-fE8MmEkU_Tt58C8V.js";import"./hdos_D63Tfrq7hZ9D-jbqbBA6V.js";import"./hdos_4kSeDeykJxDNm69X1d3vo.js";import"./hdos_Pj1gt1xWrDqJMDlNHOv0C.js";import"./hdos_d3RpjDleDDtyEEtdMU5VZ.js";import"./hdos_BFFMvorPffEppRIR3Lrt-.js";import"./hdos_oIjEx523yCJ4FOOvJZIdT.js";import"./hdos_CVlC1q8VixWAeFa88SdlV.js";const kn={key:0,class:"absolute inset-0 z-[9999] pointer-events-none backdrop-blur-sm"},_n={class:"flex items-center align-center justify-center flex-col h-full"},Sn={class:"ant-upload-drag-icon"},Cn={class:"flex-1 flex flex-col overflow-auto px-4 pt-2 pb-5"},Tn={class:"mt-2 flex flex-col flex-1 gap-2"},Fn={class:"appdrive-controls-container flex flex-col gap-2 items-start justify-between flex-shrink-0"},Dn={class:"appdrive-selectors flex gap-2 w-full flex-wrap"},$n={class:"flex items-center gap-2"},Mn={class:"relative flex-shrink-0"},In={class:"truncate"},zn={class:"text-[10px] opacity-60"},En={class:"flex items-center gap-2"},Rn={class:"truncate text-xs"},Zn={class:"appdrive-actions-wrapper flex items-center gap-2 mt-0.5 w-full"},Pn=["title"],Un=["title"],Bn={key:0,class:"flex items-center gap-1 text-[11px] flex-shrink-0 flex-wrap"},Xn=["onClick"],Ln={class:"flex items-center justify-start text-[10px] gap-2 flex-shrink-0"},Yn=["title"],jn=["onClick"],An={class:"relative"},Hn={key:0,class:"flex justify-center items-center w-full py-8"},Nn={key:1,class:"absolute inset-0 flex justify-center items-center text-balance px-2 py-8"},On=["data-filename","onClick","onContextmenu","onTouchstart","onTouchend","onTouchcancel"],qn={key:1,class:"absolute -left-1 -bottom-1 flex items-center gap-0.5 z-10"},Vn={key:2,class:"absolute -right-1 -top-1 z-20"},Wn={key:3,class:"absolute inset-0 flex items-center justify-center z-10"},Gn=["title"],Qn={key:0,class:"absolute -bottom-1 left-2 right-2"},Kn={key:1,class:"flex justify-center items-center text-balance px-2 py-8"},Jn={class:"relative flex-shrink-0 z-[1]"},eo={class:r(["relative w-6 h-6 flex items-center justify-center"])},to=["data-filename","onClick","onContextmenu","onTouchstart","onTouchend","onTouchcancel"],ao={class:"relative flex-shrink-0 z-[1]"},no={class:r(["relative w-6 h-6 flex items-center justify-center"])},oo={key:0,class:"absolute inset-0 flex items-center justify-center"},so={key:1,class:"absolute -right-1.5 -top-1"},lo={class:"flex-1 overflow-hidden z-[1]"},ro=["title"],io={class:"mb-1"},uo={class:"mb-1"},co={class:"space-y-3"},po={class:"flex items-center gap-2 flex-1 min-w-0"},vo={class:"flex mt-1.5 items-center flex-1 max-w-xs"},fo={class:"max-h-60 overflow-y-auto py-1"},mo={class:"px-3 py-1.5"},ho={class:"flex items-center gap-1.5"},xo={class:"flex-1 min-w-0"},go={class:"flex items-center gap-1.5 mb-0.5"},yo=["title"],wo={class:"px-3 py-1.5 opacity-40"},bo={class:"flex items-center gap-1.5"},ko={class:"flex items-center gap-1.5 flex-1 min-w-0"},_o=["title"],So={class:"px-3 py-1 text-center"},Co={class:"space-y-2.5 max-w-sm"},To={class:"flex items-center gap-2"},oa=110,sa=125,Fo=20,Do=3,la=300,ra=500,ia=10,$o=Aa({__name:"AppAppDrive",props:{containerName:{},mountIndex:{}},setup(ua){const qe=ua,{themeClasses:s}=Ha(),Y=Va(),Ve=Wa(),T=Ga(),Fe=f([]),P=f([]),D=f([]),_=f(void 0),$=f(0),w=f(""),wt=F(()=>P.value.length===0||$.value<0||$.value>=P.value.length?null:P.value[$.value]),We=F(()=>wt.value?.container_path||""),U=F(()=>wt.value?.read_only||!1),De=f(!1),ve=f(!1),E=f(""),S=f(new Set),A=f(!1),x=f({startX:0,startY:0,currentX:0,currentY:0}),G=f(null);let Ge=!1;const Qe=f("name"),fe=f("asc"),Q=f("grid"),$e=f(!1),Me=f(0),me=f([]),j=f({}),B=f(new Set),he=f([]),Ie=f(0),ue=f(0),xe=f(0),ge=f(!1),bt=f(""),ze=f(!1);let Ke=!1;const K=f(null),Ee=f(0);let J=null,Re=0;const Je=f(!1),kt=f(0),_t=f(0),X=f(null),ee=f(!1),et=f(""),tt=f(""),te=f(null),O=f(!1),ce=f(""),ye=f(!1),ae=f(""),we=f(!1),ne=f(null),Ze=f(null);function oe(e){const a=Ve.dockerApps.find(t=>t.name===e);return{displayName:a?.display_name||e,iconPath:a?.image_path||"docker-icons/notfound.jpg"}}const at=F(()=>Fe.value.filter(e=>{const a=Ve.dockerApps.find(t=>t.name===e.name);return!a?.HDRole||a.HDRole!=="dependency"})),St=F(()=>{const e=Fe.value.find(t=>t.name===_.value);return e?oe(e.name).displayName:""}),ca=F(()=>{if(ue.value===0)return 0;let e=xe.value*100;return T.currentlyUploading.forEach(a=>{const t=T.uploadProgress[a.uid]||0;e+=t}),Math.round(e/ue.value)});dt(()=>T.totalUploading,(e,a)=>{if(a!==void 0&&e<a){const t=a-e;xe.value+=t}ue.value=xe.value+e,e===0&&ue.value>0&&setTimeout(()=>{ue.value=0,xe.value=0,ge.value=!1},3e3)},{immediate:!0});const Ct=F(()=>w.value?w.value.split("/").filter(e=>e):[]),Tt=F(()=>{const e=[...D.value];return e.sort((a,t)=>{if(a.is_directory&&!t.is_directory)return-1;if(!a.is_directory&&t.is_directory)return 1;let o=0;switch(Qe.value){case"name":o=a.display_name.localeCompare(t.display_name);break;case"size":o=a.size-t.size;break;case"date":o=a.modified-t.modified;break}return fe.value==="asc"?o:-o}),e}),nt=F(()=>{const e=Ee.value||window.innerWidth-100,a=Math.max(1,Math.floor(e/oa)),o=(e-16)/a,i=[];let c=0;return w.value&&(i.push({name:"__back__",display_name:"..",size:0,modified:0,is_directory:!0,x:8+(o-100)/2,y:8}),c=1),Tt.value.forEach((d,m)=>{const k=m+c,Z=k%a,I=Math.floor(k/a),N=8+Z*o+(o-100)/2,le=8+I*sa;i.push({...d,x:N,y:le})}),i}),da=F(()=>{if(nt.value.length===0)return 300;const o=Math.max(...nt.value.map(i=>i.y))+130+16;return Math.max(o,300)}),ot=F(()=>{const e=Ee.value||window.innerWidth-100,a=Math.max(1,Math.floor(e/oa)),o=(e-16)/a;return at.value.map((i,c)=>{const d=c%a,m=Math.floor(c/a),k=8+d*o+(o-100)/2,Z=8+m*sa;return{...i,x:k,y:Z}})}),pa=F(()=>{if(ot.value.length===0)return 300;const o=Math.max(...ot.value.map(i=>i.y))+130+16;return Math.max(o,300)}),Ft=F(()=>{const e=Math.min(x.value.startX,x.value.currentX),a=Math.min(x.value.startY,x.value.currentY),t=Math.abs(x.value.currentX-x.value.startX),o=Math.abs(x.value.currentY-x.value.startY);return{left:`${e}px`,top:`${a}px`,width:`${t}px`,height:`${o}px`}}),Dt=F(()=>{const e=D.value.reduce((a,t)=>a+(t.is_directory?0:t.size),0);return Gt(e)}),va=F(()=>_.value?St.value:"Select an application"),fa=F(()=>_.value?`${D.value.length} items`:"Browse application files"),ma=F(()=>{const e=[],a=S.value.size;if(a>1){const t=Array.from(S.value).map(d=>D.value.find(m=>m.name===d)).filter(d=>d!==void 0),o=t.some(d=>d.is_directory),i=t.filter(d=>!d.is_directory),c=a>3||o;return e.push({label:`Selected: ${a} items`,icon:Qa,disabled:!0}),e.push({divider:!0}),c?e.push({label:"Download as ZIP",icon:He,action:async()=>{const d=t.map(m=>m.name);_e(),await Fa(d)}}):i.length>0&&e.push({label:"Download All",icon:mt,action:async()=>{for(const d of i)await Le(d);_e()}}),U.value||(e.push({label:"Delete All",icon:ht,danger:!0,action:()=>{et.value=`Delete ${a} items?`,tt.value=`Are you sure you want to delete ${a} selected items? This action cannot be undone.`,te.value=null,ee.value=!0,_e()}}),e.push({divider:!0}),e.push({label:"New Folder",icon:Ce,action:()=>O.value=!0})),e.push({label:"Refresh",icon:vt,action:()=>lt()}),e}return X.value?X.value.is_directory?(e.push({label:"Open",icon:ie,action:()=>{const t=X.value.name;_e(),M(t)}}),e.push({label:"Download as ZIP",icon:mt,action:()=>Le(X.value)}),e.push({divider:!0}),U.value||(e.push({label:"Rename Folder",icon:Oe,action:()=>qt(X.value)}),e.push({label:"Delete Folder",icon:ht,danger:!0,action:()=>Nt(X.value)}),e.push({divider:!0}),e.push({label:"New Folder",icon:Ce,action:()=>O.value=!0}))):(e.push({label:"Download",icon:mt,action:()=>Le(X.value)}),e.push({divider:!0}),U.value||(e.push({label:"Rename File",icon:Oe,action:()=>qt(X.value)}),e.push({label:"Delete File",icon:ht,danger:!0,action:()=>Nt(X.value)}),e.push({divider:!0}),e.push({label:"New Folder",icon:Ce,action:()=>O.value=!0}))):_.value&&(U.value||e.push({label:"New Folder",icon:Ce,action:()=>O.value=!0}),e.push({label:"Refresh",icon:vt,action:()=>lt()})),e});function ha(e){return e.replace(/[^a-zA-Z0-9._-]/g,"").substring(0,128)}function xa(e){return typeof e!="number"||!Number.isInteger(e)||e<0?null:e}Na(async()=>{if(await Mt(),qe.containerName){const e=ha(qe.containerName);if(e&&Fe.value.some(t=>t.name===e)){_.value=e,await st(e);const t=xa(qe.mountIndex);t!==null&&t<P.value.length&&($.value=t,await M())}}Ae(()=>{$t(),ga()})}),Oa(()=>{J&&(J.disconnect(),J=null)}),dt(Q,()=>{Ae(()=>{$t()})}),dt(()=>Ve.dockerApps.length,()=>{Mt()});function $t(){K.value&&(Ee.value=K.value.clientWidth)}function ga(){J&&J.disconnect(),K.value&&(J=new ResizeObserver(e=>{for(const a of e)Ee.value=a.contentRect.width}),J.observe(K.value))}async function Mt(){De.value=!0;try{const e=await L.get("/api/appdrive/containers",{headers:{"X-HomeDock-CSRF-Token":Y.value}});Fe.value=e.data.containers||[]}catch{C.error("Failed to load containers")}finally{De.value=!1}}function ya(e){_.value=e,st(e)}async function st(e){if($.value=0,w.value="",!e){D.value=[],P.value=[];return}try{const a=await L.get("/api/appdrive/mounts",{params:{container:e},headers:{"X-HomeDock-CSRF-Token":Y.value}});P.value=a.data.mounts||[],P.value.length>0?await M():D.value=[]}catch(a){D.value=[],P.value=[],C.error(a.response?.data?.error||"Failed to load mounts")}}async function wa(){w.value="",await M()}async function M(e=""){if(!_.value||P.value.length===0)return;E.value="",S.value.clear();const a=++Re;ve.value=!0;try{const t=await L.get("/api/appdrive/files",{params:{container:_.value,mount:$.value,path:e},headers:{"X-HomeDock-CSRF-Token":Y.value}});if(a!==Re)return;D.value=t.data.files||[],w.value=e}catch(t){if(a!==Re)return;C.error(t.response?.data?.error||"Failed to load files")}finally{a===Re&&(ve.value=!1)}}async function lt(){await M(w.value)}let R=null,q=null,se=null,It=0,zt=0,Pe=null,be=!1,Ue=!1,H=null,Et=0,Rt=0,Be=!1;function rt(e,a){Ge||(q===e.name&&R?(clearTimeout(R),R=null,q=null,ba(e)):(R&&clearTimeout(R),q=e.name,a?.ctrlKey||a?.metaKey?(S.value.has(e.name)?S.value.delete(e.name):S.value.add(e.name),E.value=""):(S.value.clear(),E.value=e.name),R=setTimeout(()=>{R=null,q=null},la)))}function ba(e){e.is_directory?M(e.name):Le(e)}function Zt(){R&&(clearTimeout(R),R=null),q===".."?(q=null,ka()):(q="..",R=setTimeout(()=>{R=null,q=null},la))}function ka(){if(!w.value)return;const e=w.value.split("/");e.pop();const a=e.join("/");M(a)}function _a(){M("")}function Sa(e){const t=Ct.value.slice(0,e+1).join("/");M(t)}function Pt(e,a){const t=a.touches[0];t&&(Pe=e,be=!1,Ue=!1,It=t.clientX,zt=t.clientY,e.name!=="__back__"&&(se=setTimeout(()=>{Ue=!0,navigator.vibrate&&navigator.vibrate(50);const o=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});ke(o,e)},ra)))}function Ut(e){const a=e.touches[0];if(!a)return;Math.sqrt(Math.pow(a.clientX-It,2)+Math.pow(a.clientY-zt,2))>ia&&(be=!0,se&&(clearTimeout(se),se=null))}function Xe(e){if(se&&(clearTimeout(se),se=null),Ue){Ue=!1,be=!1,Pe=null;return}!be&&Pe===e&&rt(e),be=!1,Pe=null}function Ca(e){const a=e.target;if(a.closest(".appdrive-file-item")||a.closest(".appdrive-controls-container"))return;const i=e.touches[0];i&&(Et=i.clientX,Rt=i.clientY,Be=!1,H=setTimeout(()=>{navigator.vibrate&&navigator.vibrate(50);const c=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:i.clientX,clientY:i.clientY});ke(c,null),H=null},ra))}function Ta(e){if(!H)return;const a=e.touches[0];if(!a)return;Math.sqrt(Math.pow(a.clientX-Et,2)+Math.pow(a.clientY-Rt,2))>ia&&(Be=!0,H&&(clearTimeout(H),H=null))}function Bt(){H&&(clearTimeout(H),H=null),Be||(E.value="",S.value.clear()),Be=!1}async function Le(e){try{j.value[e.name]=0,e.is_directory&&B.value.add(e.name);const a=await L.get("/api/appdrive/download",{params:{container:_.value,mount:$.value,file:e.name},headers:{"X-HomeDock-CSRF-Token":Y.value},responseType:"blob",onDownloadProgress:i=>{i.total&&(j.value[e.name]=Math.round(i.loaded*100/i.total))}});e.is_directory&&B.value.delete(e.name);const t=URL.createObjectURL(a.data),o=document.createElement("a");o.href=t,o.download=e.is_directory?`${e.display_name}.zip`:e.display_name,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(t),setTimeout(()=>{delete j.value[e.name]},1e3)}catch{e.is_directory?(B.value.delete(e.name),C.error("Failed to download folder as ZIP")):C.error("Failed to download file"),delete j.value[e.name]}}const Xt=f(!1);async function Fa(e){if(e.length!==0)try{Xt.value=!0,e.forEach(d=>{D.value.find(k=>k.name===d)?.is_directory&&B.value.add(d)});const a=await L.post("/api/appdrive/download-multiple",{container:_.value,mount:$.value,files:e},{headers:{"X-HomeDock-CSRF-Token":Y.value},responseType:"blob"}),t=a.headers["content-disposition"];let o="download.zip";if(t){const d=t.match(/filename="?([^";\n]+)"?/);d&&(o=d[1].replace(/[<>:"/\\|?*]/g,"_"))}const i=URL.createObjectURL(a.data),c=document.createElement("a");c.href=i,c.download=o,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i),C.success(`Downloaded ${e.length} items as ZIP`)}catch{C.error("Failed to download files as ZIP")}finally{Xt.value=!1,e.forEach(a=>{B.value.delete(a)})}}async function Da(e,a,t){const o=new FormData;o.append("file",e),o.append("container",_.value),o.append("mount",String($.value)),t&&o.append("path",t);try{const i=await L.post("/api/appdrive/upload",o,{headers:{"Content-Type":"multipart/form-data","X-HomeDock-CSRF-Token":Y.value},onUploadProgress:c=>{if(c.total){const d=Math.round(c.loaded/c.total*100),m=e;T.updateProgress(m.uid,d),a&&a({percent:d})}}});i.data.success||C.error(i.data.error||"Upload failed")}catch(i){throw L.isAxiosError(i)?i.response?.status===413?C.error("The selected file is larger than the maximum allowed size."):C.error(i.response?.data?.error||`Unexpected error occurred: ${i.message}`):C.error("An unknown error occurred. Please try again."),i}}async function it(){if(!Ke){Ke=!0;try{for(;Ie.value<Do&&he.value.length>0;){const e=he.value.shift();if(!e)break;Ie.value++,T.startUpload({uid:e.file.uid,name:e.file.name,size:e.file.size}),(async()=>{try{await Da(e.file,e.onProgress,e.path),me.value=me.value.filter(a=>a.uid!==e.file.uid),T.completeUpload(e.file.uid),e.onSuccess&&e.onSuccess(null,e.file)}catch(a){T.cancelUpload(e.file.uid),e.onError&&e.onError(a)}finally{Ie.value--,it()}})()}}finally{Ke=!1}Ie.value===0&&he.value.length===0&&await M(w.value)}}function $a({file:e,onSuccess:a,onError:t,onProgress:o}){const i=e;T.addToQueue({uid:i.uid,name:i.name,size:i.size}),he.value.push({file:i,onProgress:o,onSuccess:a,onError:t,path:w.value}),it()}function Ma(e){me.value=[]}function Ia(e){U.value||(e.preventDefault(),Me.value++,e.dataTransfer?.types.includes("Files")&&($e.value=!0))}function za(e){e.preventDefault(),Me.value--,Me.value===0&&($e.value=!1)}function ut(e){return e.startsWith(".")}function Ye(e,a=0){bt.value=e,ze.value=!0,a>0&&setTimeout(()=>{ze.value=!1},a)}function Lt(){ze.value=!1}async function Yt(e,a=""){const t=[];return new Promise((o,i)=>{const c=e.createReader(),d=()=>{c.readEntries(async m=>{if(m.length===0){o(t);return}for(const k of m){if(ut(k.name))continue;const Z=a?`${a}/${k.name}`:k.name;if(k.isFile){const I=k,N=await new Promise((le,ct)=>{I.file(le,ct)});t.push({file:N,relativePath:a})}else if(k.isDirectory){const N=await Yt(k,Z);t.push(...N)}}d()},m=>{i(m)})};d()})}function Ea(e){const a=new Set;return e.forEach(({relativePath:o})=>{if(o){const i=o.split("/");let c="";for(const d of i)c=c?`${c}/${d}`:d,a.add(c)}}),Array.from(a).sort((o,i)=>{const c=o.split("/").length,d=i.split("/").length;return c!==d?c-d:o.localeCompare(i)})}async function Ra(e){if(e.preventDefault(),e.stopPropagation(),Me.value=0,$e.value=!1,U.value||!_.value||!e.dataTransfer)return;Ye("Scanning dropped items...");const a=[];if(e.dataTransfer.items&&e.dataTransfer.items.length>0){const o=[];for(let i=0;i<e.dataTransfer.items.length;i++){const c=e.dataTransfer.items[i];if(c.kind==="file"){const d=c.webkitGetAsEntry();d&&!ut(d.name)&&o.push(d)}}for(const i of o)if(i.isFile){const c=i,d=await new Promise((m,k)=>{c.file(m,k)});a.push({file:d,relativePath:""})}else if(i.isDirectory){Ye("Processing folders structure...");const c=i,d=await Yt(c,c.name);a.push(...d)}}else for(let o=0;o<e.dataTransfer.files.length;o++){const i=e.dataTransfer.files[o];ut(i.name)||a.push({file:i,relativePath:""})}if(a.length===0){Lt();return}const t=Ea(a);if(t.length>0){ne.value={allFiles:a,folders:t},we.value=!0,Lt();return}await jt(a)}async function jt(e){Ye(`Enqueueing ${e.length} ${e.length===1?"file":"files"} for upload...`),await Ae(),await new Promise(o=>setTimeout(o,50));const a=Date.now(),t=20;for(let o=0;o<e.length;o+=t){const i=e.slice(o,o+t);for(let c=0;c<i.length;c++){const{file:d,relativePath:m}=i[c],k=o+c,Z=`${a}-${k}-${Math.random().toString(36).substring(2,11)}-${d.name}`,I=d;I.uid=Z;const N=m?w.value?`${w.value}/${m}`:m:w.value,le=m?`${m}/${d.name}`:d.name;T.addToQueue({uid:I.uid,name:le,size:I.size}),he.value.push({file:I,path:N,onProgress:void 0,onSuccess:void 0,onError:void 0})}o+t<e.length&&await new Promise(c=>setTimeout(c,0))}Ye("Starting upload...",2e3),await Ae(),it()}async function Za(){if(!ne.value)return;we.value=!1;const{allFiles:e}=ne.value;ne.value=null,await jt(e)}function Pa(){we.value=!1,ne.value=null}function Ua(e){const a=e.target;if(a.closest(".appdrive-controls-container")||D.value.length===0&&!w.value||e.button!==0)return;const o=e.currentTarget?.getBoundingClientRect();if(!o)return;const i=e.clientX-o.left,c=e.clientY-o.top;G.value={x:i,y:c},a.closest(".appdrive-file-item")||(A.value=!0,x.value.startX=i,x.value.startY=c,x.value.currentX=i,x.value.currentY=c,E.value="",S.value.clear()),document.addEventListener("mousemove",At),document.addEventListener("mouseup",Ht)}function At(e){const t=K.value?.getBoundingClientRect();if(!t)return;let o=e.clientX-t.left,i=e.clientY-t.top;o=Math.max(0,Math.min(o,t.width)),i=Math.max(0,Math.min(i,t.height)),!A.value&&G.value&&Math.sqrt(Math.pow(o-G.value.x,2)+Math.pow(i-G.value.y,2))>Fo&&(A.value=!0,x.value.startX=G.value.x,x.value.startY=G.value.y,E.value="",S.value.clear()),A.value&&(x.value.currentX=o,x.value.currentY=i,Ba())}function Ht(){const e=Math.abs(x.value.currentX-x.value.startX)>5||Math.abs(x.value.currentY-x.value.startY)>5;!e&&A.value&&(E.value="",S.value.clear()),A.value&&e&&(Ge=!0,setTimeout(()=>{Ge=!1},50)),A.value=!1,G.value=null,document.removeEventListener("mousemove",At),document.removeEventListener("mouseup",Ht)}function Ba(){const e=Math.min(x.value.startX,x.value.currentX),a=Math.min(x.value.startY,x.value.currentY),t=Math.abs(x.value.currentX-x.value.startX),o=Math.abs(x.value.currentY-x.value.startY);S.value.clear();const c=K.value?.getBoundingClientRect();c&&document.querySelectorAll(".appdrive-file-item").forEach(d=>{const m=d.getBoundingClientRect(),k=m.left-c.left,Z=m.top-c.top,I=k+m.width,N=Z+m.height,le=e+t,ct=a+o;if(e<I&&le>k&&a<N&&ct>Z){const Qt=d.getAttribute("data-filename");Qt&&S.value.add(Qt)}})}function ke(e,a){e.preventDefault(),_.value&&(a&&!S.value.has(a.name)?(E.value=a.name,S.value.clear()):a||(E.value="",S.value.clear()),X.value=a,kt.value=e.clientX,_t.value=e.clientY,Je.value=!0)}function _e(){Je.value=!1,X.value=null}function Nt(e){te.value=e,et.value=`Delete ${e.is_directory?"Folder":"File"}`,tt.value=`Are you sure you want to delete "${e.display_name}"?${e.is_directory?" This will delete all contents.":""}`,ee.value=!0}async function Xa(){if(!te.value&&S.value.size>0){const e=Array.from(S.value);let a=0,t=0;for(const o of e)try{await L.post("/api/appdrive/delete",{container:_.value,mount:$.value,file:o},{headers:{"X-HomeDock-CSRF-Token":Y.value}}),a++}catch{t++}a>0&&C.success(`Deleted ${a} item${a>1?"s":""}`),t>0&&C.error(`Failed to delete ${t} item${t>1?"s":""}`),S.value.clear(),await M(w.value),ee.value=!1;return}if(te.value)try{await L.post("/api/appdrive/delete",{container:_.value,mount:$.value,file:te.value.name},{headers:{"X-HomeDock-CSRF-Token":Y.value}}),C.success(`Deleted ${te.value.display_name}`),await M(w.value)}catch(e){C.error(e.response?.data?.error||"Failed to delete")}finally{ee.value=!1,te.value=null}}async function Ot(){if(!ce.value.trim()){C.error("Please enter a folder name");return}try{await L.post("/api/appdrive/create-folder",{container:_.value,mount:$.value,name:ce.value.trim(),path:w.value},{headers:{"X-HomeDock-CSRF-Token":Y.value}}),C.success(`Created folder "${ce.value}"`),ce.value="",O.value=!1,await M(w.value)}catch(e){C.error(e.response?.data?.error||"Failed to create folder")}}function qt(e){Ze.value=e,ae.value=e.display_name,ye.value=!0}async function Vt(){if(!Ze.value||!ae.value.trim()){C.error("Please enter a new name");return}try{await L.post("/api/appdrive/rename",{container:_.value,mount:$.value,old_name:Ze.value.name,new_name:ae.value.trim()},{headers:{"X-HomeDock-CSRF-Token":Y.value}}),C.success(`Renamed to "${ae.value}"`),ye.value=!1,Ze.value=null,ae.value="",await M(w.value)}catch(e){C.error(e.response?.data?.error||"Failed to rename")}}function La(){fe.value=fe.value==="asc"?"desc":"asc"}function Ya(){Q.value=Q.value==="grid"?"list":"grid"}function Wt(e){if(e.is_directory)return ie;const a=e.display_name.split(".").pop()?.toLowerCase()||"",t=["jpg","jpeg","png","gif","bmp","webp","svg","ico"],o=["mp4","mkv","avi","mov","wmv","flv","webm"],i=["mp3","wav","ogg","flac","aac","wma","m4a"],c=["zip","rar","7z","tar","gz","bz2","xz"],d=["js","ts","py","java","c","cpp","h","go","rs","rb","php","html","css","scss","vue","jsx","tsx","json","xml","yaml","yml","sh","bash","sql"],m=["doc","docx"],k=["xls","xlsx","csv"],Z=["ppt","pptx"],I=["txt","md","log","ini","conf","cfg"];return t.includes(a)?tn:o.includes(a)?an:i.includes(a)?nn:c.includes(a)?He:d.includes(a)?on:m.includes(a)?sn:k.includes(a)?ln:Z.includes(a)?rn:I.includes(a)?un:cn}function Gt(e){if(e===0)return"0 B";const a=1024,t=["B","KB","MB","GB","TB"],o=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,o)).toFixed(2))+" "+t[o]}function ja(e){if(e===0)return"0B";const a=1024,t=["B","K","M","G","T"],o=Math.floor(Math.log(e)/Math.log(a));return parseFloat((e/Math.pow(a,o)).toFixed(1))+t[o]}function je(e){const t=Date.now()/1e3-e.modified;return t<60?"Just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:""}return(e,a)=>(p(),v("div",{class:"app-appdrive flex flex-col h-full overflow-hidden",onDragenter:Ia,onDragleave:za,onDragover:a[18]||(a[18]=pe(()=>{},["prevent"])),onDrop:pe(Ra,["prevent","stop"])},[u(de,{name:"dragger-fade"},{default:g(()=>[$e.value&&!U.value?(p(),v("div",kn,[l("div",{class:r([[n(s).scopeSelector,n(s).dropZoneDragHolder],"fullscreen-dragger h-full border-2 border-dashed rounded-lg flex items-center justify-center"])},[l("div",_n,[l("p",Sn,[u(n(y),{icon:n(ft),class:r([[n(s).dropZoneDragIcon],"text-5xl w-16 h-16"])},null,8,["icon","class"])]),l("p",{class:r([[n(s).dropZoneDragUpText],"px-4 text-balance text-center text-lg font-semibold mt-4"])},"Drop files or folders to upload to "+b(St.value),3),l("p",{class:r([[n(s).dropZoneDragDownText],"px-4 text-balance text-center text-sm mt-2"])},"Folders will maintain their structure.",2),l("p",{class:r([[n(s).dropZoneDragDownText],"px-4 text-balance text-center text-sm mt-1"])},"Hidden files (.*) are automatically filtered.",2)])],2)])):h("",!0)]),_:1}),l("div",Cn,[l("div",Tn,[l("div",Fn,[l("div",Dn,[u(n(xt),{value:_.value,"onUpdate:value":a[0]||(a[0]=t=>_.value=t),class:r([[n(s).scopeSelector,n(s).dropZoneSortSelect],"appdrive-container-select h-8 flex-1 rounded-md min-w-[180px] transition duration-150"]),"popup-class-name":`${n(s).scopeSelector} appdrive-container-dropdown`,"show-search":!1,placeholder:"Select an application",onChange:a[1]||(a[1]=t=>st(t)),loading:De.value},{suffixIcon:g(()=>[u(n(y),{icon:n(Ka),class:"w-4 h-4"},null,8,["icon"])]),default:g(()=>[(p(!0),v(z,null,V(at.value,t=>(p(),Se(n(Te),{key:t.name,value:t.name},{default:g(()=>[l("div",$n,[l("div",Mn,[u(Kt,{src:oe(t.name).iconPath,alt:oe(t.name).displayName,class:"w-4 h-4 rounded",draggable:"false"},null,8,["src","alt"]),l("span",{class:r([[t.status==="running"?"bg-green-500":"bg-gray-400"],"absolute -bottom-0.5 -right-0.5 w-1.5 h-1.5 rounded-full ring-1 ring-black/20"])},null,2)]),l("span",In,b(oe(t.name).displayName),1),l("span",zn,"("+b(t.mounts_count)+" mount"+b(t.mounts_count>1?"s":"")+")",1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value","class","popup-class-name","loading"]),P.value.length>1?(p(),Se(n(xt),{key:0,value:$.value,"onUpdate:value":a[2]||(a[2]=t=>$.value=t),class:r([[n(s).scopeSelector,n(s).dropZoneSortSelect],"appdrive-mount-select h-8 flex-1 rounded-md min-w-[200px] transition duration-150"]),"popup-class-name":`${n(s).scopeSelector} appdrive-mount-dropdown`,"show-search":!1,placeholder:"Select mount",onChange:wa},{suffixIcon:g(()=>[u(n(y),{icon:n(ie),class:"w-4 h-4"},null,8,["icon"])]),default:g(()=>[(p(!0),v(z,null,V(P.value,(t,o)=>(p(),Se(n(Te),{key:o,value:o},{default:g(()=>[l("div",En,[u(n(y),{icon:t.read_only?n(aa):n(ie),class:"w-3 h-3 flex-shrink-0"},null,8,["icon"]),l("span",Rn,b(t.container_path),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["value","class","popup-class-name"])):h("",!0)]),l("div",Zn,[u(n(xt),{value:Qe.value,"onUpdate:value":a[3]||(a[3]=t=>Qe.value=t),class:r([[n(s).scopeSelector,n(s).dropZoneSortSelect],"appdrive-sort-select h-8 flex-1 rounded-md min-w-[140px] transition duration-150"]),"popup-class-name":`${n(s).scopeSelector}`,"show-search":!1},{suffixIcon:g(()=>[u(n(y),{icon:n(dn),class:"w-4 h-4"},null,8,["icon"])]),default:g(()=>[u(n(Te),{value:"name"},{default:g(()=>[...a[19]||(a[19]=[re("Sort by Name",-1)])]),_:1}),u(n(Te),{value:"size"},{default:g(()=>[...a[20]||(a[20]=[re("Sort by Size",-1)])]),_:1}),u(n(Te),{value:"date"},{default:g(()=>[...a[21]||(a[21]=[re("Sort by Date",-1)])]),_:1})]),_:1},8,["value","class","popup-class-name"]),l("button",{onClick:La,class:r([[n(s).dropZoneSortButton],"px-2 py-1 border rounded-md transition-colors h-8 flex items-center justify-center flex-shrink-0"]),title:fe.value==="asc"?"Sort Ascending":"Sort Descending"},[u(n(y),{icon:fe.value==="asc"?n(pn):n(vn),class:"w-4 h-4"},null,8,["icon"])],10,Pn),l("button",{onClick:Ya,class:r([[n(s).dropZoneSortButton],"px-2 py-1 border rounded-md transition-colors h-8 flex items-center justify-center flex-shrink-0"]),title:Q.value==="grid"?"Switch to List View":"Switch to Grid View"},[u(n(y),{icon:Q.value==="grid"?n(fn):n(mn),class:"w-4 h-4"},null,8,["icon"])],10,Un),l("button",{onClick:lt,class:r([[n(s).dropZoneSortButton],"px-2 py-1 border rounded-md transition-colors h-8 flex items-center justify-center flex-shrink-0"]),title:"Refresh"},[u(n(y),{icon:n(vt),class:r([{"animate-spin":ve.value},"w-4 h-4"])},null,8,["icon","class"])],2)])]),u(de,{name:"breadcrumb-slide"},{default:g(()=>[w.value?(p(),v("div",Bn,[l("button",{onClick:_a,class:r([[n(s).dropZoneSortButton],"px-2 py-0.5 rounded hover:opacity-80 transition-opacity flex items-center gap-1"])},[u(n(y),{icon:n(yn),class:"w-3 h-3"},null,8,["icon"]),a[22]||(a[22]=l("span",null,"Root",-1))],2),(p(!0),v(z,null,V(Ct.value,(t,o)=>(p(),v(z,{key:o},[u(n(y),{icon:n(Ja),class:r([[n(s).dropZoneFileIcon],"w-3 h-3 opacity-50"])},null,8,["icon","class"]),l("button",{onClick:i=>Sa(o),class:r([[n(s).dropZoneSortButton],"px-2 py-0.5 rounded hover:opacity-80 transition-opacity truncate max-w-[150px]"])},b(t),11,Xn)],64))),128))])):h("",!0)]),_:1}),l("div",Ln,[l("span",{class:r([[n(s).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5"])},b(D.value.length)+" "+b(D.value.length===1?"item":"items"),3),Dt.value!=="0 B"&&D.value.length>0?(p(),v("span",{key:0,class:r([[n(s).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5"])},b(Dt.value)+" total ",3)):h("",!0),U.value?(p(),v("span",{key:1,class:r([[n(s).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5 flex items-center gap-1"])},[u(n(y),{icon:n(aa),class:"w-3 h-3"},null,8,["icon"]),a[23]||(a[23]=re(" Read-only ",-1))],2)):h("",!0),We.value?(p(),v("span",{key:2,class:r([[n(s).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5 opacity-60 truncate max-w-[200px]"]),title:We.value},b(We.value),11,Yn)):h("",!0)]),l("div",{ref_key:"containerRef",ref:K,class:"view-mode-container flex-1 overflow-auto",onMousedown:Ua,onContextmenu:a[6]||(a[6]=t=>ke(t,null)),onTouchstart:Ca,onTouchmove:Ta,onTouchend:Bt,onTouchcancel:Bt},[_.value?_.value?(p(),Se(de,{key:1,name:Q.value==="grid"?"view-mode-fade":"list-view-fade",mode:"out-in"},{default:g(()=>[Q.value==="grid"?(p(),v("div",{key:"grid-view",class:"appdrive-icons-container relative w-full select-none",style:W({height:`${da.value}px`})},[A.value?(p(),v("div",{key:0,class:"absolute pointer-events-none z-[100] border-2 border-blue-500 bg-blue-500/20",style:W(Ft.value)},null,4)):h("",!0),D.value.length===0&&!w.value&&!ve.value?(p(),v("div",Nn,[u(n(yt),{class:r([n(s).dropZoneEmptyText]),description:U.value?"This mount is empty":"This mount is empty. Drag and drop files to upload."},null,8,["class","description"])])):h("",!0),u(pt,{name:"file-item"},{default:g(()=>[(p(!0),v(z,null,V(nt.value,t=>(p(),v(z,{key:t.name},[t.name==="__back__"?(p(),v("div",{key:0,style:W({position:"absolute",left:`${t.x}px`,top:`${t.y}px`}),onClick:Zt,onContextmenu:a[4]||(a[4]=pe(()=>{},["prevent"])),class:r(["group flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg appdrive-file-item","transition-[background,transform,border] duration-150","w-[100px] h-[120px]",n(s).desktopIconBg||"hover:bg-white/5"])},[l("div",{class:r(["relative w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl",n(s).desktopIconContainerBg||"bg-white/10","transition-transform duration-200 group-hover:scale-105"])},[u(n(y),{icon:n(ta),class:r([[n(s).dropZoneFileIcon],"h-10 w-10"])},null,8,["icon","class"])],2),l("span",{class:r([[n(s).dropZoneFileText],"text-[11px] leading-tight text-center"])},"..",2)],38)):(p(),v("div",{key:1,"data-filename":t.name,style:W({position:"absolute",left:`${t.x}px`,top:`${t.y}px`}),class:r(["group flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg appdrive-file-item","transition-[background,transform,border] duration-150","w-[100px] h-[120px] border",E.value===t.name||S.value.has(t.name)?[n(s).desktopIconBgSelected||"bg-blue-500/20",n(s).desktopIconBorderSelected||"border-blue-500"]:["border-transparent",n(s).desktopIconBg||"hover:bg-white/5"]]),onClick:o=>rt(t,o),onContextmenu:pe(o=>ke(o,t),["stop"]),onTouchstart:o=>Pt(t,o),onTouchmove:Ut,onTouchend:o=>Xe(t),onTouchcancel:o=>Xe(t)},[l("div",{class:r(["relative w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl",n(s).desktopIconContainerBg||"bg-white/10","transition-transform duration-200 group-hover:scale-105",(E.value===t.name||S.value.has(t.name))&&(n(s).desktopIconContainerBgSelected||"bg-blue-500/30")])},[!t.is_directory&&t.size>0?(p(),v("div",{key:0,class:r([[n(s).dropZoneFileSize],"absolute -left-1 -top-1 text-[8px] font-medium px-1 py-0.5 rounded whitespace-nowrap z-10"])},b(ja(t.size)),3)):h("",!0),je(t)?(p(),v("div",qn,[l("div",{class:r([[n(s).dropZoneFileSize],"text-[8px] font-medium px-1 py-0.5 rounded whitespace-nowrap"])},b(je(t)),3)])):h("",!0),B.value.has(t.name)?(p(),v("div",Vn,[u(n(y),{icon:n(He),class:r([[n(s).dropZoneLockIcon],"h-4 w-4"])},null,8,["icon","class"])])):h("",!0),u(n(y),{icon:Wt(t),class:r([[n(s).dropZoneFileIcon,B.value.has(t.name)?"opacity-40":""],"h-10 w-10 transition duration-300 group-hover:scale-110"])},null,8,["icon","class"]),B.value.has(t.name)?(p(),v("div",Wn,[u(n(y),{icon:n(Jt),class:r([[n(s).dropZoneLockIcon],"h-7 w-7 animate-spin"])},null,8,["icon","class"])])):h("",!0)],2),l("span",{class:r([[n(s).dropZoneFileText],"text-[11px] leading-tight text-center line-clamp-2 w-full px-1 break-words"]),title:t.display_name},b(t.display_name),11,Gn),j.value[t.name]!==void 0&&j.value[t.name]<100?(p(),v("div",Qn,[u(n(gt),{percent:j.value[t.name],class:r([[n(s).scopeSelector],"h-1 rounded-full"]),"show-info":!1,size:2,status:"active"},null,8,["percent","class"])])):h("",!0)],46,On))],64))),128))]),_:1})],4)):(p(),v("div",{key:`list-view-${w.value}`,class:"appdrive-list-container w-full select-none"},[A.value?(p(),v("div",{key:0,class:"absolute pointer-events-none z-[100] border-2 border-blue-500 bg-blue-500/20",style:W(Ft.value)},null,4)):h("",!0),D.value.length===0&&!w.value&&!ve.value?(p(),v("div",Kn,[u(n(yt),{class:r([n(s).dropZoneEmptyText]),description:U.value?"This mount is empty":"This mount is empty. Drag and drop files to upload."},null,8,["class","description"])])):h("",!0),u(pt,{name:"file-item-list"},{default:g(()=>[w.value?(p(),v("div",{key:"back-button",onClick:Zt,onContextmenu:a[5]||(a[5]=pe(()=>{},["prevent"])),class:r(["group flex items-center gap-3 cursor-pointer px-2 py-1.5 rounded transition-colors appdrive-file-item",n(s).desktopIconBg||"hover:bg-white/5"])},[l("div",Jn,[l("div",eo,[u(n(y),{icon:n(ta),class:r([[n(s).dropZoneFileIcon],"h-5 w-5"])},null,8,["icon","class"])])]),l("span",{class:r([[n(s).dropZoneFileText],"text-xs"])},"..",2)],34)):h("",!0),(p(!0),v(z,null,V(Tt.value,t=>(p(),v("div",{key:t.name,"data-filename":t.name,class:r(["group relative flex items-center gap-3 cursor-pointer px-2 py-1.5 rounded transition-colors appdrive-file-item overflow-hidden",E.value===t.name||S.value.has(t.name)?[n(s).desktopIconBgSelected||"bg-blue-500/20"]:[n(s).desktopIconBg||"hover:bg-white/5"]]),onClick:o=>rt(t,o),onContextmenu:pe(o=>ke(o,t),["stop"]),onTouchstart:o=>Pt(t,o),onTouchmove:Ut,onTouchend:o=>Xe(t),onTouchcancel:o=>Xe(t)},[j.value[t.name]!==void 0&&j.value[t.name]<100?(p(),v("div",{key:0,class:"absolute inset-0 bg-blue-500/20 transition-all duration-300 ease-out",style:W({width:`${j.value[t.name]}%`})},null,4)):h("",!0),l("div",ao,[l("div",no,[u(n(y),{icon:Wt(t),class:r([[n(s).dropZoneFileIcon,B.value.has(t.name)?"opacity-40":""],"h-5 w-5"])},null,8,["icon","class"]),B.value.has(t.name)?(p(),v("div",oo,[u(n(y),{icon:n(Jt),class:r([[n(s).dropZoneLockIcon],"h-4 w-4 animate-spin"])},null,8,["icon","class"])])):h("",!0),B.value.has(t.name)?(p(),v("div",so,[u(n(y),{icon:n(He),class:r([[n(s).dropZoneLockIcon],"h-3 w-3"])},null,8,["icon","class"])])):h("",!0)])]),l("div",lo,[l("span",{class:r([[n(s).dropZoneFileText],"text-xs truncate block"]),title:t.display_name},b(t.display_name),11,ro)]),t.is_directory?h("",!0):(p(),v("div",{key:1,class:r([[n(s).dropZoneFileSize],"list-view-size text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},b(Gt(t.size)),3)),je(t)?(p(),v("div",{key:2,class:r([[n(s).dropZoneFileSize],"list-view-time text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},b(je(t)),3)):h("",!0)],42,to))),128))]),_:1})]))]),_:1},8,["name"])):h("",!0):(p(),v("div",{key:0,class:"appdrive-container-picker relative w-full select-none",style:W({height:`${pa.value}px`})},[u(pt,{name:"container-icon"},{default:g(()=>[(p(!0),v(z,null,V(ot.value,(t,o)=>(p(),v("div",{key:t.name,onClick:i=>ya(t.name),style:W({position:"absolute",left:`${t.x}px`,top:`${t.y}px`,"--stagger-index":o}),class:r(["group flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg border border-transparent","transition-[background,transform,border,box-shadow] duration-150","w-[100px] h-[120px] select-none","hover:-translate-y-0.5",n(s).desktopIconBg||"hover:bg-white/5"])},[l("div",An,[l("div",{class:r(["relative w-16 h-16 flex items-center justify-center rounded-2xl overflow-hidden border border-transparent","transition-[background,transform,border-color] duration-150",n(s).desktopIconContainerBg,n(s).desktopIconContainerBgHover])},[u(Kt,{src:oe(t.name).iconPath,alt:oe(t.name).displayName,class:"w-12 h-12 object-contain rounded-xl",draggable:"false"},null,8,["src","alt"]),l("span",{class:r([[t.status==="running"?"bg-green-500":"bg-gray-400",n(s).desktopStatusBadgeBorder],"absolute bottom-1 right-1 w-3 h-3 rounded-full"])},null,2)],2),l("div",{class:r([[n(s).dropZoneFileSize],"absolute -top-1 -right-1 w-5 h-5 flex items-center justify-center rounded-full z-10"])},[u(n(y),{icon:n(ie),class:"w-3.5 h-3.5"},null,8,["icon"])],2)]),l("span",{class:r([[n(s).desktopIconText],"text-xs text-center max-w-full overflow-hidden text-ellipsis whitespace-nowrap font-medium"])},b(oe(t.name).displayName),3)],14,jn))),128))]),_:1}),at.value.length===0&&!De.value?(p(),v("div",Hn,[u(n(yt),{class:r([n(s).dropZoneEmptyText]),description:"No containers with accessible mounts found"},null,8,["class"])])):h("",!0)],4))],544)])]),u(en,{visible:Je.value,x:kt.value,y:_t.value,items:ma.value,onClose:_e},null,8,["visible","x","y","items"]),u(Ne,{visible:ee.value,"onUpdate:visible":a[7]||(a[7]=t=>ee.value=t),type:"confirm",title:et.value,content:tt.value,"ok-text":"Delete","cancel-text":"Cancel",onOk:Xa,onCancel:a[8]||(a[8]=t=>ee.value=!1)},null,8,["visible","title","content"]),u(Ne,{visible:O.value,"onUpdate:visible":a[10]||(a[10]=t=>O.value=t),type:"info",title:"Create New Folder","ok-text":"Create","cancel-text":"Cancel",onOk:Ot,onCancel:a[11]||(a[11]=t=>O.value=!1),icon:n(Ce)},{default:g(()=>[l("div",io,[l("label",{class:r([[n(s).notTextDown],"text-sm block mb-2"])},"Folder name (max 255 characters)",2),u(n(na),{value:ce.value,"onUpdate:value":a[9]||(a[9]=t=>ce.value=t),placeholder:"Enter folder name...",onPressEnter:Ot,class:r([[n(s).scopeSelector,n(s).loginFormInput],"h-10"]),autofocus:"",maxlength:255},{prefix:g(()=>[u(n(y),{icon:n(ie),class:r([[n(s).formIcon],"mr-0.5 transition duration-300"]),width:"16",height:"16"},null,8,["icon","class"])]),_:1},8,["value","class"])])]),_:1},8,["visible","icon"]),u(Ne,{visible:ye.value,"onUpdate:visible":a[13]||(a[13]=t=>ye.value=t),type:"info",title:"Rename Item","ok-text":"Rename","cancel-text":"Cancel",onOk:Vt,onCancel:a[14]||(a[14]=t=>ye.value=!1),icon:n(Oe)},{default:g(()=>[l("div",uo,[l("label",{class:r([[n(s).notTextDown],"text-sm block mb-2"])},"New name (max 255 characters)",2),u(n(na),{value:ae.value,"onUpdate:value":a[12]||(a[12]=t=>ae.value=t),placeholder:"Enter new name...",onPressEnter:Vt,class:r([[n(s).scopeSelector,n(s).loginFormInput],"h-10"]),autofocus:"",maxlength:255},{prefix:g(()=>[u(n(y),{icon:n(Oe),class:r([[n(s).formIcon],"mr-0.5 transition duration-300"]),width:"16",height:"16"},null,8,["icon","class"])]),_:1},8,["value","class"])])]),_:1},8,["visible","icon"]),u(Ne,{visible:we.value,"onUpdate:visible":a[15]||(a[15]=t=>we.value=t),type:"info",title:"Folder Upload Detected","ok-text":"Upload Folder","cancel-text":"Cancel",onOk:Za,onCancel:Pa,icon:n(ie),width:480,"reverse-buttons":!0},{default:g(()=>[l("div",co,[l("p",{class:r([[n(s).notTextDown],"text-sm leading-relaxed"])},[a[24]||(a[24]=re(" You are about to upload ",-1)),l("strong",null,b(ne.value?.allFiles.length||0)+" files",1),a[25]||(a[25]=re(" across ",-1)),l("strong",null,b(ne.value?.folders.length||0)+" directories",1),a[26]||(a[26]=re(". ",-1))],2),l("p",{class:r([[n(s).notTextDown],"text-sm leading-relaxed"])},"The folder structure will be preserved inside the container's volume.",2)])]),_:1},8,["visible","icon"]),u(de,{name:"upload-slide-up"},{default:g(()=>[_.value&&!U.value?(p(),Se(n(bn),{key:0,fileList:me.value,"onUpdate:fileList":a[16]||(a[16]=t=>me.value=t),name:"file",multiple:!0,customRequest:$a,onChange:Ma,showUploadList:!1,class:"fixed bottom-10 right-2 z-50 hidden max-[900px]:block"},{default:g(()=>[l("button",{class:r([[n(s).dropZoneSortButton],"w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-transform duration-300 active:scale-95 border-none cursor-pointer"]),title:"Upload Files"},[u(n(y),{icon:n(xn),class:"w-6 h-6"},null,8,["icon"])],2)]),_:1},8,["fileList"])):h("",!0)]),_:1}),u(de,{name:"upload-slide-up"},{default:g(()=>[n(T).isUploading?(p(),v("div",{key:0,class:r(["border-t",[n(s).dropZoneDragHolder,n(s).scopeSelector]])},[l("div",{class:r([n(s).hrSelector])},null,2),l("div",{onClick:a[17]||(a[17]=t=>ge.value=!ge.value),class:"flex items-center gap-2 h-7 pb-0.5 px-3 cursor-pointer hover:opacity-80 transition-opacity"},[l("div",po,[(p(),v("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",class:r([[n(s).dropZoneDragIcon],"flex-shrink-0"])},[...a[27]||(a[27]=[l("rect",{width:"24",height:"24",fill:"none"},null,-1),l("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.3"},[l("path",{"stroke-dasharray":"2 4","stroke-dashoffset":"6",d:"M12 21c-4.97 0 -9 -4.03 -9 -9c0 -4.97 4.03 -9 9 -9"},[l("animate",{attributeName:"stroke-dashoffset",dur:"0.6s",repeatCount:"indefinite",values:"6;0"})]),l("path",{"stroke-dasharray":"32","stroke-dashoffset":"32",d:"M12 3c4.97 0 9 4.03 9 9c0 4.97 -4.03 9 -9 9"},[l("animate",{fill:"freeze",attributeName:"stroke-dashoffset",begin:"0.1s",dur:"0.4s",values:"32;0"})]),l("path",{"stroke-dasharray":"10","stroke-dashoffset":"10",d:"M12 16v-7.5"},[l("animate",{fill:"freeze",attributeName:"stroke-dashoffset",begin:"0.5s",dur:"0.2s",values:"10;0"})]),l("path",{"stroke-dasharray":"6","stroke-dashoffset":"6",d:"M12 8.5l3.5 3.5M12 8.5l-3.5 3.5"},[l("animate",{fill:"freeze",attributeName:"stroke-dashoffset",begin:"0.7s",dur:"0.2s",values:"6;0"})])],-1)])],2)),l("span",{class:r([[n(s).dropZoneDragUpText],"text-[10px] leading-none truncate"])},b(xe.value)+" of "+b(ue.value),3)]),l("div",vo,[u(n(gt),{percent:ca.value,class:r([[n(s).scopeSelector],"rounded-full flex-1"]),"show-info":!1,size:2,status:"active"},null,8,["percent","class"])]),u(n(y),{icon:n(gn),class:r([[n(s).dropZoneFileIcon,"transition-transform duration-200",ge.value&&"rotate-180"],"w-3.5 h-3.5 flex-shrink-0"])},null,8,["icon","class"])]),u(de,{name:"expand-height"},{default:g(()=>[ge.value?(p(),v("div",{key:0,class:r([n(s).dropZoneFileDisplayer])},[l("div",{class:r([n(s).hrSelector])},null,2),l("div",fo,[(p(!0),v(z,null,V(n(T).currentlyUploading,(t,o)=>(p(),v(z,{key:t.uid},[l("div",mo,[l("div",ho,[u(n(y),{icon:n(ea),class:r([[n(s).dropZoneFileIcon],"w-3.5 h-3.5 flex-shrink-0"])},null,8,["icon","class"]),l("div",xo,[l("div",go,[l("p",{class:r([[n(s).dropZoneFileText],"text-[11px] font-medium truncate flex-1"]),title:t.name},b(t.name),11,yo),l("span",{class:r([[n(s).dropZoneFileSize],"text-[9px] font-semibold px-1 rounded whitespace-nowrap"])},b(n(T).uploadProgress[t.uid]||0)+"% ",3)]),u(n(gt),{percent:n(T).uploadProgress[t.uid]||0,class:r([[n(s).scopeSelector],"rounded-full"]),"show-info":!1,size:1.5,status:"active"},null,8,["percent","class"])])])]),o<n(T).currentlyUploading.length-1||n(T).queue.length>0?(p(),v("div",{key:0,class:r([n(s).hrSelector])},null,2)):h("",!0)],64))),128)),(p(!0),v(z,null,V(n(T).queue.slice(0,3),(t,o)=>(p(),v(z,{key:t.uid},[l("div",wo,[l("div",bo,[u(n(y),{icon:n(ea),class:r([[n(s).dropZoneFileIcon],"w-3.5 h-3.5 flex-shrink-0"])},null,8,["icon","class"]),l("div",ko,[l("p",{class:r([[n(s).dropZoneFileText],"text-[11px] truncate flex-1"]),title:t.name},b(t.name),11,_o),l("span",{class:r([[n(s).dropZoneFileSize],"text-[9px] font-medium px-1 rounded whitespace-nowrap"])}," Waiting... ",2)])])]),o<Math.min(2,n(T).queue.length-1)?(p(),v("div",{key:0,class:r([n(s).hrSelector])},null,2)):h("",!0)],64))),128)),n(T).queue.length>3?(p(),v(z,{key:0},[l("div",{class:r([n(s).hrSelector])},null,2),l("div",So,[l("span",{class:r([[n(s).dropZoneFilesCount],"text-[9px] opacity-60"])}," And "+b(n(T).queue.length-3)+" more in queue... ",3)])],64)):h("",!0)])],2)):h("",!0)]),_:1})],2)):h("",!0)]),_:1}),u(hn,{visible:ze.value,message:bt.value,position:"bottom-left"},null,8,["visible","message"]),u(wn,{icon:n(ft),message:va.value,info:fa.value,showHelp:!0},{help:g(()=>[l("div",Co,[l("div",To,[u(n(y),{icon:n(ft),class:r(["w-5 h-5",n(s).statusBarIcon])},null,8,["icon","class"]),l("h4",{class:r(["text-base font-semibold",n(s).statusBarText])},"App Drive",2)]),l("div",{class:r(["text-[10px] md:text-xs space-y-2 leading-relaxed",n(s).statusBarInfo])},[...a[28]||(a[28]=[l("p",null,"Access and manage files stored in your applications volumes. Browse, upload, download, and organize files directly within the application mapped directories. Only volumes mounted within HomeDock OS data directory are accessible for security.",-1)])],2)])]),_:1},8,["icon","message","info"])],32))}}),is=qa($o,[["__scopeId","data-v-c8e12b7f"]]);export{is as default};
