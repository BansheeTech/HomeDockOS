import{j as J,B as K,d as ee,r as v,w as se,v as ae,y as p,A as r,z as a,F as n,H as l,u as e,M as u,E as b,X as te,G as C,D as d,C as k,Y as f,T as V,R as H,U as z,am as le,I as oe,W as ne,_ as ie}from"./hdos_CuoKFWGhtyMD6PE8b4uue.js";import{d as E,a as $}from"./hdos_DaRSEFpqf81ZuDgc4Rzsj.js";import{u as re,f as de,g as ce,P as N,y as ue}from"./hdos_f94pyex3GDMwQi9LcD0ex.js";import{d as pe}from"./hdos_Cz8Dwn1iOWea_GVqOHEOb.js";import{d as me}from"./hdos_R8ecdjzHoP22_qvuHhYVs.js";import{d as ve}from"./hdos_Cc8duC1RfUFCANHn9wXj9.js";import{d as F}from"./hdos_DPhlMBAcwmj4N6C-RIU0v.js";import{_ as fe}from"./hdos_vkkUrw9q2ozTqNHWlgeXU.js";import{B as h}from"./hdos_CK6APKN_fpo7zBLtiD9_X.js";import{I as he}from"./hdos_OvxWivFhonp-M_fitEM0p.js";import{I as P}from"./hdos_BwRDsNqOVoAWf8ZWDrgHa.js";import{S as xe,c as D}from"./hdos_4Qnbzskjpe7Ggdp042ipA.js";import{S as ge}from"./hdos_CUoe_PL_Y2Dbz-3JLGIxN.js";import"./hdos_BKPjeHGrzS47kEPOz-apr.js";import"./hdos_DaPixzywKmld_Ur82K_nj.js";import"./hdos_Dz3aTMQqM4LnOlKzV3COc.js";import"./hdos_itWSuQ2oYLgMGq-Z_V6WL.js";import"./hdos_CE1G-McAXm7G2-tH-xmrF.js";import"./hdos_BTjx4GUb_InXPN5k1Yckl.js";import"./hdos_DSogZ-918WAgvhujrpekz.js";import"./hdos_vuT7H-UC-v8aszDwotiDB.js";import"./hdos_efL_TdV8_G1tTDjV4v1UY.js";import"./hdos_7CrY5sx-657icNlWtqSaX.js";import"./hdos_DgJekFBgcpglmuoknSED_.js";import"./hdos_S_iDkipMBOYto75eroFcN.js";import"./hdos_D63Tfrq7hZ9D-jbqbBA6V.js";import"./hdos_COQlkY9-pJTnMoWfbgtHP.js";const _e={width:24,height:24,body:'<path fill="currentColor" d="m12.89 3l1.96.4L11.11 21l-1.96-.4L12.89 3m6.7 9L16 8.41V5.58L22.42 12L16 18.41v-2.83L19.59 12M1.58 12L8 5.58v2.83L4.41 12L8 15.58v2.83L1.58 12Z"/>'},ye={width:24,height:24,body:'<path fill="currentColor" d="M20 12a8 8 0 0 0-8-8a8 8 0 0 0-8 8a8 8 0 0 0 8 8a8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12A10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5S7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5S14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/>'},O={width:24,height:24,body:'<path fill="currentColor" d="M19 4h-3.5l-1-1h-5l-1 1H5v2h14M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12Z"/>'},be={class:"app-install-config h-full flex flex-col overflow-hidden",style:{"container-type":"inline-size","container-name":"window"}},ke={key:0,class:"flex-1 flex items-center justify-center"},we={class:"text-center"},Se={key:1,class:"flex flex-col h-full overflow-hidden"},Ce={class:"flex-1 overflow-y-auto"},Ie={class:"flex items-center gap-4 mb-4"},Ae={class:"relative flex-shrink-0 group"},Te={class:"flex-1 min-w-0"},Le={class:"flex items-center gap-2 flex-wrap text-xs"},Be={class:"action-buttons flex items-center gap-2"},Me=["href"],$e={class:"flex-shrink-0"},Ne={class:"flex items-center"},Fe={class:"flex items-center"},Pe={class:"px-4 md:px-6 lg:px-8 py-5"},De={class:"mb-6"},Ue={key:"simple"},je={key:0,class:"mb-6"},Ve={class:"space-y-3"},He={class:"mb-6"},ze={class:"flex items-center justify-between mb-3"},Ee={class:"space-y-2"},Oe={class:"mb-6"},Re={class:"flex items-center justify-between mb-3"},Xe={class:"space-y-2"},Ze={class:"mb-6"},qe={key:"advanced"},Qe=["disabled"],Ge={class:"space-y-2.5 max-w-sm"},We={class:"flex items-center gap-2"},Ye=J({__name:"AppInstallConfig",props:{app:{}},setup(R){const I=R,{themeClasses:s}=K(),X=re(),B=de(),o=ee(()=>I.app?.name&&X.apps.find(t=>t.name===I.app?.name)||I.app),w=v(!1),x=v([]),g=v([]),A=v("unless-stopped"),T=v(""),_=v(void 0),y=v(void 0),M=v(!1),L=v(!1),U=ce();async function j(){if(!(!o.value?.name||L.value)){L.value=!0;try{const i=await $.get("/api/get-appstore-info",{params:{containerName:o.value.name},headers:{"X-HomeDock-CSRF-Token":U.value}});i.data?.success?(x.value=i.data.data.ports||[],g.value=i.data.data.volumes||[],T.value=i.data.data.ymlContent||"",A.value="unless-stopped",_.value=i.data.data.user_name||void 0,y.value=i.data.data.password||void 0,M.value=i.data.data.ssl_enabled||!1):(console.error("Failed to fetch app info:",i.data.message),L.value=!1)}catch(i){console.error("Error fetching app info:",i),L.value=!1}}}function Z(){x.value.push("")}function q(i){x.value.splice(i,1)}function Q(){g.value.push("")}function G(i){g.value.splice(i,1)}function W(i,t){w.value=!!i}async function Y(){if(o.value?.name)try{const i=U.value,t=w.value?{containerName:o.value.name,configType:"advanced",ymlContent:T.value,homedock_csrf_token:i}:{containerName:o.value.name,configType:"simple",userName:_.value,userPassword:y.value,ports:x.value,volumes:g.value,restartPolicy:A.value,homedock_csrf_token:i},c=await $.post("/api/process-config",t,{headers:{"X-HomeDock-CSRF-Token":i}});if(!c.data.success){console.error(`Failed to process configuration: ${c.data.message}`);return}await B.trackInstallations(i),await $.post("/api/app-store-install-container",{containerName:o.value.name,homedock_csrf_token:i})}catch(i){console.error("Error during installation process:",i)}}return se(o,i=>{i?.name&&j()},{immediate:!0}),ae(()=>{o.value?.name&&j()}),(i,t)=>(r(),p("div",be,[o.value?(r(),p("div",Se,[a("div",Ce,[a("div",{class:l([[e(s).storeContMainer,e(s).aeroExtraScope],"px-4 md:px-6 lg:px-8 py-5"])},[a("div",Ie,[a("div",Ae,[n(te,{draggable:"false",src:o.value?.picture_path||"docker-icons/notfound.jpg",alt:o.value?.name,class:l([[e(s).storeModalImageBack],"w-16 h-16 rounded-xl shadow-md transition ring-[1px] duration-200 group-hover:scale-105"])},null,8,["src","alt","class"]),M.value?(r(),p("div",{key:0,class:l([[e(s).storePopupSSLFlag],"absolute flex items-center justify-center p-1 rounded-full -top-1 -right-1 shadow-sm border"])},[n(e(u),{icon:e(F),class:"h-2.5 w-2.5"},null,8,["icon"])],2)):b("",!0)]),a("div",Te,[a("h1",{class:l([[e(s).storeModalAppName],"text-xl md:text-2xl font-bold mb-1"])},C(o.value?.name),3),a("div",Le,[a("span",{class:l([[e(s).storeModalAppType],"font-medium"])},C(o.value?.type),3),a("span",{class:l([e(s).storeModalAppCategory])},"â€¢",2),a("span",{class:l([e(s).storeModalAppCategory])},C(o.value?.category),3),M.value?(r(),p("div",{key:0,class:l([[e(s).storeTextSSLFlag],"flex items-center"])},[n(e(u),{icon:e(F),class:"mr-1 h-3 w-3"},null,8,["icon"]),t[5]||(t[5]=a("span",{class:"font-medium"},"HTTPS",-1))],2)):b("",!0)])])]),a("div",Be,[n(V,{name:"button-fade",mode:"out-in"},{default:d(()=>[o.value?.is_installed?(r(),k(e(h),{key:"installed",class:l([[e(s).storeButtonInstalled],"action-button-primary flex items-center justify-center"]),type:"default"},{default:d(()=>[n(e(u),{icon:e(pe),class:"mr-1.5"},null,8,["icon"]),t[6]||(t[6]=f(" Installed ",-1))]),_:1},8,["class"])):e(B).currentlyInstalling===o.value?.name?(r(),k(e(h),{key:"installing",class:l([[e(s).storeButtonInstalling],"action-button-primary flex items-center justify-center"]),type:"default"},{default:d(()=>[n(e(u),{icon:e(E),class:"mr-1.5 animate-spin"},null,8,["icon"]),t[7]||(t[7]=f(" Installing... ",-1))]),_:1},8,["class"])):o.value?.name&&e(B).queue.includes(o.value.name)?(r(),k(e(h),{key:"queued",class:l([[e(s).storeButtonQueued],"action-button-primary flex items-center justify-center"]),type:"default"},{default:d(()=>[n(e(u),{icon:e(ve),class:"mr-1.5"},null,8,["icon"]),t[8]||(t[8]=f(" Queued ",-1))]),_:1},8,["class"])):(r(),k(e(h),{class:l([[e(s).storeButtonInstall],"action-button-primary flex items-center justify-center"]),key:"install",type:"primary",onClick:Y},{default:d(()=>[n(e(u),{icon:e(N),class:"mr-1.5"},null,8,["icon"]),t[9]||(t[9]=f(" Install ",-1))]),_:1},8,["class"]))]),_:1}),a("a",{href:`https://www.homedock.cloud/apps/${o.value?.name.toLowerCase()}`,target:"_blank",class:"flex-shrink-0"},[n(e(h),{class:l([[e(s).storeLinkHDOSButton],"flex items-center"]),type:"dashed"},{default:d(()=>[n(e(u),{icon:e(me),class:"w-4 h-4"},null,8,["icon"])]),_:1},8,["class"])],8,Me),a("div",$e,[n(e(ge),{checked:w.value,"onUpdate:checked":t[0]||(t[0]=c=>w.value=c),onChange:W},{checkedChildren:d(()=>[a("span",Ne,[n(e(u),{icon:e(ye),class:"h-4 w-4"},null,8,["icon"]),t[10]||(t[10]=a("span",{class:"text-transparent"},".",-1))])]),unCheckedChildren:d(()=>[a("span",Fe,[n(e(u),{icon:e(_e),class:"h-4 w-4"},null,8,["icon"]),t[11]||(t[11]=a("span",{class:"text-transparent"},".",-1))])]),_:1},8,["checked"])])])],2),a("div",Pe,[a("div",De,[a("p",{class:l([[e(s).storeAboutTextDescScope],"text-sm leading-relaxed mb-3"])},C(o.value?.description+"."||"No description available"),3),o.value?.dependencies&&o.value.dependencies.length>=1?(r(),p("div",{key:0,class:l([[e(s).storeAboutTextDepsScope],"text-xs inline-flex items-center px-2.5 py-1.5 rounded-md"])},[n(e(u),{icon:e(ue),class:"h-3 w-3 mr-1.5"},null,8,["icon"]),a("span",null,C(o.value?.dependencies.concat().join(", ")),1)],2)):b("",!0)]),a("div",{class:l([[e(s).storeSeparator],"h-px mb-6"])},null,2),n(V,{name:"fade-slide",mode:"out-in"},{default:d(()=>[w.value?(r(),p("div",qe,[a("h3",{class:l([[e(s).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider mb-3"])},"Advanced Configuration",2),oe(a("textarea",{disabled:o.value?.is_installed,"onUpdate:modelValue":t[4]||(t[4]=c=>T.value=c),class:l([[e(s).hubTextArea],"flex-1 rounded-lg w-full font-mono text-xs resize-none p-3"]),style:{height:"500px"}},null,10,Qe),[[ne,T.value]])])):(r(),p("div",Ue,[_.value!==void 0||y.value!==void 0?(r(),p("div",je,[a("h3",{class:l([[e(s).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider mb-3"])},"Access Credentials",2),a("div",Ve,[_.value!==void 0?(r(),k(e(P),{key:0,class:l([[e(s).scopeSelector,e(s).loginFormInput],"w-full"]),disabled:o.value?.is_installed,value:_.value,"onUpdate:value":t[1]||(t[1]=c=>_.value=c),placeholder:"Username"},null,8,["class","disabled","value"])):b("",!0),y.value!==void 0?(r(),k(e(he),{key:1,autocomplete:"new-password",class:l([[e(s).scopeSelector,e(s).loginFormInput],"w-full"]),disabled:o.value?.is_installed,value:y.value,"onUpdate:value":t[2]||(t[2]=c=>y.value=c),placeholder:"Password"},null,8,["class","disabled","value"])):b("",!0)])])):b("",!0),a("div",He,[a("div",ze,[a("h3",{class:l([[e(s).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider"])},"Port Mappings",2),n(e(h),{disabled:o.value?.is_installed,type:"link",onClick:Z,size:"small"},{default:d(()=>[...t[12]||(t[12]=[f(" + Add ",-1)])]),_:1},8,["disabled"])]),a("div",Ee,[(r(!0),p(H,null,z(x.value,(c,m)=>(r(),p("div",{key:"port-"+m,class:"flex items-center gap-2"},[n(e(P),{class:l([[e(s).scopeSelector,e(s).loginFormInput],"flex-1"]),disabled:o.value?.is_installed,value:x.value[m],"onUpdate:value":S=>x.value[m]=S,placeholder:"8080:80"},null,8,["class","disabled","value","onUpdate:value"]),n(e(h),{class:l([e(s).storeLinkHDOSButton]),disabled:o.value?.is_installed,type:"dashed",onClick:S=>q(m)},{default:d(()=>[n(e(u),{icon:e(O)},null,8,["icon"])]),_:1},8,["class","disabled","onClick"])]))),128))])]),a("div",Oe,[a("div",Re,[a("h3",{class:l([[e(s).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider"])},"Volume Mounts",2),n(e(h),{disabled:o.value?.is_installed,type:"link",onClick:Q,size:"small"},{default:d(()=>[...t[13]||(t[13]=[f(" + Add ",-1)])]),_:1},8,["disabled"])]),a("div",Xe,[(r(!0),p(H,null,z(g.value,(c,m)=>(r(),p("div",{key:"volume-"+m,class:"flex items-center gap-2"},[n(e(P),{class:l([[e(s).scopeSelector,e(s).loginFormInput],"flex-1"]),disabled:o.value?.is_installed,value:g.value[m],"onUpdate:value":S=>g.value[m]=S,placeholder:"/host:/container"},le({_:2},[c.includes("/DATA/SSLCerts")?{name:"prefix",fn:d(()=>[n(e(u),{icon:e(F),class:l([[e(s).installConfigSSLVolumeIcon],"h-3.5 w-3.5 -translate-x-0.5"])},null,8,["icon","class"])]),key:"0"}:void 0]),1032,["class","disabled","value","onUpdate:value"]),n(e(h),{class:l([e(s).storeLinkHDOSButton]),disabled:o.value?.is_installed,type:"dashed",onClick:S=>G(m)},{default:d(()=>[n(e(u),{icon:e(O)},null,8,["icon"])]),_:1},8,["class","disabled","onClick"])]))),128))])]),a("div",Ze,[a("h3",{class:l([[e(s).storeAboutTextScope],"text-xs font-semibold uppercase tracking-wider mb-3"])},"Restart Policy",2),n(e(xe),{class:l([[e(s).scopeSelector,e(s).loginFormInput],"w-full"]),"popup-class-name":`${e(s).scopeSelector}`,disabled:o.value?.is_installed,value:A.value,"onUpdate:value":t[3]||(t[3]=c=>A.value=c),"get-popup-container":c=>c.parentNode},{default:d(()=>[n(e(D),{class:l([e(s).scopeSelector]),value:"always"},{default:d(()=>[...t[14]||(t[14]=[f("Always",-1)])]),_:1},8,["class"]),n(e(D),{class:l([e(s).scopeSelector]),value:"unless-stopped"},{default:d(()=>[...t[15]||(t[15]=[f("Unless Stopped",-1)])]),_:1},8,["class"]),n(e(D),{class:l([e(s).scopeSelector]),value:"no"},{default:d(()=>[...t[16]||(t[16]=[f("No",-1)])]),_:1},8,["class"])]),_:1},8,["class","popup-class-name","disabled","value","get-popup-container"])])]))]),_:1})])]),n(fe,{icon:e(N),message:"Install App",info:o.value?.name?`Installing ${o.value.name}`:"Configure application",showHelp:!0},{help:d(()=>[a("div",Ge,[a("div",We,[n(e(u),{icon:e(N),class:l(["w-5 h-5",e(s).statusBarIcon])},null,8,["icon","class"]),a("h4",{class:l(["text-base font-semibold",e(s).statusBarText])},"Install App",2)]),a("div",{class:l(["text-[10px] md:text-xs space-y-2 leading-relaxed",e(s).statusBarInfo])},[...t[17]||(t[17]=[a("p",null,"Configure your application before installation using simple mode with form fields or advanced mode with direct compose editing. Set ports, volumes, credentials, and restart policies to customize how your application runs. Toggle between modes using the switch to choose your preferred configuration method.",-1)])],2)])]),_:1},8,["icon","info"])])):(r(),p("div",ke,[a("div",we,[n(e(u),{icon:e(E),class:l([[e(s).installConfigLoadingIcon],"animate-spin h-12 w-12 mx-auto mb-4"])},null,8,["icon","class"]),a("p",{class:l([e(s).installConfigLoadingText])},"Loading application details...",2)])]))]))}}),Cs=ie(Ye,[["__scopeId","data-v-4d6f6a50"]]);export{Cs as default};
