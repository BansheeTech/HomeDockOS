import{j as ro,q as io,d as C,D as $,z as u,G as m,T as we,E as k,v as p,F as b,x as i,u as n,y as r,M as x,H as g,Z as Lo,_ as co,r as v,n as ee,w as et,B as Ro,C as Yo,K as Xo,Y as P,L as te,S as bt,R as U,U as he,N as He}from"./hdos_Dbq3fhnkqH76jQuyDCTTt.js";import{d as be,a as E}from"./hdos_BbS_vWe5DNlDDYAPlKxdN.js";import{g as Ao,w as Vo,x as jo,y as Ue,z as oe,A as ge,C as Oo,B as tt,D as kt,E as No,F as D,G as St,H as ot,I as to,J as _t,K as oo,L as xe,M as Tt,N as qo}from"./hdos_C5AEMY2HFY_-h_mOBTkJ4.js";import{u as Go}from"./hdos_DP88aUbmLlW8Y-JRrH_FE.js";import{d as Wo}from"./hdos_D7NRCijMj_Q9fS__axrEk.js";import{d as Ft}from"./hdos_DPhlMBAcwmj4N6C-RIU0v.js";import{a as ye,d as Ko}from"./hdos_D7DZAtFwektbc_d3JJwvS.js";import{d as Mt}from"./hdos_CS7Pix6yyXf4PLMilHEK5.js";import{_ as Qo}from"./hdos_DR-AppMpnYI3uQEIV7tI7.js";import{j as w}from"./hdos_BIpjuF1XxdpJ6XOgmz5z6.js";import{c as Dt,S as Jo}from"./hdos_BzXNcRU4sF9d--ytqtf1Y.js";import{P as Ct,U as en}from"./hdos__C6XHRJJOpihfwjAAEWaK.js";import"./hdos_DYMRrVh6eAnILluBOQevy.js";import{b as tn,I as no}from"./hdos_rt9z7PzP3AM6gg1GVl6Eb.js";import{A as on}from"./hdos_B4NLORkS5XXGtP6-ZOH2D.js";import{$ as nn}from"./hdos_D9OrELHR35j-7vcwagI1C.js";import"./hdos_Dz3aTMQqM4LnOlKzV3COc.js";import"./hdos_itWSuQ2oYLgMGq-Z_V6WL.js";import"./hdos_CE1G-McAXm7G2-tH-xmrF.js";import"./hdos_DCQvziD-0BGtLQC-jPv6N.js";import"./hdos_CJoaCRc7PMIr83ndc1bSY.js";import"./hdos_BMinznI1SgDjG1GLhiYLN.js";import"./hdos_Ce05jrhR34kDkwVUkTBSn.js";import"./hdos_D63Tfrq7hZ9D-jbqbBA6V.js";import"./hdos_CNtsy7prIlCqgyE1iBI3a.js";import"./hdos_Clk8ViuslpLBU5LfImMV0.js";import"./hdos_gi4ZqcIwcXFS2y0HUDFtL.js";import"./hdos_BJ0AbwQX4fz6PIT4pw67U.js";import"./hdos_CXZVyE3kgKoiCYjvoFmHI.js";import"./hdos_BjJF5rDxeBNZm4L-rb8fE.js";const an={width:24,height:24,body:'<path fill="currentColor" d="M22 8v5.81c-.88-.51-1.9-.81-3-.81c-3.31 0-6 2.69-6 6c0 .34.04.67.09 1H4a2 2 0 0 1-2-2V6c0-1.11.89-2 2-2h6l2 2h8a2 2 0 0 1 2 2m-4 8l-3 3l3 3v-2h4v-2h-4v-2Z"/>'},ao={width:24,height:24,body:'<path fill="currentColor" d="M10 4h4v9l3.5-3.5l2.42 2.42L12 19.84l-7.92-7.92L6.5 9.5L10 13V4Z"/>'},sn={width:24,height:24,body:'<path fill="currentColor" d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12c5.16-1.26 9-6.45 9-12V5l-9-4m0 6c1.4 0 2.8 1.1 2.8 2.5V11c.6 0 1.2.6 1.2 1.3v3.5c0 .6-.6 1.2-1.3 1.2H9.2c-.6 0-1.2-.6-1.2-1.3v-3.5c0-.6.6-1.2 1.2-1.2V9.5C9.2 8.1 10.6 7 12 7m0 1.2c-.8 0-1.5.5-1.5 1.3V11h3V9.5c0-.8-.7-1.3-1.5-1.3Z"/>'},zt={width:24,height:24,body:'<path fill="currentColor" d="M16 8c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V10c0-1.1.9-2 2-2h9V6c0-1.7-1.3-3-3-3S7 4.3 7 6H5c0-2.8 2.2-5 5-5s5 2.2 5 5v2h1m-6 9c1.1 0 2-.9 2-2s-.9-2-2-2s-2 .9-2 2s.9 2 2 2m12-4h-2V7h2v6m0 4h-2v-2h2v2Z"/>'},ln={width:24,height:24,body:'<path fill="currentColor" d="M19 17h3l-4 4l-4-4h3V3h2M2 17h10v2H2M6 5v2H2V5m0 6h7v2H2v-2Z"/>'},rn={width:24,height:24,body:'<path fill="currentColor" d="M19 7h3l-4-4l-4 4h3v14h2M2 17h10v2H2M6 5v2H2V5m0 6h7v2H2v-2Z"/>'},cn={width:24,height:24,body:'<path fill="currentColor" d="m12 2l4 4h-3v7.85l6.53 3.76L21 15.03l1.5 5.47l-5.5 1.46l1.53-2.61L12 15.58l-6.53 3.77L7 21.96L1.5 20.5L3 15.03l1.47 2.58L11 13.85V6H8l4-4Z"/>'},un={width:24,height:24,body:'<path fill="currentColor" d="M3 11h8V3H3m0 18h8v-8H3m10 8h8v-8h-8m0-10v8h8V3"/>'},dn={width:24,height:24,body:'<path fill="currentColor" d="M9 5v4h12V5M9 19h12v-4H9m0-1h12v-4H9M4 9h4V5H4m0 14h4v-4H4m0-1h4v-4H4v4Z"/>'},pn=ro({__name:"StatusBubble",props:{visible:{type:Boolean,default:!1},message:{default:""},icon:{default:void 0},spinning:{type:Boolean,default:!1},position:{default:"bottom-left"},teleport:{type:Boolean,default:!1},teleportTarget:{default:"body"}},setup(I){const L=I,{themeClasses:l}=io(),T=C(()=>{switch(L.position){case"bottom-left":return"bottom-10 left-3";case"bottom-right":return"bottom-10 right-3";case"top-left":return"top-2 left-2";case"top-right":return"top-2 right-2";default:return"bottom-12 left-6"}}),ke=C(()=>L.position.includes("left")?"slide-fade-left":"slide-fade-right");return(Z,F)=>I.teleport?(u(),$(Lo,{key:0,to:I.teleportTarget},[m(we,{name:ke.value},{default:k(()=>[I.visible?(u(),p("div",{key:0,class:i([[n(l).dropZoneStatusBubble,T.value],"fixed z-[9998] px-4 py-2.5 rounded-lg border flex items-center gap-2 min-w-[200px] max-w-[300px]"])},[I.icon?(u(),$(n(x),{key:0,icon:I.icon,class:i([[n(l).dropZoneStatusIcon,I.spinning&&"animate-spin"],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"])):(u(),$(n(x),{key:1,icon:n(be),class:i([[n(l).dropZoneStatusIcon,"animate-spin"],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"])),r("span",{class:i([[n(l).dropZoneStatusText],"text-sm font-medium truncate"])},g(I.message),3)],2)):b("",!0)]),_:1},8,["name"])],8,["to"])):(u(),$(we,{key:1,name:ke.value},{default:k(()=>[I.visible?(u(),p("div",{key:0,class:i([[n(l).dropZoneStatusBubble,T.value],"fixed z-[9998] px-4 py-2.5 rounded-lg border flex items-center gap-2 min-w-[200px] max-w-[300px]"])},[I.icon?(u(),$(n(x),{key:0,icon:I.icon,class:i([[n(l).dropZoneStatusIcon,I.spinning&&"animate-spin"],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"])):(u(),$(n(x),{key:1,icon:n(be),class:i([[n(l).dropZoneStatusIcon,"animate-spin"],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"])),r("span",{class:i([[n(l).dropZoneStatusText],"text-sm font-medium truncate"])},g(I.message),3)],2)):b("",!0)]),_:1},8,["name"]))}}),mn=co(pn,[["__scopeId","data-v-73a9aa30"]]),vn={key:0,class:"absolute inset-0 z-[9999] pointer-events-none backdrop-blur-sm"},fn={class:"flex items-center align-center justify-center flex-col h-full"},hn={class:"ant-upload-drag-icon"},gn={class:"flex-1 flex flex-col overflow-auto px-4 pt-2 pb-5"},xn={class:"mt-2 flex flex-col flex-1 gap-2"},yn={class:"dropzone-controls-container flex flex-col gap-2 items-start justify-between flex-shrink-0"},wn={class:"dropzone-search-wrapper flex-1 min-w-0 w-full"},bn={class:"flex items-center gap-2"},kn={class:"truncate"},Sn={class:"dropzone-actions-wrapper flex items-center gap-2 mt-0.5 w-full"},_n=["title"],Tn=["title"],Fn={class:"flex items-center justify-start text-[10px] gap-2 flex-shrink-0"},Mn={key:0,class:"ml-0.5"},Dn={key:0,class:"flex justify-center items-center text-balance px-2 py-8"},Cn={class:"text-[10px] font-semibold truncate"},zn={class:"text-[9px] opacity-60 ml-auto"},$n=["data-filename","onClick","onDblclick","onContextmenu","onTouchstart","onTouchend","onTouchcancel"],In={key:1,class:"absolute -left-1 -bottom-1 flex items-center gap-0.5 z-10"},Zn={key:0,class:"w-1.5 h-1.5 bg-green-500 rounded-full ring-1 ring-black/30"},Bn={key:2,class:"absolute -right-1 -top-1 flex items-center gap-0.5"},En=["title"],Pn={key:0,class:"absolute -bottom-1 left-2 right-2"},Hn={class:"text-[10px] font-semibold truncate"},Un={class:"text-[9px] opacity-60 ml-auto"},Ln=["data-filename","onClick","onDblclick","onContextmenu","onTouchstart","onTouchend","onTouchcancel"],Rn={class:"relative flex-shrink-0 z-[1]"},Yn={class:i(["relative w-6 h-6 flex items-center justify-center"])},Xn={key:0,class:"absolute -left-1 -top-1 w-1.5 h-1.5 bg-green-500 rounded-full z-10 ring-1 ring-black/30"},An={key:1,class:"absolute -right-1 -bottom-1"},Vn={class:"flex-1 overflow-hidden z-[1]"},jn=["title"],On=["data-filename","onClick","onDblclick","onContextmenu","onTouchstart","onTouchend","onTouchcancel"],Nn={class:"relative flex-shrink-0 z-[1]"},qn={class:i(["relative w-6 h-6 flex items-center justify-center"])},Gn={key:0,class:"absolute -left-1 -top-1 w-1.5 h-1.5 bg-green-500 rounded-full z-10 ring-1 ring-black/30"},Wn={key:1,class:"absolute -right-1 -bottom-1"},Kn={class:"flex-1 overflow-hidden z-[1]"},Qn=["title"],Jn={class:"mb-1"},ea={class:"mb-1"},ta={class:"space-y-3"},oa={class:"text-sm font-bold flex items-center gap-2"},na={class:"text-xs space-y-1.5 ml-4 list-disc"},aa={class:"flex items-center gap-2 flex-1 min-w-0"},sa={class:"flex mt-1.5 items-center flex-1 max-w-xs"},la={class:"max-h-60 overflow-y-auto py-1"},ra={class:"px-3 py-1.5"},ia={class:"flex items-center gap-1.5"},ca={class:"flex-1 min-w-0"},ua={class:"flex items-center gap-1.5 mb-0.5"},da=["title"],pa={class:"px-3 py-1.5 opacity-40"},ma={class:"flex items-center gap-1.5"},va={class:"flex items-center gap-1.5 flex-1 min-w-0"},fa=["title"],ha={class:"px-3 py-1 text-center"},ga={class:"space-y-2.5 max-w-sm"},xa={class:"flex items-center gap-2"},ya=3,wa=110,$t=125,It=300,Zt=30,so=500,lo=10,ba=ro({__name:"AppDropzone",setup(I){const L=Ao(),{themeClasses:l}=io(),T=Vo(),ke=Go(),Z=v([]),F=v(""),S=v(""),Le=v([]),Re=v(!1);let Ye=0;const ne=v("name"),q=v("asc"),R=v("grid"),Se=v([]),Xe=v(0),ae=v(0),_e=v(0),Te=v(!1),se=v(""),Fe=v(!1),Ae=v(null),le=v(""),K=v(!1),nt=v(""),at=v(""),re=v(null),Me=v(!1),G=v(null),M=v(null),f=v(new Set),ie=v(!1),y=v({startX:0,startY:0,currentX:0,currentY:0}),W=v(null),ce=v({}),ue=v({}),z=v({}),De=v(!1),Bt=v(""),Ve=v(!1),st=v(0),Et=v(0),Ce=v(!1),lt=v(!1),Pt=v(0),Ht=v(0),Y=v(null);let V=0,j=0,O=0,Q=null,Ut=0,Lt=0,je=null,ze=!1,Oe=!1,N=null,Rt=0,Yt=0,Ne=!1,rt=null,J=null,it=!1,$e=!1;const uo={folder:oe,txt:Tt,md:Tt,pdf:Tt,png:xe,jpg:xe,jpeg:xe,gif:xe,psd:xe,webp:xe,mp4:oo,mkv:oo,mp3:_t,wav:_t,flac:_t,zip:kt,rar:kt,doc:to,docx:to,pptx:ot,ppt:ot,ppsx:ot,pps:ot,xlsx:St,xls:St,csv:St,exe:D,app:D,sh:D,js:D,ts:D,py:D,c:D,cpp:D,h:D,hpp:D,cs:D,java:D,php:D,html:D,css:D,json:D,xml:D,sql:D,rs:D},Ie=C(()=>Z.value),po=C(()=>S.value&&S.value.trim().length>=2?[]:[...Z.value].sort((o,t)=>o.is_directory&&!t.is_directory?-1:!o.is_directory&&t.is_directory?1:(o.display_name||o.name).localeCompare(t.display_name||t.name)).map(o=>({value:o.display_name||o.name,label:o.display_name||o.name,isDirectory:o.is_directory,fileName:o.name}))),ct=C(()=>{const e=[...Ie.value].sort((o,t)=>{if(o.is_directory&&!t.is_directory)return-1;if(!o.is_directory&&t.is_directory)return 1;let a=0;switch(ne.value){case"name":a=o.name.localeCompare(t.name);break;case"size":a=o.size-t.size;break;case"date":if(!o.modified&&!t.modified)a=0;else if(!o.modified)a=1;else if(!t.modified)a=-1;else{const s=typeof o.modified=="number"?o.modified:new Date(o.modified).getTime()/1e3,c=typeof t.modified=="number"?t.modified:new Date(t.modified).getTime()/1e3;a=s-c}break}return q.value==="asc"?a:-a});return F.value?[{name:"..",display_name:"..",size:0,modified:0,is_directory:!0},...e]:e}),mo=C(()=>{if(ae.value===0)return 0;let e=_e.value*100;return T.currentlyUploading.forEach(o=>{const t=T.uploadProgress[o.uid]||0;e+=t}),Math.round(e/ae.value)}),ut=C(()=>{if(!S.value||S.value.trim().length<2)return[];const e=new Map;return ct.value.forEach(o=>{const t=o.name.includes("/")?o.name.substring(0,o.name.lastIndexOf("/")):"";e.has(t)||e.set(t,[]),e.get(t).push(o)}),Array.from(e.entries()).map(([o,t])=>({folder:o,files:t})).sort((o,t)=>o.folder===""&&t.folder!==""?-1:o.folder!==""&&t.folder===""?1:o.folder.localeCompare(t.folder))}),de=C(()=>S.value&&S.value.trim().length>=2),dt=C(()=>{const e=st.value||window.innerWidth-100,o=Math.max(1,Math.floor(e/wa)),a=(e-16)/o;if(de.value){const s=[];let c=8;return ut.value.forEach(d=>{s.push({name:`__header__${d.folder}`,display_name:d.folder===""?"Homepath":d.folder,size:0,modified:0,is_directory:!0,x:8,y:c,gridRow:0,gridCol:0,isHeader:!0,headerText:d.folder===""?"Homepath":d.folder}),c+=32,d.files.forEach((_,H)=>{const B=H%o,A=Math.floor(H/o),Ee=8+B*a+(a-100)/2,Pe=c+A*$t;s.push({..._,x:Ee,y:Pe,gridRow:A,gridCol:B})});const h=Math.ceil(d.files.length/o);c+=h*$t+16}),s}return ct.value.map((s,c)=>{const d=c%o,h=Math.floor(c/o),_=8+d*a+(a-100)/2,H=8+h*$t;return{...s,x:_,y:H,gridRow:h,gridCol:d}})}),vo=C(()=>{if(dt.value.length===0)return 300;const a=Math.max(...dt.value.map(s=>s.y))+130+16;return Math.max(a,300)}),qe=C(()=>me(Z.value.reduce((e,o)=>e+o.size,0))),fo=C(()=>{if(M.value&&f.value.size===0){const e=Z.value.find(o=>o.name===M.value);return me(e?e.size:0)}if(f.value.size>0){const o=Z.value.filter(t=>f.value.has(t.name)).reduce((t,a)=>t+a.size,0);return me(o)}return qe.value}),ho=C(()=>M.value||f.value.size>0?`${fo.value} selected`:`${qe.value} total`),go=C(()=>window.innerWidth<768),xo=C(()=>{if(S.value&&S.value.trim().length>=2)return`Searching all folders for "${S.value}"`;if(!F.value)return`${Z.value.length} ${Z.value.length===1?"item":"items"} available`;const e=F.value.split("/").filter(t=>t),o=e[e.length-1]||"";if(go.value){const t=e.length;return`${"../".repeat(Math.max(0,t-1))}${o}`}return e.join(" / ")}),Xt=C(()=>{const e=Math.min(y.value.startX,y.value.currentX),o=Math.min(y.value.startY,y.value.currentY),t=Math.abs(y.value.currentX-y.value.startX),a=Math.abs(y.value.currentY-y.value.startY);return{left:`${e}px`,top:`${o}px`,width:`${t}px`,height:`${a}px`}}),yo=C(()=>{const e=[],o=f.value.size;if(o>1){const t=Array.from(f.value).map(s=>Z.value.find(c=>c.name===s)).filter(s=>s!==void 0),a=t.some(s=>!s.is_directory);return e.push({label:`Selected: ${o} items`,icon:jo,disabled:!0},{divider:!0}),a&&e.push({label:"Download All",icon:ao,action:async()=>{for(const s of t)s.is_directory||await vt(s.name);Qe()}}),e.push({label:"Delete All",icon:Mt,action:()=>{nt.value=`Delete ${o} items?`,at.value=`Are you sure you want to delete ${o} selected items? This action cannot be undone.`,re.value=null,K.value=!0,Qe()}},{divider:!0},{label:"New Folder",icon:Ue,action:()=>Je()}),e}return Y.value?Y.value.is_directory?(e.push({label:"Open",icon:oe,action:()=>{const t=Y.value.name;Qe(),de.value?($e=!0,S.value="",ee(()=>{Ke(t),$e=!1})):Ke(t)}}),e.push({divider:!0}),de.value?e.push({label:"Rename Folder",icon:ye,disabled:!0,action:()=>{}}):e.push({label:"Rename Folder",icon:ye,action:()=>Qt(Y.value)}),e.push({label:"Delete Folder",icon:Mt,action:()=>Jt(Y.value)},{divider:!0},{label:"New Folder",icon:Ue,action:()=>Je()})):(e.push({label:"Download",icon:ao,action:()=>vt(Y.value.name)},{divider:!0}),de.value?e.push({label:"Rename File",icon:ye,disabled:!0,action:()=>{}}):e.push({label:"Rename File",icon:ye,action:()=>Qt(Y.value)}),e.push({label:"Delete File",icon:Mt,action:()=>Jt(Y.value)},{divider:!0},{label:"New Folder",icon:Ue,action:()=>Je()})):e.push({label:"New Folder",icon:Ue,action:()=>Je()}),e});et([ne,q,R],()=>{So()}),et(S,e=>{if(rt&&clearTimeout(rt),!e||e.trim().length===0){$e||X(F.value);return}e.trim().length>=2&&(rt=setTimeout(()=>{X("",!0)},300))}),et(R,()=>{ee(()=>{yt(),eo()})}),et(()=>T.totalUploading,(e,o)=>{if(o!==void 0&&e<o){const t=o-e;_e.value+=t}ae.value=_e.value+e,e===0&&ae.value>0&&setTimeout(()=>{ae.value=0,_e.value=0,Ce.value=!1},3e3)},{immediate:!0});const pt=e=>e.startsWith("."),mt=e=>{if(!e.modified)return!1;const o=new Date,t=typeof e.modified=="number"?new Date(e.modified*1e3):new Date(e.modified);return(o.getTime()-t.getTime())/(1e3*60*60)<1},pe=e=>{if(!e.modified)return"";const o=new Date,t=typeof e.modified=="number"?new Date(e.modified*1e3):new Date(e.modified),a=Math.floor((o.getTime()-t.getTime())/1e3);if(a<60)return`${a}s ago`;const s=Math.floor(a/60);if(s<60)return`${s}m ago`;const c=Math.floor(s/60);if(c<24)return`${c}h ago`;const d=Math.floor(c/24);if(d<30)return`${d}d ago`;const h=Math.floor(d/30);return h<12?`${h}mo ago`:`${Math.floor(h/12)}y ago`},At=async(e,o="")=>{const t=[];return new Promise((a,s)=>{const c=e.createReader(),d=()=>{c.readEntries(async h=>{if(h.length===0){a(t);return}for(const _ of h){if(pt(_.name))continue;const H=o?`${o}/${_.name}`:_.name;if(_.isFile){const B=_,A=await new Promise((Ee,Pe)=>{B.file(Ee,Pe)});t.push({file:A,relativePath:o})}else if(_.isDirectory){const A=await At(_,H);t.push(...A)}}d()},h=>{s(h)})};d()})},wo=e=>{const o=new Set;return e.forEach(({relativePath:a})=>{if(a){const s=a.split("/");let c="";for(const d of s)c=c?`${c}/${d}`:d,o.add(c)}}),Array.from(o).sort((a,s)=>{const c=a.split("/").length,d=s.split("/").length;return c!==d?c-d:a.localeCompare(s)})};function me(e){const o=typeof e=="number"?e:parseFloat(e);if(o===0)return"0 B";const t=1024,a=["B","KB","MB","GB","TB"],s=Math.floor(Math.log(o)/Math.log(t));return Math.round(o/Math.pow(t,s)*100)/100+" "+a[s]}function bo(e){const o=typeof e=="number"?e:parseFloat(e);if(o===0)return"0B";const t=1024,a=["B","KB","MB","GB","TB"],s=Math.floor(Math.log(o)/Math.log(t)),c=o/Math.pow(t,s);return(c>=100?Math.round(c).toString():c.toFixed(1))+a[s]}const Ge=e=>{if(e.is_directory)return e.name===".."?an:oe;const o=e.name.split(".").pop()?.toLowerCase();return uo[o||"unknown"]||qo},Ze=(e,o=0)=>{Bt.value=e,Ve.value=!0,o>0&&setTimeout(()=>{Ve.value=!1},o)},We=()=>{Ve.value=!1},ko=()=>{try{const e=localStorage.getItem("dropzoneStatus");if(e){const o=JSON.parse(e);ne.value=o.sortBy||"name",q.value=o.sortDirection||"asc",R.value=o.viewMode||"grid"}}catch(e){console.warn("[DropZone] Failed to load preferences from localStorage:",e)}},So=()=>{try{const e={sortBy:ne.value,sortDirection:q.value,viewMode:R.value};localStorage.setItem("dropzoneStatus",JSON.stringify(e))}catch(e){console.warn("[DropZone] Failed to save preferences to localStorage:",e)}},X=async(e="",o=!1)=>{try{if(S.value.trim()&&S.value.length>=2||o){De.value=!0;const s=setTimeout(()=>{De.value&&Ze("Searching files...")},200),c=await E.get("/api/search_files",{headers:{"X-HomeDock-CSRF-Token":L.value},params:{query:S.value.trim()}});clearTimeout(s),Z.value=c.data.files||[],F.value="",ke.setFiles(Z.value),De.value=!1,We();return}const t=e?{path:e}:{},a=await E.get("/api/get_files",{headers:{"X-HomeDock-CSRF-Token":L.value},params:t});Z.value=a.data.files||[],F.value=a.data.current_path||"",ke.setFiles(Z.value)}catch(t){De.value=!1,We(),E.isAxiosError(t)?w.error(t.response?.data?.error_message||"Failed to fetch files. Please try again."):w.error("Failed to fetch files. Please try again.")}},_o=async(e,o,t)=>{const a=new FormData;a.append("file",e),t&&a.append("path",t);try{const s=await E.post("/api/upload_file",a,{headers:{"X-HomeDock-CSRF-Token":L.value},onUploadProgress:c=>{if(c.total){const d=Math.round(c.loaded/c.total*100),h=e;T.updateProgress(h.uid,d),o&&o({percent:d})}}});s.data.success||w.error(s.data.error.value||"Upload failed")}catch(s){throw E.isAxiosError(s)?s.response?.status===413?w.error("The selected file is larger than 1GB."):w.error(s.response?.data?.error_message||`Unexpected error occurred: ${s.message}`):w.error("An unknown error occurred. Please try again."),s}},vt=async e=>{if(z.value[e]!==void 0&&z.value[e]<100&&z.value[e]>0){w.info(`Download for ${e} is already in progress.`);return}try{ce.value[e]=!0,ue.value[e]=!0,z.value[e]=0;const o=await E.get(`/api/download_file?file=${encodeURIComponent(e)}`,{headers:{"X-HomeDock-CSRF-Token":L.value},responseType:"blob",onDownloadProgress:c=>{if(c.total){const d=Math.round(c.loaded*100/c.total);z.value[e]=d}}}),t=window.URL.createObjectURL(new Blob([o.data])),a=document.createElement("a");a.href=t;const s=e.split("/").pop()||e;a.setAttribute("download",s),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t),setTimeout(()=>{ce.value[e]=!1,ue.value[e]=!1},1e3)}catch(o){E.isAxiosError(o)?w.error(o.response?.data?.error_message||"Failed to download file. Please try again."):w.error("Failed to download file. Please try again."),delete z.value[e],ue.value[e]=!1,ce.value[e]=!1}},Vt=async(e,o=!1)=>{try{const t=await E.post("/api/delete_file",{file:e},{headers:{"X-HomeDock-CSRF-Token":L.value}});return t.data.success?(o||w.success(t.data.message),{success:!0}):(o||w.error(t.data.error||"Failed to delete file"),{success:!1,error:t.data.error})}catch(t){return o||(E.isAxiosError(t)?w.error(t.response?.data?.error_message||"Failed to delete file. Please try again."):w.error("Failed to delete file. Please try again.")),{success:!1,error:t instanceof Error?t.message:"Unknown error"}}},ft=async()=>{if(!it){it=!0;try{for(;Xe.value<ya&&Se.value.length>0;){const e=Se.value.shift();if(!e)break;Xe.value++,T.startUpload({uid:e.file.uid,name:e.file.name,size:e.file.size}),(async()=>{try{await _o(e.file,e.onProgress,e.path),Le.value=Le.value.filter(o=>o.uid!==e.file.uid),T.completeUpload(e.file.uid),e.onSuccess&&e.onSuccess(null,e.file)}catch(o){T.cancelUpload(e.file.uid),e.onError&&e.onError(o)}finally{Xe.value--,ft()}})()}}finally{it=!1}Xe.value===0&&Se.value.length===0&&await X(F.value)}},To=async({file:e,onSuccess:o,onError:t,onProgress:a})=>{const s=e;T.addToQueue({uid:s.uid,name:s.name,size:s.size}),Se.value.push({file:s,onProgress:a,onSuccess:o,onError:t,path:F.value}),ft()},jt=async e=>{Ze(`Enqueueing ${e.length} ${e.length===1?"file":"files"} for upload...`),await ee(),await new Promise(a=>setTimeout(a,50));const o=Date.now(),t=20;for(let a=0;a<e.length;a+=t){const s=e.slice(a,a+t);for(let c=0;c<s.length;c++){const{file:d,relativePath:h}=s[c],_=a+c,H=`${o}-${_}-${Math.random().toString(36).substring(2,11)}-${d.name}`,B=d;B.uid=H;const A=h?F.value?`${F.value}/${h}`:h:F.value;T.addToQueue({uid:B.uid,name:B.name,size:B.size}),Se.value.push({file:B,path:A,onProgress:void 0,onSuccess:void 0,onError:void 0})}a+t<e.length&&await new Promise(c=>setTimeout(c,0))}Ze("Starting upload...",2e3),await ee(),ft()},Ot=async()=>{if(!se.value.trim()){w.error("Folder name cannot be empty");return}try{const e=await E.post("/api/create_folder",{name:se.value.trim(),path:F.value},{headers:{"X-HomeDock-CSRF-Token":L.value}});e.data.success?(w.success(e.data.message),Te.value=!1,se.value="",await X(F.value)):w.error(e.data.error||"Failed to create folder")}catch(e){E.isAxiosError(e)?w.error(e.response?.data?.error||"Failed to create folder. Please try again."):w.error("Failed to create folder. Please try again.")}},Nt=async()=>{if(!Ae.value||!le.value.trim()){w.error("New name cannot be empty");return}try{const e=await E.post("/api/rename_item",{old_name:Ae.value.name,new_name:le.value.trim()},{headers:{"X-HomeDock-CSRF-Token":L.value}});e.data.success?(w.success(e.data.message),Fe.value=!1,Ae.value=null,le.value="",await X(F.value)):w.error(e.data.error||"Failed to rename item")}catch(e){E.isAxiosError(e)?w.error(e.response?.data?.error||"Failed to rename item. Please try again."):w.error("Failed to rename item. Please try again.")}},Ke=e=>{X(e)},qt=()=>{if(!F.value)return;const e=F.value.split("/").filter(t=>t);e.pop();const o=e.join("/");X(o)},Fo=e=>{e.preventDefault(),Ye++,e.dataTransfer?.types.includes("Files")&&(Re.value=!0)},Mo=e=>{e.preventDefault(),Ye--,Ye===0&&(Re.value=!1)},Do=async e=>{if(e.preventDefault(),e.stopPropagation(),Ye=0,Re.value=!1,!e.dataTransfer)return;Ze("Scanning dropped items...");const o=[];if(e.dataTransfer.items&&e.dataTransfer.items.length>0){const a=[];for(let s=0;s<e.dataTransfer.items.length;s++){const c=e.dataTransfer.items[s];if(c.kind==="file"){const d=c.webkitGetAsEntry();d&&!pt(d.name)&&a.push(d)}}for(const s of a)if(s.isFile){const c=s,d=await new Promise((h,_)=>{c.file(h,_)});o.push({file:d,relativePath:""})}else if(s.isDirectory){Ze("Processing folders structure...");const c=s,d=await At(c,c.name);o.push(...d)}}else for(let a=0;a<e.dataTransfer.files.length;a++){const s=e.dataTransfer.files[a];pt(s.name)||o.push({file:s,relativePath:""})}if(o.length===0){We();return}const t=wo(o);if(t.length>0){G.value={allFiles:o,folders:t},Me.value=!0,We();return}await jt(o)},Co=e=>{e.file.status==="done"?w.success(`${e.file.name} uploaded successfully`):e.file.status==="error"&&w.error(`${e.file.name} upload failed.`)},ht=(e,o)=>{const t=o;if(!t)return;const a="touches"in t;if(e.name===".."){if(a){const c=t.changedTouches?.[0]||t.touches?.[0];if(c){const d=Date.now(),h=d-V,_=Math.sqrt(Math.pow(c.clientX-j,2)+Math.pow(c.clientY-O,2));if(h<It&&_<Zt){qt(),V=0,j=0,O=0;return}else{V=d,j=c.clientX,O=c.clientY;return}}}return}if(a){const c=t.changedTouches?.[0]||t.touches?.[0];if(c){const d=Date.now(),h=d-V,_=Math.sqrt(Math.pow(c.clientX-j,2)+Math.pow(c.clientY-O,2));if(h<It&&_<Zt){Be(e),V=0,j=0,O=0;return}else{f.value.clear(),M.value=e.name,V=d,j=c.clientX,O=c.clientY;return}}}t?.ctrlKey||t?.metaKey?(f.value.has(e.name)?f.value.delete(e.name):f.value.add(e.name),M.value=null):(f.value.clear(),M.value=e.name)},Be=e=>{if(e.name===".."){qt();return}e.is_directory?de.value?($e=!0,S.value="",ee(()=>{Ke(e.name),$e=!1})):Ke(e.name):vt(e.name)},gt=(e,o)=>{const t=o.touches[0];t&&(je=e,ze=!1,Oe=!1,Ut=t.clientX,Lt=t.clientY,e.name!==".."&&(Q=setTimeout(()=>{Oe=!0,navigator.vibrate&&navigator.vibrate(50);const a=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:t.clientX,clientY:t.clientY});fe(a,e)},so)))},xt=e=>{const o=e.touches[0];if(!o)return;Math.sqrt(Math.pow(o.clientX-Ut,2)+Math.pow(o.clientY-Lt,2))>lo&&(ze=!0,Q&&(clearTimeout(Q),Q=null))},ve=(e,o)=>{if(Q&&(clearTimeout(Q),Q=null),Oe){Oe=!1,ze=!1,je=null;return}if(!ze&&je){const t=Date.now(),a=o.changedTouches[0];if(!a)return;const s=t-V,c=Math.sqrt(Math.pow(a.clientX-j,2)+Math.pow(a.clientY-O,2));s<It&&c<Zt?(Be(e),V=0,j=0,O=0):(f.value.clear(),M.value=e.name,V=t,j=a.clientX,O=a.clientY)}ze=!1,je=null},zo=e=>{const o=e.target;if(o.closest(".dropzone-file-item")||o.closest(".dropzone-controls-container"))return;const s=e.touches[0];s&&(Rt=s.clientX,Yt=s.clientY,Ne=!1,N=setTimeout(()=>{navigator.vibrate&&navigator.vibrate(50);const c=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:s.clientX,clientY:s.clientY});fe(c,null),N=null},so))},$o=e=>{if(!N)return;const o=e.touches[0];if(!o)return;Math.sqrt(Math.pow(o.clientX-Rt,2)+Math.pow(o.clientY-Yt,2))>lo&&(Ne=!0,N&&(clearTimeout(N),N=null))},Gt=()=>{N&&(clearTimeout(N),N=null),Ne||(M.value=null,f.value.clear()),Ne=!1},Io=e=>{const o=e.target;if(o.closest(".dropzone-file-item")||o.closest(".dropzone-controls-container")||Ie.value.length===0||e.button!==0)return;const s=e.currentTarget?.getBoundingClientRect();s&&(ie.value=!0,y.value.startX=e.clientX-s.left,y.value.startY=e.clientY-s.top,y.value.currentX=y.value.startX,y.value.currentY=y.value.startY,M.value=null,f.value.clear(),document.addEventListener("mousemove",Wt),document.addEventListener("mouseup",Kt))},Wt=e=>{if(!ie.value)return;const t=W.value?.getBoundingClientRect();if(!t)return;let a=e.clientX-t.left,s=e.clientY-t.top;a=Math.max(0,Math.min(a,t.width)),s=Math.max(0,Math.min(s,t.height)),y.value.currentX=a,y.value.currentY=s,Zo()},Kt=()=>{!(Math.abs(y.value.currentX-y.value.startX)>5||Math.abs(y.value.currentY-y.value.startY)>5)&&ie.value&&(M.value=null,f.value.clear()),ie.value=!1,document.removeEventListener("mousemove",Wt),document.removeEventListener("mouseup",Kt)},Zo=()=>{const e=Math.min(y.value.startX,y.value.currentX),o=Math.min(y.value.startY,y.value.currentY),t=Math.abs(y.value.currentX-y.value.startX),a=Math.abs(y.value.currentY-y.value.startY);f.value.clear();const c=W.value?.getBoundingClientRect();c&&document.querySelectorAll(".dropzone-file-item").forEach(d=>{const h=d.getBoundingClientRect(),_=h.left-c.left,H=h.top-c.top,B=_+h.width,A=H+h.height,Ee=e+t,Pe=o+a;if(e<B&&Ee>_&&o<A&&Pe>H){const wt=d.getAttribute("data-filename");wt&&wt!==".."&&f.value.add(wt)}})},fe=(e,o=null)=>{e.preventDefault(),o?.name!==".."&&(o&&!f.value.has(o.name)&&(M.value=o.name,f.value.clear()),Y.value=o,Pt.value=e.clientX,Ht.value=e.clientY,lt.value=!0)},Qe=()=>{lt.value=!1,Y.value=null},Je=()=>{se.value="",Te.value=!0},Qt=e=>{Ae.value=e;const o=e.display_name||e.name.split("/").pop()||e.name;le.value=o,Fe.value=!0},Jt=e=>{const o=e.is_directory?"folder":"file",t=e.display_name||e.name.split("/").pop()||e.name;re.value=e,nt.value=`Delete ${o}?`,at.value=`Are you sure you want to delete "${t}"?${e.is_directory?" This will delete all files inside.":""}`,K.value=!0},Bo=async()=>{if(!re.value&&f.value.size>0){const e=Array.from(f.value);let o=0,t=0;for(const a of e)(await Vt(a,!0)).success?o++:t++;t===0?w.success(`${o} ${o===1?"item":"items"} deleted successfully`):o===0?w.error(`Failed to delete ${t} ${t===1?"item":"items"}`):w.warning(`${o} ${o===1?"item":"items"} deleted, ${t} failed`),f.value.clear(),M.value=null,K.value=!1,await X(F.value);return}re.value&&(await Vt(re.value.name),K.value=!1,re.value=null,await X(F.value))},Eo=async()=>{if(!G.value)return;Me.value=!1;const{allFiles:e}=G.value;G.value=null,await ee(),await jt(e)},Po=()=>{Me.value=!1,G.value=null},Ho=()=>{q.value=q.value==="asc"?"desc":"asc"},Uo=()=>{R.value=R.value==="grid"?"list":"grid",ee(()=>{yt()})},yt=()=>{W.value&&(st.value=W.value.clientWidth,Et.value=W.value.clientHeight)},eo=()=>{J&&J.disconnect(),W.value&&(J=new ResizeObserver(e=>{for(const o of e)st.value=o.contentRect.width,Et.value=o.contentRect.height}),J.observe(W.value))};return Ro(()=>{ko(),X(),yt(),eo()}),Yo(()=>{J&&(J.disconnect(),J=null)}),(e,o)=>(u(),p("div",{class:"app-dropzone flex flex-col h-full overflow-hidden",onDragenter:Fo,onDragleave:Mo,onDragover:o[18]||(o[18]=He(()=>{},["prevent"])),onDrop:He(Do,["prevent","stop"])},[m(we,{name:"dragger-fade"},{default:k(()=>[Re.value?(u(),p("div",vn,[r("div",{class:i([[n(l).scopeSelector,n(l).dropZoneDragHolder],"fullscreen-dragger h-full border-2 border-dashed rounded-lg flex items-center justify-center"])},[r("div",fn,[r("p",hn,[m(Xo,{icons:[n(ge),n(sn)],iconSize:64,interval:2e3,class:i([[n(l).dropZoneDragIcon],"text-5xl"])},null,8,["icons","class"])]),r("p",{class:i([[n(l).dropZoneDragUpText],"px-4 text-balance text-center text-lg font-semibold mt-4"])},"Drop files or folders to upload and encrypt",2),r("p",{class:i([[n(l).dropZoneDragDownText],"px-4 text-balance text-center text-sm mt-2"])},"Folders will maintain their structure.",2),r("p",{class:i([[n(l).dropZoneDragDownText],"px-4 text-balance text-center text-sm mt-1"])},"Hidden files (.*) are automatically filtered.",2)])],2)])):b("",!0)]),_:1}),r("div",gn,[r("div",xn,[r("div",yn,[r("div",wn,[m(n(on),{value:S.value,"onUpdate:value":o[1]||(o[1]=t=>S.value=t),options:po.value,"popup-class-name":`${n(l).scopeSelector}`,class:"w-full"},{option:k(({label:t,isDirectory:a,fileName:s})=>[r("div",bn,[m(n(x),{icon:a?n(oe):Ge({name:s,is_directory:!1,size:0,modified:0}),class:i([[n(l).dropZoneFileIcon],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"]),r("span",kn,g(t),1)])]),default:k(()=>[m(n(tn),{value:S.value,"onUpdate:value":o[0]||(o[0]=t=>S.value=t),placeholder:"Search files...",class:"w-full text-sm","enter-button":"Search"},{prefix:k(()=>[De.value?(u(),$(n(x),{key:0,icon:n(be),class:i([[n(l).dropZoneInputIcon,"animate-spin"],"mx-1"])},null,8,["icon","class"])):(u(),$(n(x),{key:1,icon:n(ge),class:i([[n(l).dropZoneInputIcon],"mx-1"])},null,8,["icon","class"]))]),_:1},8,["value"])]),_:1},8,["value","options","popup-class-name"])]),r("div",Sn,[m(n(Jo),{value:ne.value,"onUpdate:value":o[2]||(o[2]=t=>ne.value=t),class:i([[n(l).scopeSelector,n(l).dropZoneSortSelect],"dropzone-sort-select h-8 flex-1 rounded-md min-w-[140px] transition duration-150"]),"popup-class-name":`${n(l).scopeSelector}`,"show-search":!1},{suffixIcon:k(()=>[m(n(x),{icon:n(cn),class:"w-4 h-4"},null,8,["icon"])]),default:k(()=>[m(n(Dt),{value:"name"},{default:k(()=>[...o[19]||(o[19]=[P("Sort by Name",-1)])]),_:1}),m(n(Dt),{value:"size"},{default:k(()=>[...o[20]||(o[20]=[P("Sort by Size",-1)])]),_:1}),m(n(Dt),{value:"date"},{default:k(()=>[...o[21]||(o[21]=[P("Sort by Date",-1)])]),_:1})]),_:1},8,["value","class","popup-class-name"]),r("button",{onClick:Ho,class:i([[n(l).dropZoneSortButton],"px-2 py-1 border rounded-md transition-colors h-8 flex items-center justify-center flex-shrink-0"]),title:q.value==="asc"?"Sort Ascending":"Sort Descending"},[m(n(x),{icon:q.value==="asc"?n(ln):n(rn),class:"w-4 h-4"},null,8,["icon"])],10,_n),r("button",{onClick:Uo,class:i([[n(l).dropZoneSortButton],"px-2 py-1 border rounded-md transition-colors h-8 flex items-center justify-center flex-shrink-0"]),title:R.value==="grid"?"Switch to List View":"Switch to Grid View"},[m(n(x),{icon:R.value==="grid"?n(dn):n(un),class:"w-4 h-4"},null,8,["icon"])],10,Tn)])]),r("div",Fn,[r("span",{class:i([[n(l).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5"])},[P(g(Ie.value.length)+" "+g(Ie.value.length===1?"file":"files")+" ",1),S.value&&S.value.trim().length>=2?(u(),p("span",Mn,"(global search)")):b("",!0)],2),qe.value!=="0 B"&&Z.value.length>0?(u(),p("span",{key:0,class:i([[n(l).dropZoneTotalSizeScope],"rounded-full px-2 py-0.5"])},g(qe.value)+" total ",3)):b("",!0)]),r("div",{ref_key:"containerRef",ref:W,class:"view-mode-container",onMousedown:Io,onContextmenu:o[6]||(o[6]=t=>fe(t,null)),onTouchstart:zo,onTouchmove:$o,onTouchend:Gt,onTouchcancel:Gt},[Ie.value.length===0&&!F.value?(u(),p("div",Dn,[m(n(nn),{class:i([n(l).dropZoneEmptyText]),description:S.value&&S.value.trim().length>=2?"No files found matching your search across all folders":"Drag and drop your files here to store and encrypt them"},null,8,["class","description"])])):b("",!0),m(we,{name:R.value==="grid"?"view-mode-fade":"list-view-fade",mode:"out-in"},{default:k(()=>[R.value==="grid"?(u(),p("div",{key:"grid-view",class:"dropzone-icons-container relative w-full select-none",style:te({height:`${vo.value}px`})},[ie.value?(u(),p("div",{key:0,class:"absolute pointer-events-none z-[100] border-2 border-blue-500 bg-blue-500/20",style:te(Xt.value)},null,4)):b("",!0),m(bt,{name:"file-item"},{default:k(()=>[(u(!0),p(U,null,he(dt.value,t=>(u(),p(U,{key:t.name},[t.isHeader?(u(),p("div",{key:0,class:i([[n(l).dropZoneTotalSizeScope],"flex items-center gap-2 px-3 py-1.5 rounded-md"]),style:te({position:"absolute",left:`${t.x}px`,top:`${t.y}px`,width:"calc(100% - 16px)"})},[m(n(x),{icon:n(oe),class:i([[n(l).dropZoneFileIcon],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"]),r("span",Cn,g(t.headerText),1),r("span",zn,g(ut.value.find(a=>(a.folder===""?"Homepath":a.folder)===t.headerText)?.files.length||0)+" items ",1)],6)):(u(),p("div",{key:1,"data-filename":t.name,class:i(["group flex flex-col items-center gap-1 cursor-pointer p-2 rounded-lg","transition-[background,transform,border,box-shadow] duration-[150ms,200ms,0ms,0ms]","w-[100px] h-[120px] z-[1] touch-manipulation select-none outline-none border dropzone-file-item",!(M.value===t.name||f.value.has(t.name))&&["border-transparent","shadow-[0_0_0_1px_transparent]",n(l).desktopIconBg||"hover:bg-white/5"],(M.value===t.name||f.value.has(t.name))&&[n(l).desktopIconBgSelected||"bg-blue-500/20",n(l).desktopIconBorderSelected||"border-blue-500",n(l).desktopIconShadowSelected||"shadow-[0_0_0_1px_rgba(59,130,246,0.5)]"]]),style:te({position:"absolute",left:`${t.x}px`,top:`${t.y}px`}),onClick:a=>ht(t,a),onDblclick:a=>Be(t),onContextmenu:He(a=>fe(a,t),["stop"]),onTouchstart:a=>gt(t,a),onTouchmove:o[3]||(o[3]=a=>xt(a)),onTouchend:a=>ve(t,a),onTouchcancel:a=>ve(t,a)},[r("div",{class:i(["relative w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl",n(l).desktopIconContainerBg||"bg-white/10","transition-transform duration-200",!(M.value===t.name||f.value.has(t.name))&&(n(l).desktopIconContainerBgHover||"hover:bg-white/20"),(M.value===t.name||f.value.has(t.name))&&(n(l).desktopIconContainerBgSelected||"bg-blue-500/30")])},[!t.is_directory&&t.size>0?(u(),p("div",{key:0,class:i([[n(l).dropZoneFileSize],"absolute -left-1 -top-1 text-[8px] font-medium px-1 py-0.5 rounded whitespace-nowrap z-10"])},g(bo(t.size)),3)):b("",!0),pe(t)?(u(),p("div",In,[mt(t)?(u(),p("div",Zn)):b("",!0),r("div",{class:i([[n(l).dropZoneFileSize],"text-[8px] font-medium px-1 py-0.5 rounded whitespace-nowrap"])},g(pe(t)),3)])):b("",!0),t.is_directory?b("",!0):(u(),p("div",Bn,[ue.value[t.name]?(u(),$(n(x),{key:0,icon:n(be),class:i([[n(l).dropZoneLockIcon],"transition duration-300 animate-spin h-3 w-3"])},null,8,["icon","class"])):(u(),$(n(x),{key:1,icon:ce.value[t.name]?n(zt):n(Ft),class:i([[n(l).dropZoneLockIcon],"transition duration-300 h-3 w-3"])},null,8,["icon","class"]))])),m(n(x),{icon:Ge(t),class:i([[n(l).dropZoneFileIcon],"h-10 w-10 transition duration-300 group-hover:scale-110"])},null,8,["icon","class"])],2),r("span",{class:i([[n(l).dropZoneFileText],"text-[11px] leading-tight text-center line-clamp-2 w-full px-1 break-words"]),title:t.display_name||t.name},g(t.name.split("/").pop()),11,En),z.value[t.name]!==void 0&&z.value[t.name]<100?(u(),p("div",Pn,[m(n(Ct),{percent:z.value[t.name],class:i([[n(l).scopeSelector],"h-1 rounded-full"]),"show-info":!1,size:2,status:"active"},null,8,["percent","class"])])):b("",!0)],46,$n))],64))),128))]),_:1})],4)):(u(),p("div",{key:`list-view-${F.value}`,class:"dropzone-list-container w-full select-none"},[ie.value?(u(),p("div",{key:0,class:"absolute pointer-events-none z-[100] border-2 border-blue-500 bg-blue-500/20",style:te(Xt.value)},null,4)):b("",!0),de.value?(u(!0),p(U,{key:1},he(ut.value,t=>(u(),p(U,{key:t.folder},[r("div",{class:i([[n(l).dropZoneTotalSizeScope],"flex items-center gap-2 px-2 py-1.5 mt-2 mb-1 rounded-md sticky top-0 z-10"])},[m(n(x),{icon:n(oe),class:i([[n(l).dropZoneFileIcon],"w-4 h-4 flex-shrink-0"])},null,8,["icon","class"]),r("span",Hn,g(t.folder===""?"Homepath":t.folder),1),r("span",Un,g(t.files.length)+" "+g(t.files.length===1?"item":"items"),1)],2),m(bt,{name:"file-item-list"},{default:k(()=>[(u(!0),p(U,null,he(t.files,a=>(u(),p("div",{key:a.name,"data-filename":a.name,class:i(["group relative flex items-center gap-3 cursor-pointer px-2 py-1.5 rounded transition-colors dropzone-file-item overflow-hidden ml-4",!(M.value===a.name||f.value.has(a.name))&&[n(l).desktopIconBg||"hover:bg-white/5"],(M.value===a.name||f.value.has(a.name))&&[n(l).desktopIconBgSelected||"bg-blue-500/20"]]),onClick:s=>ht(a,s),onDblclick:s=>Be(a),onContextmenu:He(s=>fe(s,a),["stop"]),onTouchstart:s=>gt(a,s),onTouchmove:o[4]||(o[4]=s=>xt(s)),onTouchend:s=>ve(a,s),onTouchcancel:s=>ve(a,s)},[z.value[a.name]!==void 0&&z.value[a.name]<100?(u(),p("div",{key:0,class:"absolute inset-0 bg-blue-500/20 transition-all duration-300 ease-out",style:te({width:`${z.value[a.name]}%`})},null,4)):b("",!0),r("div",Rn,[r("div",Yn,[mt(a)?(u(),p("div",Xn)):b("",!0),m(n(x),{icon:Ge(a),class:i([[n(l).dropZoneFileIcon],"h-5 w-5"])},null,8,["icon","class"]),a.is_directory?b("",!0):(u(),p("div",An,[ue.value[a.name]?(u(),$(n(x),{key:0,icon:n(be),class:i([[n(l).dropZoneLockIcon],"animate-spin h-2 w-2"])},null,8,["icon","class"])):(u(),$(n(x),{key:1,icon:ce.value[a.name]?n(zt):n(Ft),class:i([[n(l).dropZoneLockIcon],"h-2 w-2"])},null,8,["icon","class"]))]))])]),r("div",Vn,[r("span",{class:i([[n(l).dropZoneFileText],"text-xs truncate block"]),title:a.name},g(a.name.split("/").pop()),11,jn)]),a.is_directory?b("",!0):(u(),p("div",{key:1,class:i([[n(l).dropZoneFileSize],"list-view-size text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},g(me(a.size)),3)),pe(a)?(u(),p("div",{key:2,class:i([[n(l).dropZoneFileSize],"list-view-time text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},g(pe(a)),3)):b("",!0)],42,Ln))),128))]),_:2},1024)],64))),128)):(u(),$(bt,{key:2,name:"file-item-list"},{default:k(()=>[(u(!0),p(U,null,he(ct.value,t=>(u(),p("div",{key:t.name,"data-filename":t.name,class:i(["group relative flex items-center gap-3 cursor-pointer px-2 py-1.5 rounded transition-colors dropzone-file-item overflow-hidden",!(M.value===t.name||f.value.has(t.name))&&[n(l).desktopIconBg||"hover:bg-white/5"],(M.value===t.name||f.value.has(t.name))&&[n(l).desktopIconBgSelected||"bg-blue-500/20"]]),onClick:a=>ht(t,a),onDblclick:a=>Be(t),onContextmenu:He(a=>fe(a,t),["stop"]),onTouchstart:a=>gt(t,a),onTouchmove:o[5]||(o[5]=a=>xt(a)),onTouchend:a=>ve(t,a),onTouchcancel:a=>ve(t,a)},[z.value[t.name]!==void 0&&z.value[t.name]<100?(u(),p("div",{key:0,class:"absolute inset-0 bg-blue-500/20 transition-all duration-300 ease-out",style:te({width:`${z.value[t.name]}%`})},null,4)):b("",!0),r("div",Nn,[r("div",qn,[mt(t)?(u(),p("div",Gn)):b("",!0),m(n(x),{icon:Ge(t),class:i([[n(l).dropZoneFileIcon],"h-5 w-5"])},null,8,["icon","class"]),t.is_directory?b("",!0):(u(),p("div",Wn,[ue.value[t.name]?(u(),$(n(x),{key:0,icon:n(be),class:i([[n(l).dropZoneLockIcon],"animate-spin h-2 w-2"])},null,8,["icon","class"])):(u(),$(n(x),{key:1,icon:ce.value[t.name]?n(zt):n(Ft),class:i([[n(l).dropZoneLockIcon],"h-2 w-2"])},null,8,["icon","class"]))]))])]),r("div",Kn,[r("span",{class:i([[n(l).dropZoneFileText],"text-xs truncate block"]),title:t.display_name||t.name},g(t.name.split("/").pop()),11,Qn)]),t.is_directory?b("",!0):(u(),p("div",{key:1,class:i([[n(l).dropZoneFileSize],"list-view-size text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},g(me(t.size)),3)),pe(t)?(u(),p("div",{key:2,class:i([[n(l).dropZoneFileSize],"list-view-time text-[10px] font-medium px-1.5 py-0.5 rounded whitespace-nowrap flex-shrink-0 z-[1]"])},g(pe(t)),3)):b("",!0)],42,On))),128))]),_:1}))]))]),_:1},8,["name"])],544)])]),m(Oo,{visible:lt.value,x:Pt.value,y:Ht.value,items:yo.value,onClose:Qe},null,8,["visible","x","y","items"]),m(tt,{visible:K.value,"onUpdate:visible":o[7]||(o[7]=t=>K.value=t),type:"confirm",title:nt.value,content:at.value,"ok-text":"Delete","cancel-text":"Cancel",onOk:Bo,onCancel:o[8]||(o[8]=t=>K.value=!1)},null,8,["visible","title","content"]),m(tt,{visible:Te.value,"onUpdate:visible":o[10]||(o[10]=t=>Te.value=t),type:"info",title:"Create New Folder","ok-text":"Create","cancel-text":"Cancel",onOk:Ot,onCancel:o[11]||(o[11]=t=>Te.value=!1),icon:n(Ue)},{default:k(()=>[r("div",Jn,[r("label",{class:i([[n(l).notTextDown],"text-sm block mb-2"])},"Folder name (max 255 characters)",2),m(n(no),{value:se.value,"onUpdate:value":o[9]||(o[9]=t=>se.value=t),placeholder:"Enter folder name...",onPressEnter:Ot,class:i([[n(l).scopeSelector,n(l).loginFormInput],"h-10"]),autofocus:"",maxlength:255},{prefix:k(()=>[m(n(x),{icon:n(oe),class:i([[n(l).formIcon],"mr-0.5 transition duration-300"]),width:"16",height:"16"},null,8,["icon","class"])]),_:1},8,["value","class"])])]),_:1},8,["visible","icon"]),m(tt,{visible:Fe.value,"onUpdate:visible":o[13]||(o[13]=t=>Fe.value=t),type:"info",title:"Rename Item","ok-text":"Rename","cancel-text":"Cancel",onOk:Nt,onCancel:o[14]||(o[14]=t=>Fe.value=!1),icon:n(ye)},{default:k(()=>[r("div",ea,[r("label",{class:i([[n(l).notTextDown],"text-sm block mb-2"])},"New name (max 255 characters)",2),m(n(no),{value:le.value,"onUpdate:value":o[12]||(o[12]=t=>le.value=t),placeholder:"Enter new name...",onPressEnter:Nt,class:i([[n(l).scopeSelector,n(l).loginFormInput],"h-10"]),autofocus:"",maxlength:255},{prefix:k(()=>[m(n(x),{icon:n(ye),class:i([[n(l).formIcon],"mr-0.5 transition duration-300"]),width:"16",height:"16"},null,8,["icon","class"])]),_:1},8,["value","class"])])]),_:1},8,["visible","icon"]),m(tt,{visible:Me.value,"onUpdate:visible":o[15]||(o[15]=t=>Me.value=t),type:"info",title:"Folder Upload Detected","ok-text":"Upload Folder","cancel-text":"Cancel",onOk:Eo,onCancel:Po,icon:n(No),width:480,"reverse-buttons":!0},{default:k(()=>[r("div",ta,[r("p",{class:i([[n(l).notTextDown],"text-sm leading-relaxed"])},[o[22]||(o[22]=P(" You are about to upload ",-1)),r("strong",null,g(G.value?.allFiles.length||0)+" files",1),o[23]||(o[23]=P(" across ",-1)),r("strong",null,g(G.value?.folders.length||0)+" directories",1),o[24]||(o[24]=P(". Each file will be encrypted individually, which can be resource-intensive for large folders. ",-1))],2),r("div",{class:i([[n(l).dropZoneTotalSizeScope],"rounded-lg p-3.5 space-y-2.5"])},[r("p",oa,[m(n(x),{icon:n(kt),class:"w-5 h-5"},null,8,["icon"]),o[25]||(o[25]=r("span",null,"ZIP Before Uploading",-1))]),o[32]||(o[32]=r("p",{class:"text-xs leading-relaxed"},"Cancel this upload and manually compress the folder to a ZIP file first. Then upload that single ZIP file instead:",-1)),r("ul",na,[r("li",null,[o[26]||(o[26]=P(" Encrypt ",-1)),o[27]||(o[27]=r("strong",null,"1 file",-1)),o[28]||(o[28]=P(" instead of ",-1)),r("strong",null,g(G.value?.allFiles.length||0)+" files",1)]),o[29]||(o[29]=r("li",null,[r("strong",null,"Much faster"),P(" upload and encryption")],-1)),o[30]||(o[30]=r("li",null,[r("strong",null,"Less resource intensive"),P(" on the server")],-1)),o[31]||(o[31]=r("li",null,[r("strong",null,"Easier"),P(" to download and restore later")],-1))])],2)])]),_:1},8,["visible","icon"]),m(n(en),{fileList:Le.value,"onUpdate:fileList":o[16]||(o[16]=t=>Le.value=t),name:"file",multiple:!0,customRequest:To,onChange:Co,showUploadList:!1,class:"fixed bottom-10 right-2 z-50 hidden max-[900px]:block"},{default:k(()=>[r("button",{class:i([[n(l).dropZoneSortButton],"w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-transform duration-300 active:scale-95 border-none cursor-pointer"]),title:"Upload Files"},[m(n(x),{icon:n(Wo),class:"w-6 h-6"},null,8,["icon"])],2)]),_:1},8,["fileList"]),m(we,{name:"upload-slide-up"},{default:k(()=>[n(T).isUploading?(u(),p("div",{key:0,class:i(["border-t",[n(l).dropZoneDragHolder,n(l).scopeSelector]])},[r("div",{class:i([n(l).hrSelector])},null,2),r("div",{onClick:o[17]||(o[17]=t=>Ce.value=!Ce.value),class:"flex items-center gap-2 h-7 pb-0.5 px-3 cursor-pointer hover:opacity-80 transition-opacity"},[r("div",aa,[(u(),p("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",class:i([[n(l).dropZoneDragIcon],"flex-shrink-0"])},[...o[33]||(o[33]=[r("rect",{width:"24",height:"24",fill:"none"},null,-1),r("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.3"},[r("path",{"stroke-dasharray":"2 4","stroke-dashoffset":"6",d:"M12 21c-4.97 0 -9 -4.03 -9 -9c0 -4.97 4.03 -9 9 -9"},[r("animate",{attributeName:"stroke-dashoffset",dur:"0.6s",repeatCount:"indefinite",values:"6;0"})]),r("path",{"stroke-dasharray":"32","stroke-dashoffset":"32",d:"M12 3c4.97 0 9 4.03 9 9c0 4.97 -4.03 9 -9 9"},[r("animate",{fill:"freeze",attributeName:"stroke-dashoffset",begin:"0.1s",dur:"0.4s",values:"32;0"})]),r("path",{"stroke-dasharray":"10","stroke-dashoffset":"10",d:"M12 16v-7.5"},[r("animate",{fill:"freeze",attributeName:"stroke-dashoffset",begin:"0.5s",dur:"0.2s",values:"10;0"})]),r("path",{"stroke-dasharray":"6","stroke-dashoffset":"6",d:"M12 8.5l3.5 3.5M12 8.5l-3.5 3.5"},[r("animate",{fill:"freeze",attributeName:"stroke-dashoffset",begin:"0.7s",dur:"0.2s",values:"6;0"})])],-1)])],2)),r("span",{class:i([[n(l).dropZoneDragUpText],"text-[10px] leading-none truncate"])},g(_e.value)+" of "+g(ae.value),3)]),r("div",sa,[m(n(Ct),{percent:mo.value,class:i([[n(l).scopeSelector],"rounded-full flex-1"]),"show-info":!1,size:2,status:"active"},null,8,["percent","class"])]),m(n(x),{icon:n(Ko),class:i([[n(l).dropZoneFileIcon,"transition-transform duration-200",Ce.value&&"rotate-180"],"w-3.5 h-3.5 flex-shrink-0"])},null,8,["icon","class"])]),m(we,{name:"expand-height"},{default:k(()=>[Ce.value?(u(),p("div",{key:0,class:i([n(l).dropZoneFileDisplayer])},[r("div",{class:i([n(l).hrSelector])},null,2),r("div",la,[(u(!0),p(U,null,he(n(T).currentlyUploading,(t,a)=>(u(),p(U,{key:t.uid},[r("div",ra,[r("div",ia,[m(n(x),{icon:n(ge),class:i([[n(l).dropZoneFileIcon],"w-3.5 h-3.5 flex-shrink-0"])},null,8,["icon","class"]),r("div",ca,[r("div",ua,[r("p",{class:i([[n(l).dropZoneFileText],"text-[11px] font-medium truncate flex-1"]),title:t.name},g(t.name),11,da),r("span",{class:i([[n(l).dropZoneFileSize],"text-[9px] font-semibold px-1 rounded whitespace-nowrap"])},g(n(T).uploadProgress[t.uid]||0)+"% ",3)]),m(n(Ct),{percent:n(T).uploadProgress[t.uid]||0,class:i([[n(l).scopeSelector],"rounded-full"]),"show-info":!1,size:1.5,status:"active"},null,8,["percent","class"])])])]),a<n(T).currentlyUploading.length-1||n(T).queue.length>0?(u(),p("div",{key:0,class:i([n(l).hrSelector])},null,2)):b("",!0)],64))),128)),(u(!0),p(U,null,he(n(T).queue.slice(0,3),(t,a)=>(u(),p(U,{key:t.uid},[r("div",pa,[r("div",ma,[m(n(x),{icon:n(ge),class:i([[n(l).dropZoneFileIcon],"w-3.5 h-3.5 flex-shrink-0"])},null,8,["icon","class"]),r("div",va,[r("p",{class:i([[n(l).dropZoneFileText],"text-[11px] truncate flex-1"]),title:t.name},g(t.name),11,fa),r("span",{class:i([[n(l).dropZoneFileSize],"text-[9px] font-medium px-1 rounded whitespace-nowrap"])}," Waiting... ",2)])])]),a<Math.min(2,n(T).queue.length-1)?(u(),p("div",{key:0,class:i([n(l).hrSelector])},null,2)):b("",!0)],64))),128)),n(T).queue.length>3?(u(),p(U,{key:0},[r("div",{class:i([n(l).hrSelector])},null,2),r("div",ha,[r("span",{class:i([[n(l).dropZoneFilesCount],"text-[9px] opacity-60"])}," And "+g(n(T).queue.length-3)+" more in queue... ",3)])],64)):b("",!0)])],2)):b("",!0)]),_:1})],2)):b("",!0)]),_:1}),m(mn,{visible:Ve.value,message:Bt.value,position:"bottom-left"},null,8,["visible","message"]),m(Qo,{icon:n(ge),message:xo.value,info:ho.value,showHelp:!0},{help:k(()=>[r("div",ga,[r("div",xa,[m(n(x),{icon:n(ge),class:i(["w-5 h-5",n(l).statusBarIcon])},null,8,["icon","class"]),r("h4",{class:i(["text-base font-semibold",n(l).statusBarText])},"Drop Zone",2)]),r("div",{class:i(["text-[10px] md:text-xs space-y-2 leading-relaxed",n(l).statusBarInfo])},[...o[34]||(o[34]=[r("p",null,"Your personal encrypted cloud storage built into HomeDock OS. Every file you upload is automatically encrypted with military-grade AES-256-GCM encryption before being stored. Simply drag and drop your files. HomeDock OS encrypts and signs them instantly using your unique user key. Only you can decrypt and access your files.",-1)])],2)])]),_:1},8,["icon","message","info"])],32))}}),Ja=co(ba,[["__scopeId","data-v-6d92c544"]]);export{Ja as default};
