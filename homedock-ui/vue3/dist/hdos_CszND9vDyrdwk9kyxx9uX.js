import{d as ee,r as g,u as oe,y as B,o as te,c as x,e as r,b as l,n,f as t,h as y,F as I,a as _,j as ae,A as re,k as se,l as le,N as ne,I as C,M as ie,t as z,_ as ce,p as de,q as pe}from"./hdos_CoDNShsS-lCB4NlaMkpGR.js";import{_ as ue,C as me,N as he,f as Z,F as fe,g as ve}from"./hdos_1rkZlHica8T3hzfqAaSIX.js";import{a as b}from"./hdos_COAQqH6lKP34bBHUg8dJ6.js";import{d as ge}from"./hdos_DPhlMBAcwmj4N6C-RIU0v.js";import{A as ye}from"./hdos_DBWWGo_PQkZ00Zhn_Y4om.js";import{a as d}from"./hdos_KBssJoGkwpZmkJjm2Io7Z.js";import{a as we}from"./hdos_D795XcLFT5VjAgvrudzE3.js";import{E as xe,B as E}from"./hdos_Bcoy0t8m2roJz4NDgj-hv.js";import{A as _e}from"./hdos_C9mF4YfxuW7h7JVpNd2Dg.js";import{a as Ce}from"./hdos_Bn3JqfyO8fMV0X1hTGHk3.js";import"./hdos_DarGlGEsAjzV48-0UxjY5.js";import"./hdos_BosuxZz1dT6oamTSRRrG0.js";import"./hdos_BeLpmO1Bu0zJ7VfOvsUCZ.js";import"./hdos_BDCLtoVuwDW-dc9E7vWsA.js";import"./hdos_D_88u1OB2E7XDhR_9sNXd.js";import"./hdos_C-WCNTAcKlsIi7NhNoBql.js";import"./hdos_0vcdwfPabIVdfuejzwapH.js";import"./hdos_id2O4LhmM7SUi8tqysWrM.js";import"./hdos_DCrDFtCw9tDUNWYxsF-hW.js";const T={width:24,height:24,body:'<path fill="currentColor" d="M10 4H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-8l-2-2Z"/>'},L={width:24,height:24,body:'<path fill="currentColor" d="M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2m9 16v-2H6v2h9m3-4v-2H6v2h12Z"/>'},F={width:24,height:24,body:'<path fill="currentColor" d="M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2m0 18h12v-8l-4 4l-2-2l-6 6M8 9a2 2 0 0 0-2 2a2 2 0 0 0 2 2a2 2 0 0 0 2-2a2 2 0 0 0-2-2Z"/>'},U={width:24,height:24,body:'<path fill="currentColor" d="M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2m11 17v-6l-3 2.2V13H7v6h7v-2.2l3 2.2Z"/>'},A={width:24,height:24,body:'<path fill="currentColor" d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6m-1 11h-2v5a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2c.4 0 .7.1 1 .3V11h3v2m0-4V3.5L18.5 9H13Z"/>'},j={width:24,height:24,body:'<path fill="currentColor" d="M20 6h-8l-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m-2 6h-2v2h2v2h-2v2h-2v-2h2v-2h-2v-2h2v-2h-2V8h2v2h2v2Z"/>'},be={width:24,height:24,body:'<path fill="currentColor" d="M13 9V3.5L18.5 9M6 2c-1.11 0-2 .89-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6H6Z"/>'},Le={width:24,height:24,body:'<path fill="currentColor" d="M10 4h4v9l3.5-3.5l2.42 2.42L12 19.84l-7.92-7.92L6.5 9.5L10 13V4Z"/>'},ke={width:24,height:24,body:'<path fill="currentColor" d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"/>'},Fe={width:24,height:24,body:'<path fill="currentColor" d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12c5.16-1.26 9-6.45 9-12V5l-9-4m0 6c1.4 0 2.8 1.1 2.8 2.5V11c.6 0 1.2.6 1.2 1.3v3.5c0 .6-.6 1.2-1.3 1.2H9.2c-.6 0-1.2-.6-1.2-1.3v-3.5c0-.6.6-1.2 1.2-1.2V9.5C9.2 8.1 10.6 7 12 7m0 1.2c-.8 0-1.5.5-1.5 1.3V11h3V9.5c0-.8-.7-1.3-1.5-1.3Z"/>'},Ve={width:24,height:24,body:'<path fill="currentColor" d="M18 8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2h9V6a3 3 0 0 0-3-3a3 3 0 0 0-3 3H7a5 5 0 0 1 5-5a5 5 0 0 1 5 5v2h1m-6 9a2 2 0 0 0 2-2a2 2 0 0 0-2-2a2 2 0 0 0-2 2a2 2 0 0 0 2 2Z"/>'},Se={class:"flex flex-col min-h-screen"},Ze={class:"top-0 left-0 z-10"},$e={class:"flex flex-1 overflow-hidden"},De={class:"hidden lg:block relative"},He={class:"flex-1 overflow-auto max-w-full holder"},Me={class:"flex items-center align-center justify-center flex-col"},Be={class:"ant-upload-drag-icon"},Ie={class:"mt-4"},ze={key:0,class:"flex justify-center items-center"},Ee={key:1,class:"grid grid-cols-[repeat(auto-fill,minmax(100px,1fr))] lg:grid-cols-[repeat(auto-fill,minmax(180px,1fr))] gap-4"},Te={class:"mt-2 flex space-x-2"},Ue=ee({__name:"Dropzone",setup(i){var M;const h=e=>{var a;if(e.endsWith("/"))return T;const o=(a=e.split(".").pop())==null?void 0:a.toLowerCase();return f[o||"unknown"]||be},f={folder:T,txt:L,md:L,doc:L,docx:L,pdf:L,png:F,jpg:F,jpeg:F,gif:F,mp4:U,mkv:U,mp3:A,wav:A,zip:j,rar:j},m=g(((M=document.querySelector('meta[name="homedock_csrf_token"]'))==null?void 0:M.getAttribute("content"))||""),{themeClasses:s}=oe(),N=g("/drop-zone"),w=g([]),p=g(""),k=g([]),V=g({}),q=async e=>{const{file:o,onSuccess:a,onError:c}=e;try{await X(o),k.value=k.value.filter(v=>v.uid!==o.uid),a(null,o)}catch(v){c(v)}},X=async e=>{var a,c,v;const o=new FormData;o.append("file",e);try{const u=await b.post("/api/upload_file",o,{headers:{"X-HomeDock-CSRF-Token":m.value}});u.data.success||(d.error(u.data.error.value||"Upload failed"),console.error("Error during file upload:",u.data.error))}catch(u){b.isAxiosError(u)?((a=u.response)==null?void 0:a.status)===413?d.error("The selected file is larger than 1GB."):d.error(((v=(c=u.response)==null?void 0:c.data)==null?void 0:v.error_message)||`Unexpected error occurred: ${u.message}`):d.error("An unknown error occurred. Please try again."),console.error("Upload error:",u)}},G=async e=>{try{V.value[e]=!0;const o=await b.get(`/api/download_file?file=${encodeURIComponent(e)}`,{headers:{"X-HomeDock-CSRF-Token":m.value},responseType:"blob"}),a=window.URL.createObjectURL(new Blob([o.data])),c=document.createElement("a");c.href=a,c.setAttribute("download",e),document.body.appendChild(c),c.click(),document.body.removeChild(c),setTimeout(()=>{V.value[e]=!1},2e3)}catch(o){console.error("Error downloading file:",o),d.error("Failed to download file. Please try again.")}},O=async e=>{try{const o=await b.post("/api/delete_file",{file:e},{headers:{"X-HomeDock-CSRF-Token":m.value}});o.data.success?(d.success(o.data.message),S()):d.error(o.data.error||"Failed to delete file")}catch(o){console.error("Error deleting file:",o),d.error("Failed to delete file. Please try again.")}},S=async()=>{try{const e=await b.get("/api/get_files",{headers:{"X-HomeDock-CSRF-Token":m.value}});w.value=e.data.files||[]}catch(e){console.error("Error fetching files:",e),d.error("Failed to fetch files. Please try again.")}},W=B(()=>p.value?w.value.filter(e=>e.name.toLowerCase().includes(p.value.toLowerCase())).map(e=>({value:e.name,label:e.name})):w.value.map(e=>({value:e.name,label:e.name}))),H=B(()=>p.value?w.value.filter(e=>e.name.toLowerCase().includes(p.value.toLowerCase())):w.value),J=e=>{const o=typeof e=="object"?e.value:e;p.value=o.toString(),d.info(`Selected: ${o}`)},K=e=>{e.file.status==="done"?d.success(`${e.file.name} uploaded successfully`):e.file.status==="error"&&d.error(`${e.file.name} upload failed.`)};function Q(e){const o=typeof e=="number"?e:parseFloat(e);return o>=1e9?(o/1e9).toFixed(2)+" GBs":o>=1e6?(o/1e6).toFixed(2)+" MBs":o>=1e3?(o/1e3).toFixed(2)+" KBs":o+" B"}const Y=()=>{S()};return te(()=>{S()}),(e,o)=>(_(),x(I,null,[r(ae),r(re),r(se),r(le),r(ne),l("div",Se,[l("header",Ze,[r(he)]),o[3]||(o[3]=l("div",{class:"h-24"},null,-1)),l("div",$e,[l("aside",De,[r(ue,{activePath:N.value},null,8,["activePath"])]),l("div",{class:n([[t(s).back],"flex flex-col flex-1 pl-4 pt-3 pr-4 max-w-full overflow-x-hidden"])},[l("main",He,[r(me,{title:"Drop Zone",body:"Locally encrypted file vault",mdi_icon:t(Z),id:"dropZoneUp",collapsible:!1},{default:y(()=>[r(t(we),{class:n([t(s).dropZoneDragHolder,t(s).scopeSelector]),fileList:k.value,"onUpdate:fileList":o[0]||(o[0]=a=>k.value=a),name:"file",multiple:!0,customRequest:q,onChange:K,onSuccess:Y,showUploadList:!0},{default:y(()=>[l("div",Me,[l("p",Be,[r(ye,{icons:[t(Z),t(Fe)],iconSize:64,interval:2e3,class:n([[t(s).dropZoneDragIcon],"text-4xl"])},null,8,["icons","class"])]),l("p",{class:n([[t(s).dropZoneDragUpText],"ant-upload-text px-4"])},"Click or drag files to this area to upload and encrypt its content",2),l("p",{class:n([[t(s).dropZoneDragDownText],"ant-upload-hint px-4"])},"Maximum file size allowed per file is 1GB",2)])]),_:1},8,["class","fileList"]),l("div",Ie,[r(t(_e),{value:p.value,"onUpdate:value":o[2]||(o[2]=a=>p.value=a),options:W.value,"popup-class-name":`${t(s).scopeSelector} z-0`,class:"w-full mb-4",onSelect:J},{default:y(()=>[r(t(Ce),{value:p.value,"onUpdate:value":o[1]||(o[1]=a=>p.value=a),placeholder:"Search files...",class:n([[t(s).scopeSelector],"w-full text-sm"]),"enter-button":"Search"},{prefix:y(()=>[r(t(C),{icon:t(Z),class:n([[t(s).dropZoneInputIcon],"mx-1"])},null,8,["icon","class"])]),_:1},8,["value","class"])]),_:1},8,["value","options","popup-class-name"]),l("div",null,[H.value.length===0?(_(),x("div",ze,[r(t(xe),{class:n([t(s).dropZoneEmptyText]),description:"No encrypted files found"},null,8,["class"])])):(_(),x("div",Ee,[(_(!0),x(I,null,ie(H.value,a=>(_(),x("div",{key:a.name,class:n([[t(s).dropZoneFileDisplayer],"relative flex flex-col items-center justify-center text-center border border-dashed rounded-lg p-4 shadow-sm hover:shadow-md group transition duration-300"])},[r(t(C),{icon:V.value[a.name]?t(Ve):t(ge),class:n([[t(s).dropZoneLockIcon],"absolute right-2 top-2 transition duration-300 h-4 w-4 min-h-4 min-w-4"])},null,8,["icon","class"]),r(t(C),{icon:h(a.name),class:n([[t(s).dropZoneFileIcon],"h-12 w-12 min-h-12 min-w-12 transition duration-300 group-hover:scale-110"])},null,8,["icon","class"]),l("span",{class:n([[t(s).dropZoneFileText],"mt-2 text-xs break-words w-full overflow-hidden text-ellipsis"])},z(a.name),3),l("span",{class:n([[t(s).dropZoneFileSize],"px-2 rounded-full text-[10px] mt-1"])},z(Q(a.size)),3),l("div",Te,[r(t(E),{type:"primary",onClick:c=>G(a.name),size:"small"},{default:y(()=>[r(t(C),{icon:t(Le)},null,8,["icon"])]),_:2},1032,["onClick"]),r(t(E),{type:"dashed",onClick:c=>O(a.name),size:"small",class:n([t(s).dropZoneDeleteIcon])},{default:y(()=>[r(t(C),{icon:t(ke),class:"transition duration-300 group-hover:rotate-90"},null,8,["icon"])]),_:2},1032,["onClick","class"])])],2))),128))]))])])]),_:1},8,["mdi_icon"])]),r(fe)],2)])])],64))}}),Ae=ce(Ue,[["__scopeId","data-v-8e65f356"]]);function D(i){var f;const h=(f=document.getElementById(i))==null?void 0:f.textContent;if(h)try{const m=atob(h);return JSON.parse(m)}catch(m){console.error(`Error parsing data from element #${i}:`,m)}else console.error(`Element with ID '${i}' not found or is empty.`);return null}const $=D("data-theme"),P=D("data-common"),R=D("data-settings");if($&&P&&R)try{const i=de(Ae),h=ve();i.use(h),i.provide("data-theme",{selectedTheme:$.selected_theme,selectedBack:$.selected_back}),i.provide("data-common",{version:P.version}),i.provide("data-settings",{userName:R.user_name});const f=pe();i.use(f),i.mount("#app-dropzone-root")}catch(i){console.error("Error initializing the Vue app:",i)}else console.error("Required data (data-theme or data-initial) is missing or invalid.");
