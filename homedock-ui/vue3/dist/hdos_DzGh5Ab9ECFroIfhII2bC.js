import{d as j,r as f,u as B,w as de,c as H,a as _,n as r,f as e,b as t,e as o,_ as M,t as w,i as m,I as b,j as z,U as O,x as T,g as W,T as E,m as P,p as G,h as pe,o as ue,F as me,A as fe,k as he,l as ve,N as xe,q as ge,s as ye}from"./hdos_4MoF3zB23zef3jSm2ETrq.js";import{e as be,N as Ce,_ as ke,l as we,C as _e,F as $e,g as Ae}from"./hdos_BOUUFpx0mHsUX4RAml6OD.js";import{d as K,a as L}from"./hdos_C8xfccjiB6DoCk5KlfHGx.js";import{d as He}from"./hdos_DPi7gOmHlKdoQ5BrTSdrp.js";import{B as A}from"./hdos_APxuSPDSM2iUcXfj8v0F7.js";import{U as Re}from"./hdos_CbK3iqu-_OnadzdSdKhz1.js";import{M as q,L as Se,a as Le}from"./hdos_BJpsWbyxZZDtFf3FOyD4t.js";import{a as y}from"./hdos_rMZ54wfCs-Vx-rakPJAd-.js";import{S as Te}from"./hdos_DnRqqkbaW4UpUuXj5XU3x.js";import{A as Ie}from"./hdos_CpeBndVdo6_H7OWtyKTJ2.js";import{d as Me,a as Z,b as X,c as Ee}from"./hdos_QgvgDrSMZvumAUDmNg88v.js";import{f as Ve}from"./hdos_DKJKxR37A4IfHl_oFFJ2m.js";import"./hdos_Ch93gTfXVKYxV50arzJrL.js";import"./hdos_D6-XlEtGdUWrcdOe4mzvB.js";import"./hdos_DIW5ggx0xDPkViD4p7Rbx.js";import"./hdos_DpmV9qPdMp6XTZy7EJL54.js";import"./hdos_xFOMHVyM_QR1dEx9ThaNu.js";import"./hdos_Bhjtyt3T6PRrh5723o4-Z.js";import"./hdos_CclHuW4NXV-OuQtK4aC_-.js";import"./hdos_BS38FOwh92hJUI5ZLI1QK.js";import"./hdos_CL6H4rrCSR4ZK7Bv7nJ9v.js";import"./hdos_Lj0eB7prpdPR278PSjgJG.js";const je={width:24,height:24,body:'<path fill="currentColor" d="M12 1L8 5h3v9h2V5h3m2 18H6a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h3v2H6v12h12V9h-3V7h3a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2Z"/>'},Be={width:24,height:24,body:'<path fill="currentColor" d="M8 3a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2H3v2h1a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h2v-2H8v-5a2 2 0 0 0-2-2a2 2 0 0 0 2-2V5h2V3m6 0a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2h-2v-2h2v-5a2 2 0 0 1 2-2a2 2 0 0 1-2-2V5h-2V3h2Z"/>'},De={width:24,height:24,body:'<path fill="currentColor" d="M17.8 20c-.4 1.2-1.5 2-2.8 2H5c-1.7 0-3-1.3-3-3v-1h12.2c.4 1.2 1.5 2 2.8 2h.8M19 2c1.7 0 3 1.3 3 3v1h-2V5c0-.6-.4-1-1-1s-1 .4-1 1v13h-1c-.6 0-1-.4-1-1v-1H5V5c0-1.7 1.3-3 3-3h11M8 6v2h7V6H8m0 4v2h6v-2H8Z"/>'},Ne={width:24,height:24,body:'<path fill="currentColor" d="M10.59 13.41c.41.39.41 1.03 0 1.42c-.39.39-1.03.39-1.42 0a5.003 5.003 0 0 1 0-7.07l3.54-3.54a5.003 5.003 0 0 1 7.07 0a5.003 5.003 0 0 1 0 7.07l-1.49 1.49c.01-.82-.12-1.64-.4-2.42l.47-.48a2.982 2.982 0 0 0 0-4.24a2.982 2.982 0 0 0-4.24 0l-3.53 3.53a2.982 2.982 0 0 0 0 4.24m2.82-4.24c.39-.39 1.03-.39 1.42 0a5.003 5.003 0 0 1 0 7.07l-3.54 3.54a5.003 5.003 0 0 1-7.07 0a5.003 5.003 0 0 1 0-7.07l1.49-1.49c-.01.82.12 1.64.4 2.43l-.47.47a2.982 2.982 0 0 0 0 4.24a2.982 2.982 0 0 0 4.24 0l3.53-3.53a2.982 2.982 0 0 0 0-4.24a.973.973 0 0 1 0-1.42Z"/>'},Ue={width:24,height:24,body:'<path fill="currentColor" d="M10.5 3H18v4h-7.5C8.57 7 7 8.57 7 10.5S8.57 14 10.5 14H13v-4l7 6l-7 6v-4h-2.5C6.36 18 3 14.64 3 10.5S6.36 3 10.5 3Z"/>'},Fe={class:"app-header flex items-center space-x-4"},ze={class:"flex flex-col justify-center overflow-hidden"},Oe={class:"button-container grid grid-cols-2 gap-2 mt-3"},Pe={class:"app-details flex items-center space-x-4"},qe={class:"flex flex-col justify-center"},Ze={class:"space-x-2 mt-2 flex"},Xe={class:"app-details flex items-center space-x-4"},Ye={class:"flex flex-col justify-center"},Je={class:"flex items-center"},We="docker-icons/notfound.jpg",Ge=j({__name:"ControlHubApp",props:{app:{type:Object,required:!0}},setup(n){var F;const i=n,v=f(!1),d=f(!1),p=f(""),x=f(""),R=i.app.name?`docker-icons/${i.app.name}.jpg`:We,S=f([]),g=f(!1),h=f("Save and Recreate"),I=f(!1),$=f()||3e3,C=((F=document.querySelector('meta[name="homedock_csrf_token"]'))==null?void 0:F.getAttribute("content"))||"",Q={"X-HomeDock-CSRF-Token":C},{themeClasses:u}=B(),ee=async l=>{await N(l),v.value=!0},ae=async l=>{await U(l),d.value=!0},te=(l,a)=>{(typeof l=="boolean"?l:l==="true")?$.value=setInterval(()=>{U(i.app.name)},3e3):(clearInterval($.value),$.value=null)},N=async l=>{var a,s;try{const c=await L.get("/api/get-compose-info",{headers:{"X-HomeDock-CSRF-Token":C},params:{containerName:l}});(s=(a=c.data)==null?void 0:a.data)!=null&&s.ymlContent&&c.data.data.ymlContent.trim()!==""?p.value=c.data.data.ymlContent:p.value="No content found for this application."}catch(c){console.error("Error fetching application info:",c),p.value="Failed to fetch application information."}},oe=async()=>{var l,a;try{(await L.post("/api/update-yml-config",{containerName:i.app.name,ymlContent:p.value,homedock_csrf_token:C})).data.success?y.success("Configuration saved successfully!"):y.error("Failed to save the configuration. Please check the YML format.")}catch(s){console.error("Error saving compose:",s);const c=((a=(l=s.response)==null?void 0:l.data)==null?void 0:a.message)||"Unknown error";y.error(`Error: ${c}`)}},se=()=>{h.value==="Click again to confirm"?ne():h.value="Click again to confirm"},ne=async()=>{g.value=!0;try{(await L.post("/api/update-yml-config",{containerName:i.app.name,ymlContent:p.value,homedock_csrf_token:C})).data.success?(h.value="Recreating...",(await L.post("/api/recreate-container",{container_name:i.app.name,yml_content:p.value,homedock_csrf_token:C})).data.message?(y.success("Application recreated successfully!"),h.value="Save and Recreate"):y.error("Failed to recreate the application.")):y.error("Failed to update the configuration file.")}catch(l){console.error("Error during application recreation:",l),y.error("An error occurred. Please check the logs.")}finally{g.value=!1}},le=async l=>{try{await N(l),p.value.trim()!==""?re(p.value,`${l}.yml`):console.error("No compose configuration available to export.")}catch(a){console.error("Error exporting compose configuration:",a)}},re=(l,a)=>{const s=new Blob([l],{type:"text/yaml;charset=utf-8;"}),c=document.createElement("a"),k=URL.createObjectURL(s);c.setAttribute("href",k),c.setAttribute("download",a),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(k)},U=async l=>{var a;try{const s=await L.get("/api/view-container-logs",{headers:{"X-HomeDock-CSRF-Token":C},params:{containerName:l}});(a=s.data)!=null&&a.logs&&s.data.logs.trim()!==""?x.value=s.data.logs:x.value="No logs found for this application."}catch(s){console.error("Error fetching application logs:",s),x.value="Failed to fetch logs for this application."}},ie=async({file:l,onSuccess:a,onError:s})=>{const c=new FormData;c.append("compose_file",l),c.append("container_name",i.app.name),c.append("homedock_csrf_token",C||"");try{const k=await fetch("/api/upload_compose_file",{method:"POST",headers:{"X-HomeDock-CSRF-Token":C||""},body:c});if(k.ok){const ce=await k.json();a(ce,l),y.success(`${l.name} uploaded succesfully for ${i.app.name} application.`)}else throw new Error("Upload failed")}catch(k){console.error("Upload error:",k),s(k),y.error(`${l.name} upload failed.`)}};return de(d,l=>{!l&&$.value&&(clearInterval($.value),$.value=null,I.value=!1)}),(l,a)=>(_(),H("div",{class:r([[e(u).hubContMainer],"relative flex-1 border rounded-2xl p-3 shadow-sm transition-shadow duration-300 hover:shadow-lg"])},[t("div",Fe,[o(M,{draggable:"false",src:e(R),alt:n.app.name,class:r([[e(u).hubIconHolder],"app-icon w-12 h-12 rounded-xl drop-shadow-md ring-[1px]"])},null,8,["src","alt","class"]),t("div",ze,[t("h3",{class:r([[e(u).hubCardTextAppName],"font-semibold text-xs truncate"])},w(n.app.name),3),t("h4",{class:r([[e(u).hubCardTextRepo],"font-normal text-xs truncate ellipsis"])},w(n.app.image),3)])]),t("hr",{class:r([[e(u).hubSeparator],"border-0 h-px mt-3 bg-gray-200"])},null,2),t("div",Oe,[o(e(A),{class:r([[e(u).storeLinkHDOSButton],"flex items-center justify-center !rounded-xl py-1 transition-all duration-300"]),ref:"exportButton",onClick:a[0]||(a[0]=s=>le(n.app.name)),type:"dashed",size:"small",block:""},{default:m(()=>[o(e(b),{icon:e(je),class:"mr-1 h-3 w-3"},null,8,["icon"]),a[9]||(a[9]=t("span",null,"Export",-1))]),_:1},8,["class"]),o(e(Re),{"custom-request":ie,"file-list":S.value,"onUpdate:fileList":a[1]||(a[1]=s=>S.value=s),accept:"yml",maxCount:1,showUploadList:!1,headers:Q},{default:m(()=>[o(e(A),{class:r([[e(u).storeLinkHDOSButton],"w-full flex items-center justify-center !rounded-xl py-1 transition-all duration-300"]),type:"dashed",size:"small"},{default:m(()=>[o(e(b),{icon:e(Ne),class:"mr-1 h-3 w-3"},null,8,["icon"]),a[10]||(a[10]=t("span",null,"Import",-1))]),_:1},8,["class"])]),_:1},8,["file-list"]),o(e(A),{ref:"editButton",onClick:a[2]||(a[2]=s=>ee(n.app.name)),type:"primary",size:"small",block:"",class:"flex items-center justify-center !rounded-xl py-1 transition-all duration-300"},{default:m(()=>[o(e(b),{icon:e(Be),class:"mr-1 h-3 w-3"},null,8,["icon"]),a[11]||(a[11]=t("span",null,"Edit",-1))]),_:1},512),o(e(A),{ref:"logsButton",onClick:a[3]||(a[3]=s=>ae(n.app.name)),type:"primary",size:"small",block:"",class:"flex items-center justify-center !rounded-xl py-1 transition-all duration-300"},{default:m(()=>[o(e(b),{icon:e(De),class:"mr-1 h-3 w-3"},null,8,["icon"]),a[12]||(a[12]=t("span",null,"Logs",-1))]),_:1},512)]),o(e(q),{class:r([[e(u).scopeSelector],"rounded-3xl overflow-hidden"]),maskClosable:!g.value,keyboard:!g.value,closable:!g.value,open:v.value,"onUpdate:open":a[5]||(a[5]=s=>v.value=s),destroyOnClose:!0,footer:null,centered:!0,"wrap-class-name":"full-modal"},{default:m(()=>[t("div",Pe,[o(M,{draggable:"false",src:e(R),alt:"App Icon",class:"app-icon w-12 h-12 min-w-12 min-h-12 rounded-xl drop-shadow-md ring-[1px] ring-gray-500/10"},null,8,["src"]),t("div",qe,[t("p",{class:r([[e(u).hubCardTextAppName],"app-name font-bold text-xs"])},w(n.app.name)+" config",3),t("p",{class:r([[e(u).hubCardTextRepo],"app-docker-image text-xs"])},w(n.app.image),3)])]),t("hr",{class:r([[e(u).hubSeparator],"border-0 h-px mt-4"])},null,2),z(t("textarea",{class:r([[e(u).hubTextArea],"mt-4 rounded-lg w-full font-mono h-96 resize-none"]),"onUpdate:modelValue":a[4]||(a[4]=s=>p.value=s)},null,2),[[O,p.value]]),t("div",Ze,[o(e(A),{onClick:oe,type:"primary",class:"bg-blue-600 hover:!bg-blue-800 py-1 px-4 flex items-center"},{default:m(()=>[o(e(b),{icon:e(He),class:"mb-0.5 mr-1 h-3 w-3 min-w-3 min-h-3"},null,8,["icon"]),a[13]||(a[13]=t("span",null,"Save",-1))]),_:1}),o(e(A),{onClick:se,loading:g.value,type:"primary",class:"bg-indigo-600 hover:!bg-indigo-800 py-1 px-4 flex items-center"},{default:m(()=>[o(e(b),{icon:e(Ue),class:"mb-0.5 mr-1 h-3 w-3 min-w-3 min-h-3"},null,8,["icon"]),t("span",null,w(h.value),1)]),_:1},8,["loading"])])]),_:1},8,["class","maskClosable","keyboard","closable","open"]),o(e(q),{class:r([[e(u).scopeSelector],"rounded-3xl overflow-hidden"]),open:d.value,"onUpdate:open":a[8]||(a[8]=s=>d.value=s),destroyOnClose:!0,footer:null,centered:!0,"wrap-class-name":"full-modal"},{default:m(()=>[t("div",Xe,[o(M,{draggable:"false",src:e(R),alt:"App Icon",class:"app-icon w-12 h-12 min-w-12 min-h-12 rounded-xl drop-shadow-md ring-[1px] ring-gray-500/10"},null,8,["src"]),t("div",Ye,[t("p",{class:r([[e(u).hubCardTextAppName],"app-name font-bold text-xs"])},w(n.app.name)+" logs",3),t("p",{class:r([[e(u).hubCardTextRepo],"app-docker-image text-xs"])},w(n.app.image),3)])]),t("hr",{class:r([[e(u).hubSeparator],"border-0 h-px mt-4"])},null,2),z(t("textarea",{class:r([[e(u).hubTextArea],"mt-4 rounded-lg w-full font-mono h-96 resize-none"]),"onUpdate:modelValue":a[6]||(a[6]=s=>x.value=s),readonly:""},null,2),[[O,x.value]]),o(e(Te),{checked:I.value,"onUpdate:checked":a[7]||(a[7]=s=>I.value=s),onChange:te,class:"mt-2"},{checkedChildren:m(()=>[t("span",Je,[o(e(b),{icon:e(K),class:"mr-1 animate-spin"},null,8,["icon"]),a[14]||(a[14]=T()),a[15]||(a[15]=t("span",{class:"text-transparent"},".",-1))])]),unCheckedChildren:m(()=>a[16]||(a[16]=[t("span",{class:"flex items-center"},"Refresh",-1)])),_:1},8,["checked"])]),_:1},8,["class","open"])],2))}}),Ke=W(Ge,[["__scopeId","data-v-ab4e526f"]]),Qe={class:"relative"},ea={key:0,class:"absolute inset-0 h-32 flex justify-center items-center z-10"},aa={key:1,class:"flex flex-col justify-center items-center p-3 space-y-1"},ta=j({__name:"ControlHubRender",props:{apps:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1}},setup(n){const{themeClasses:i}=B();return(v,d)=>(_(),H("div",Qe,[o(E,{name:"fade"},{default:m(()=>[n.isLoading?(_(),H("div",ea,[o(e(b),{icon:e(K),class:"text-blue-600 animate-spin",width:"60",height:"60"},null,8,["icon"])])):P("",!0)]),_:1}),o(E,{name:"fade"},{default:m(()=>[n.isLoading?P("",!0):(_(),H(G,{key:0},[n.apps.length>0?(_(),pe(e(Le),{key:0,dataSource:n.apps.filter(p=>p.HDRole!=="dependency"),grid:{gutter:16,column:5,xs:1,sm:2,md:3,lg:3,xl:4,xxl:5},itemLayout:"horizontal"},{renderItem:m(({item:p})=>[o(E,null,{default:m(()=>[o(e(Se),{class:"!p-0"},{default:m(()=>[o(Ke,{app:p},null,8,["app"])]),_:2},1024)]),_:2},1024)]),_:1},8,["dataSource"])):(_(),H("div",aa,[o(Ie,{icons:[e(Me),e(Z),e(X),e(Ee),e(X),e(Z)],interval:1e3,iconSize:64,containerClass:e(i).noAppsIcon,class:"transition duration-500 hover:-translate-y-2 hover:scale-105"},null,8,["icons","containerClass"]),t("p",{class:r([[e(i).noAppsTextMain],"text-sm text-center text-balance"])},"Couldn't find any applications installed.",2),t("p",{class:r([[e(i).noAppsTextMain],"text-sm text-center text-balance flex items-center"])},[t("span",null,[d[1]||(d[1]=T(" Install your first application on the ")),t("a",{class:r([e(i).hyperLink,"inline-flex items-center ml-1"]),href:"/app-store"},[o(e(b),{icon:e(be),class:"mr-1"},null,8,["icon"]),d[0]||(d[0]=T("App Store "))],2),d[2]||(d[2]=T(". "))])],2)]))],64))]),_:1})]))}}),oa=W(ta,[["__scopeId","data-v-bf239a32"]]),sa={class:"flex flex-col min-h-screen"},na={class:"top-0 left-0 z-10"},la={class:"flex flex-1 overflow-hidden"},ra={class:"hidden lg:block relative"},ia={class:"flex-1 overflow-auto max-w-full holder"},ca=j({__name:"ControlHub",setup(n){var S;const i=f(((S=document.querySelector('meta[name="homedock_csrf_token"]'))==null?void 0:S.getAttribute("content"))||""),{themeClasses:v}=B(),d=f("/control-hub"),p=f([]),x=f(!0);async function R(g){try{x.value=!0;const h=await Ve(g);p.value=h}catch(h){console.error("Error loading containers:",h)}finally{x.value=!1}}return ue(()=>{R(i.value)}),(g,h)=>(_(),H(G,null,[o(me),o(fe),o(he),o(ve),o(xe),t("div",sa,[t("header",na,[o(Ce)]),h[0]||(h[0]=t("div",{class:"h-24"},null,-1)),t("div",la,[t("aside",ra,[o(ke,{activePath:d.value},null,8,["activePath"])]),t("div",{class:r([[e(v).back],"flex flex-col flex-1 pl-4 pt-3 pr-4 max-w-full overflow-x-hidden"])},[t("main",ia,[o(_e,{title:"Control Hub",body:"Streamline, supervise, synchronize...",mdi_icon:e(we),id:"controlHub",collapsible:!1},{default:m(()=>[o(oa,{apps:p.value,isLoading:x.value},null,8,["apps","isLoading"])]),_:1},8,["mdi_icon"])]),o($e)],2)])])],64))}});function D(n){var v;const i=(v=document.getElementById(n))==null?void 0:v.textContent;if(i)try{const d=atob(i);return JSON.parse(d)}catch(d){console.error(`Error parsing data from element #${n}:`,d)}else console.error(`Element with ID '${n}' not found or is empty.`);return null}const V=D("data-theme"),Y=D("data-common"),J=D("data-settings");if(V&&Y&&J)try{const n=ge(ca),i=Ae();n.use(i),n.provide("data-theme",{selectedTheme:V.selected_theme,selectedBack:V.selected_back}),n.provide("data-common",{version:Y.version}),n.provide("data-settings",{userName:J.user_name});const v=ye();n.use(v),n.mount("#app-controlhub-root")}catch(n){console.error("Error initializing the Vue app:",n)}else console.error("Required data (data-theme or data-initial) is missing or invalid.");
