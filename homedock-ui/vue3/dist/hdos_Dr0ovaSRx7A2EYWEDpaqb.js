import{d as j,r as f,u as B,w as ce,c as S,a as w,n as l,f as e,b as t,e as o,_ as M,t as k,i as p,I as y,j as F,S as z,x as T,g as J,T as E,m as O,p as W,h as de,o as pe,F as ue,A as me,k as fe,l as he,N as ve,q as xe,s as ge}from"./hdos_asf1A1hq5P3qtEqzLGgW_.js";import{e as ye,N as be,_ as Ce,m as ke,C as we,g as _e,h as $e}from"./hdos_B4Z-9bD8qGNCU0AV0VHmA.js";import{d as G,a as L}from"./hdos_ZuyTpYrcYivltUvmUJTsw.js";import{d as Se}from"./hdos_DPi7gOmHlKdoQ5BrTSdrp.js";import{B as $}from"./hdos_DrBNmRuLfukPvo8fUCfT8.js";import{U as Ae}from"./hdos_CtKcEtlRKB5NI6RoPmeKi.js";import{M as P,L as He,a as Re}from"./hdos_YgZn1HUwURmZAkgMBEZLC.js";import{a as g}from"./hdos_D09on_YQtjs84MKT-chZz.js";import{S as Le}from"./hdos_CL75NkLb7xWW7I8-6Fpce.js";import{A as Te}from"./hdos_LdDBTFvCiUaOu5Vgr90G4.js";import{d as Ie,a as q,b as Z,c as Me}from"./hdos_QgvgDrSMZvumAUDmNg88v.js";import{f as Ee}from"./hdos_XzLlCNV7pEy7GYr4Zgada.js";import"./hdos_BSTciaw-lX_aI-qm8LWo3.js";import"./hdos_CE1G-McAXm7G2-tH-xmrF.js";import"./hdos_4omnIJvb4juoMfYDjB7UN.js";import"./hdos_Dj8_02alzim4xZmbxXPfD.js";import"./hdos_B5yKSozD9aKtrHemVuAeu.js";import"./hdos_DebADfjws9JukUbpHuk0U.js";import"./hdos_Cvxt0vlEdT281t1Xohl2B.js";import"./hdos_Cadz4wz0RwLMTAO0gafYS.js";import"./hdos_CGStwfBFrU-Lbq7DROl8i.js";import"./hdos_Cbt49ESpH4iEN9lkRBBGK.js";const Ve={width:24,height:24,body:'<path fill="currentColor" d="M12 1L8 5h3v9h2V5h3m2 18H6a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h3v2H6v12h12V9h-3V7h3a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2Z"/>'},je={width:24,height:24,body:'<path fill="currentColor" d="M8 3a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2H3v2h1a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h2v-2H8v-5a2 2 0 0 0-2-2a2 2 0 0 0 2-2V5h2V3m6 0a2 2 0 0 1 2 2v4a2 2 0 0 0 2 2h1v2h-1a2 2 0 0 0-2 2v4a2 2 0 0 1-2 2h-2v-2h2v-5a2 2 0 0 1 2-2a2 2 0 0 1-2-2V5h-2V3h2Z"/>'},Be={width:24,height:24,body:'<path fill="currentColor" d="M17.8 20c-.4 1.2-1.5 2-2.8 2H5c-1.7 0-3-1.3-3-3v-1h12.2c.4 1.2 1.5 2 2.8 2h.8M19 2c1.7 0 3 1.3 3 3v1h-2V5c0-.6-.4-1-1-1s-1 .4-1 1v13h-1c-.6 0-1-.4-1-1v-1H5V5c0-1.7 1.3-3 3-3h11M8 6v2h7V6H8m0 4v2h6v-2H8Z"/>'},De={width:24,height:24,body:'<path fill="currentColor" d="M10.59 13.41c.41.39.41 1.03 0 1.42c-.39.39-1.03.39-1.42 0a5.003 5.003 0 0 1 0-7.07l3.54-3.54a5.003 5.003 0 0 1 7.07 0a5.003 5.003 0 0 1 0 7.07l-1.49 1.49c.01-.82-.12-1.64-.4-2.42l.47-.48a2.982 2.982 0 0 0 0-4.24a2.982 2.982 0 0 0-4.24 0l-3.53 3.53a2.982 2.982 0 0 0 0 4.24m2.82-4.24c.39-.39 1.03-.39 1.42 0a5.003 5.003 0 0 1 0 7.07l-3.54 3.54a5.003 5.003 0 0 1-7.07 0a5.003 5.003 0 0 1 0-7.07l1.49-1.49c-.01.82.12 1.64.4 2.43l-.47.47a2.982 2.982 0 0 0 0 4.24a2.982 2.982 0 0 0 4.24 0l3.53-3.53a2.982 2.982 0 0 0 0-4.24a.973.973 0 0 1 0-1.42Z"/>'},Ne={width:24,height:24,body:'<path fill="currentColor" d="M10.5 3H18v4h-7.5C8.57 7 7 8.57 7 10.5S8.57 14 10.5 14H13v-4l7 6l-7 6v-4h-2.5C6.36 18 3 14.64 3 10.5S6.36 3 10.5 3Z"/>'},Ue={class:"app-header flex items-center space-x-4"},Fe={class:"flex flex-col justify-center overflow-hidden"},ze={class:"button-container grid grid-cols-2 gap-2 mt-3"},Oe={class:"app-details flex items-center space-x-4"},Pe={class:"flex flex-col justify-center"},qe={class:"space-x-2 mt-2 flex"},Ze={class:"app-details flex items-center space-x-4"},Xe={class:"flex flex-col justify-center"},Ye={class:"flex items-center"},Je="docker-icons/notfound.jpg",We=j({__name:"ControlHubApp",props:{app:{type:Object,required:!0}},setup(n){const r=n,h=f(!1),u=f(!1),c=f(""),x=f(""),A=r.app.name?`docker-icons/${r.app.name}.jpg`:Je,H=f([]),m=f(!1),R=f("Save and Recreate"),I=f(!1),_=f()||3e3,b=document.querySelector('meta[name="homedock_csrf_token"]')?.getAttribute("content")||"",K={"X-HomeDock-CSRF-Token":b},{themeClasses:d}=B(),Q=async s=>{await N(s),h.value=!0},ee=async s=>{await U(s),u.value=!0},ae=(s,a)=>{(typeof s=="boolean"?s:s==="true")?_.value=setInterval(()=>{U(r.app.name)},3e3):(clearInterval(_.value),_.value=null)},N=async s=>{try{const a=await L.get("/api/get-compose-info",{headers:{"X-HomeDock-CSRF-Token":b},params:{containerName:s}});a.data?.data?.ymlContent&&a.data.data.ymlContent.trim()!==""?c.value=a.data.data.ymlContent:c.value="No content found for this application."}catch(a){console.error("Error fetching application info:",a),c.value="Failed to fetch application information."}},te=async()=>{try{(await L.post("/api/update-yml-config",{containerName:r.app.name,ymlContent:c.value,homedock_csrf_token:b})).data.success?g.success("Configuration saved successfully!"):g.error("Failed to save the configuration. Please check the YML format.")}catch(s){console.error("Error saving compose:",s);const a=s.response?.data?.message||"Unknown error";g.error(`Error: ${a}`)}},oe=()=>{R.value==="Click again to confirm"?se():R.value="Click again to confirm"},se=async()=>{m.value=!0;try{(await L.post("/api/update-yml-config",{containerName:r.app.name,ymlContent:c.value,homedock_csrf_token:b})).data.success?(R.value="Recreating...",(await L.post("/api/recreate-container",{container_name:r.app.name,yml_content:c.value,homedock_csrf_token:b})).data.message?(g.success("Application recreated successfully!"),R.value="Save and Recreate"):g.error("Failed to recreate the application.")):g.error("Failed to update the configuration file.")}catch(s){console.error("Error during application recreation:",s),g.error("An error occurred. Please check the logs.")}finally{m.value=!1}},ne=async s=>{try{await N(s),c.value.trim()!==""?le(c.value,`${s}.yml`):console.error("No compose configuration available to export.")}catch(a){console.error("Error exporting compose configuration:",a)}},le=(s,a)=>{const i=new Blob([s],{type:"text/yaml;charset=utf-8;"}),v=document.createElement("a"),C=URL.createObjectURL(i);v.setAttribute("href",C),v.setAttribute("download",a),v.style.visibility="hidden",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(C)},U=async s=>{try{const a=await L.get("/api/view-container-logs",{headers:{"X-HomeDock-CSRF-Token":b},params:{containerName:s}});a.data?.logs&&a.data.logs.trim()!==""?x.value=a.data.logs:x.value="No logs found for this application."}catch(a){console.error("Error fetching application logs:",a),x.value="Failed to fetch logs for this application."}},re=async({file:s,onSuccess:a,onError:i})=>{const v=new FormData;v.append("compose_file",s),v.append("container_name",r.app.name),v.append("homedock_csrf_token",b||"");try{const C=await fetch("/api/upload_compose_file",{method:"POST",headers:{"X-HomeDock-CSRF-Token":b||""},body:v});if(C.ok){const ie=await C.json();a(ie,s),g.success(`${s.name} uploaded succesfully for ${r.app.name} application.`)}else throw new Error("Upload failed")}catch(C){console.error("Upload error:",C),i(C),g.error(`${s.name} upload failed.`)}};return ce(u,s=>{!s&&_.value&&(clearInterval(_.value),_.value=null,I.value=!1)}),(s,a)=>(w(),S("div",{class:l([[e(d).hubContMainer],"relative flex-1 border rounded-2xl p-3 shadow-sm transition-shadow duration-300 hover:shadow-lg"])},[t("div",Ue,[o(M,{draggable:"false",src:e(A),alt:n.app.name,class:l([[e(d).hubIconHolder],"app-icon w-12 h-12 rounded-xl drop-shadow-md ring-[1px]"])},null,8,["src","alt","class"]),t("div",Fe,[t("h3",{class:l([[e(d).hubCardTextAppName],"font-semibold text-xs truncate"])},k(n.app.name),3),t("h4",{class:l([[e(d).hubCardTextRepo],"font-normal text-xs truncate ellipsis"])},k(n.app.image),3)])]),t("hr",{class:l([[e(d).hubSeparator],"border-0 h-px mt-3 bg-gray-200"])},null,2),t("div",ze,[o(e($),{class:l([[e(d).storeLinkHDOSButton],"flex items-center justify-center !rounded-xl py-1 transition-all duration-300"]),ref:"exportButton",onClick:a[0]||(a[0]=i=>ne(n.app.name)),type:"dashed",size:"small",block:""},{default:p(()=>[o(e(y),{icon:e(Ve),class:"mr-1 h-3 w-3"},null,8,["icon"]),a[9]||(a[9]=t("span",null,"Export",-1))]),_:1},8,["class"]),o(e(Ae),{"custom-request":re,"file-list":H.value,"onUpdate:fileList":a[1]||(a[1]=i=>H.value=i),accept:"yml",maxCount:1,showUploadList:!1,headers:K},{default:p(()=>[o(e($),{class:l([[e(d).storeLinkHDOSButton],"w-full flex items-center justify-center !rounded-xl py-1 transition-all duration-300"]),type:"dashed",size:"small"},{default:p(()=>[o(e(y),{icon:e(De),class:"mr-1 h-3 w-3"},null,8,["icon"]),a[10]||(a[10]=t("span",null,"Import",-1))]),_:1},8,["class"])]),_:1},8,["file-list"]),o(e($),{ref:"editButton",onClick:a[2]||(a[2]=i=>Q(n.app.name)),type:"primary",size:"small",block:"",class:"flex items-center justify-center !rounded-xl py-1 transition-all duration-300"},{default:p(()=>[o(e(y),{icon:e(je),class:"mr-1 h-3 w-3"},null,8,["icon"]),a[11]||(a[11]=t("span",null,"Edit",-1))]),_:1},512),o(e($),{ref:"logsButton",onClick:a[3]||(a[3]=i=>ee(n.app.name)),type:"primary",size:"small",block:"",class:"flex items-center justify-center !rounded-xl py-1 transition-all duration-300"},{default:p(()=>[o(e(y),{icon:e(Be),class:"mr-1 h-3 w-3"},null,8,["icon"]),a[12]||(a[12]=t("span",null,"Logs",-1))]),_:1},512)]),o(e(P),{class:l([[e(d).scopeSelector],"rounded-3xl overflow-hidden"]),maskClosable:!m.value,keyboard:!m.value,closable:!m.value,open:h.value,"onUpdate:open":a[5]||(a[5]=i=>h.value=i),destroyOnClose:!0,footer:null,centered:!0,"wrap-class-name":"full-modal"},{default:p(()=>[t("div",Oe,[o(M,{draggable:"false",src:e(A),alt:"App Icon",class:"app-icon w-12 h-12 min-w-12 min-h-12 rounded-xl drop-shadow-md ring-[1px] ring-gray-500/10"},null,8,["src"]),t("div",Pe,[t("p",{class:l([[e(d).hubCardTextAppName],"app-name font-bold text-xs"])},k(n.app.name)+" config",3),t("p",{class:l([[e(d).hubCardTextRepo],"app-docker-image text-xs"])},k(n.app.image),3)])]),t("hr",{class:l([[e(d).hubSeparator],"border-0 h-px mt-4"])},null,2),F(t("textarea",{class:l([[e(d).hubTextArea],"mt-4 rounded-lg w-full font-mono h-96 resize-none"]),"onUpdate:modelValue":a[4]||(a[4]=i=>c.value=i)},null,2),[[z,c.value]]),t("div",qe,[o(e($),{onClick:te,type:"primary",class:"bg-blue-600 hover:!bg-blue-800 py-1 px-4 flex items-center"},{default:p(()=>[o(e(y),{icon:e(Se),class:"mb-0.5 mr-1 h-3 w-3 min-w-3 min-h-3"},null,8,["icon"]),a[13]||(a[13]=t("span",null,"Save",-1))]),_:1}),o(e($),{onClick:oe,loading:m.value,type:"primary",class:"bg-indigo-600 hover:!bg-indigo-800 py-1 px-4 flex items-center"},{default:p(()=>[o(e(y),{icon:e(Ne),class:"mb-0.5 mr-1 h-3 w-3 min-w-3 min-h-3"},null,8,["icon"]),t("span",null,k(R.value),1)]),_:1},8,["loading"])])]),_:1},8,["class","maskClosable","keyboard","closable","open"]),o(e(P),{class:l([[e(d).scopeSelector],"rounded-3xl overflow-hidden"]),open:u.value,"onUpdate:open":a[8]||(a[8]=i=>u.value=i),destroyOnClose:!0,footer:null,centered:!0,"wrap-class-name":"full-modal"},{default:p(()=>[t("div",Ze,[o(M,{draggable:"false",src:e(A),alt:"App Icon",class:"app-icon w-12 h-12 min-w-12 min-h-12 rounded-xl drop-shadow-md ring-[1px] ring-gray-500/10"},null,8,["src"]),t("div",Xe,[t("p",{class:l([[e(d).hubCardTextAppName],"app-name font-bold text-xs"])},k(n.app.name)+" logs",3),t("p",{class:l([[e(d).hubCardTextRepo],"app-docker-image text-xs"])},k(n.app.image),3)])]),t("hr",{class:l([[e(d).hubSeparator],"border-0 h-px mt-4"])},null,2),F(t("textarea",{class:l([[e(d).hubTextArea],"mt-4 rounded-lg w-full font-mono h-96 resize-none"]),"onUpdate:modelValue":a[6]||(a[6]=i=>x.value=i),readonly:""},null,2),[[z,x.value]]),o(e(Le),{checked:I.value,"onUpdate:checked":a[7]||(a[7]=i=>I.value=i),onChange:ae,class:"mt-2"},{checkedChildren:p(()=>[t("span",Ye,[o(e(y),{icon:e(G),class:"mr-1 animate-spin"},null,8,["icon"]),a[14]||(a[14]=T()),a[15]||(a[15]=t("span",{class:"text-transparent"},".",-1))])]),unCheckedChildren:p(()=>[...a[16]||(a[16]=[t("span",{class:"flex items-center"},"Refresh",-1)])]),_:1},8,["checked"])]),_:1},8,["class","open"])],2))}}),Ge=J(We,[["__scopeId","data-v-ab4e526f"]]),Ke={class:"relative"},Qe={key:0,class:"absolute inset-0 h-32 flex justify-center items-center z-10"},ea={key:1,class:"flex flex-col justify-center items-center p-3 space-y-1"},aa=j({__name:"ControlHubRender",props:{apps:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1}},setup(n){const{themeClasses:r}=B();return(h,u)=>(w(),S("div",Ke,[o(E,{name:"fade"},{default:p(()=>[n.isLoading?(w(),S("div",Qe,[o(e(y),{icon:e(G),class:"text-blue-600 animate-spin",width:"60",height:"60"},null,8,["icon"])])):O("",!0)]),_:1}),o(E,{name:"fade"},{default:p(()=>[n.isLoading?O("",!0):(w(),S(W,{key:0},[n.apps.length>0?(w(),de(e(Re),{key:0,dataSource:n.apps.filter(c=>c.HDRole!=="dependency"),grid:{gutter:16,column:5,xs:1,sm:2,md:3,lg:3,xl:4,xxl:5},itemLayout:"horizontal"},{renderItem:p(({item:c})=>[o(E,null,{default:p(()=>[o(e(He),{class:"!p-0"},{default:p(()=>[o(Ge,{app:c},null,8,["app"])]),_:2},1024)]),_:2},1024)]),_:1},8,["dataSource"])):(w(),S("div",ea,[o(Te,{icons:[e(Ie),e(q),e(Z),e(Me),e(Z),e(q)],interval:1e3,iconSize:64,containerClass:e(r).noAppsIcon,class:"transition duration-500 hover:-translate-y-2 hover:scale-105"},null,8,["icons","containerClass"]),t("p",{class:l([[e(r).noAppsTextMain],"text-sm text-center text-balance"])},"Couldn't find any applications installed.",2),t("p",{class:l([[e(r).noAppsTextMain],"text-sm text-center text-balance flex items-center"])},[t("span",null,[u[1]||(u[1]=T(" Install your first application on the ",-1)),t("a",{class:l([e(r).hyperLink,"inline-flex items-center ml-1"]),href:"/app-store"},[o(e(y),{icon:e(ye),class:"mr-1"},null,8,["icon"]),u[0]||(u[0]=T("App Store ",-1))],2),u[2]||(u[2]=T(". ",-1))])],2)]))],64))]),_:1})]))}}),ta=J(aa,[["__scopeId","data-v-bf239a32"]]),oa={class:"flex flex-col min-h-screen"},sa={class:"top-0 left-0 z-10"},na={class:"flex flex-1 overflow-hidden"},la={class:"hidden lg:block relative"},ra={class:"flex-1 overflow-auto max-w-full holder"},ia=j({__name:"ControlHub",setup(n){const r=f(document.querySelector('meta[name="homedock_csrf_token"]')?.getAttribute("content")||""),{themeClasses:h}=B(),u=f("/control-hub"),c=f([]),x=f(!0);async function A(H){try{x.value=!0;const m=await Ee(H);c.value=m}catch(m){console.error("Error loading containers:",m)}finally{x.value=!1}}return pe(()=>{A(r.value)}),(H,m)=>(w(),S(W,null,[o(ue),o(me),o(fe),o(he),o(ve),t("div",oa,[t("header",sa,[o(be)]),m[0]||(m[0]=t("div",{class:"h-24"},null,-1)),t("div",na,[t("aside",la,[o(Ce,{activePath:u.value},null,8,["activePath"])]),t("div",{class:l([[e(h).back],"flex flex-col flex-1 pl-4 pt-3 pr-4 max-w-full overflow-x-hidden"])},[t("main",ra,[o(we,{title:"Control Hub",body:"Streamline, supervise, synchronize...",mdi_icon:e(ke),id:"controlHub",collapsible:!1},{default:p(()=>[o(ta,{apps:c.value,isLoading:x.value},null,8,["apps","isLoading"])]),_:1},8,["mdi_icon"])]),o(_e)],2)])])],64))}});function D(n){const r=document.getElementById(n)?.textContent;if(r)try{const h=atob(r);return JSON.parse(h)}catch(h){console.error(`Error parsing data from element #${n}:`,h)}else console.error(`Element with ID '${n}' not found or is empty.`);return null}const V=D("data-theme"),X=D("data-common"),Y=D("data-settings");if(V&&X&&Y)try{const n=xe(ia),r=$e();n.use(r),n.provide("data-theme",{selectedTheme:V.selected_theme,selectedBack:V.selected_back}),n.provide("data-common",{version:X.version}),n.provide("data-settings",{userName:Y.user_name});const h=ge();n.use(h),n.mount("#app-controlhub-root")}catch(n){console.error("Error initializing the Vue app:",n)}else console.error("Required data (data-theme or data-initial) is missing or invalid.");
